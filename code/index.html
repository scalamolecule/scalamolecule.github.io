<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/>
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic,500,600,700,700italic,800,800italic'
          rel='stylesheet' type='text/css'>
    <title>Overview</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet">



    <link href="../css/highlight/styles/solarized_light.css" rel="stylesheet"/>
    <link href="../css/syntax-custom.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" href="../vendor/font-awesome/css/font-awesome.min.css">

    <link href="../css/style.css" rel="stylesheet">

    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../img/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../img/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../img/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../img/apple-touch-icon-57-precomposed.png">

    
    
    <link href="../code/index.xml" rel="alternate" type="application/rss+xml" title="Molecule"/>
    
</head>
<body data-spy="scroll" data-target="#sidebar" data-offset="110">
<header class="bs-docs-header">

    <nav class="navbar navbar-inverse">
        <div class="container-fluid" style="max-width:1170px;padding-top:3px">
            
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="../" style="padding-left: 6px; padding-right: 13px;"><img src="../img/logo/MoleculeLogo150.png"></a>
            </div>

            
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    
                    
                        
                            <li class="dropdown">
                                <a href="../intro/" target="_top">Intro</a>
                            </li>
                        
                    
                        
                            <li class="dropdown">
                                <a href="../setup/" target="_top">Setup</a>
                            </li>
                        
                    
                        
                            <li class="active">
                                <a href="../code/" target="_top">Code</a>
                                <div></div>
                            </li>
                        
                    
                        
                            <li class="dropdown">
                                <a href="../dev/" target="_top">Dev</a>
                            </li>
                        
                    
                        
                            <li class="dropdown">
                                <a href="../community/" target="_top">Community</a>
                            </li>
                        
                    
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://javadoc.io/doc/org.scalamolecule/molecule_2.13/latest/index.html" target="_blank" style="">Docs</a></li>
                    <li><a href="../changelog" style="">v0.24.0</a></li>
                    <li><a href="https://github.com/scalamolecule/molecule" target="_blank">
                        <img src="../vendor/GitHub-Mark/PNG/GitHub-Mark-Light-32px.png"
                             style="margin-top:-4px;padding-left:15px;opacity:0.6;width:42px;">
                    </a></li>
                </ul>
            </div>
        </div>
    </nav>

</header>

<div class="wrapper">

<div class="container-fluid" style="max-width:1170px">

    <div class="col-sm-10" style="padding-left:8px;">
        <h1 id="molecule-code-overview">Molecule Code overview</h1>
<p>On this page we&rsquo;ll quickly get an intuitive overview of how Molecule queries and transactions look like.</p>
<p>Then the following pages in the side menu will explain in more detail.</p>
<h3 id="db-connection">Db connection</h3>
<p>We&rsquo;ll presume that we have <a href="../setup">set up</a> an implicit connection to an in-memory Peer database:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">app.dsl.someDomain._</span>
<span class="k">import</span> <span class="nn">molecule.datomic.api._</span>
<span class="k">import</span> <span class="nn">molecule.datomic.peer.facade.Datomic_Peer</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">conn</span> <span class="k">=</span> <span class="n">recreateDbFrom</span><span class="o">(</span><span class="nc">SomeSchema</span><span class="o">)</span>
</code></pre></div><h2 id="crud">&ldquo;CRUD&rdquo;</h2>
<p>We use the builder pattern to compose molecules of attributes and get back typed tuples of data that matches our molecule by calling <code>get</code> on a molecule:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">names</span>           <span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>                 <span class="k">=</span> <span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">get</span>
<span class="k">val</span> <span class="n">namesAndAges</span>    <span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)]</span>          <span class="k">=</span> <span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">get</span>
<span class="k">val</span> <span class="n">namesAgesMembers</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span>, <span class="kt">Boolean</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">isMember</span><span class="o">.</span><span class="n">get</span>
<span class="c1">// etc..
</span></code></pre></div><p>In Datomic, data is not deleted but instead &ldquo;retracted&rdquo; since all changes are accumulated. That makes it possible to go back and see <em>what data</em> was retracted and is no longer current. That&rsquo;s why we say &ldquo;CRUD&rdquo; instead of CRUD.</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="c1">// Save populated molecule
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">(</span><span class="s">&#34;John&#34;</span><span class="o">).</span><span class="n">likes</span><span class="o">(</span><span class="s">&#34;pizza&#34;</span><span class="o">).</span><span class="n">age</span><span class="o">(</span><span class="mi">24</span><span class="o">).</span><span class="n">save</span>

<span class="c1">// Insert multiple tuples of data using a molecule template
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">likes</span> <span class="n">insert</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="s">&#34;John&#34;</span><span class="o">,</span> <span class="mi">24</span><span class="o">,</span> <span class="s">&#34;pizza&#34;</span><span class="o">),</span>
  <span class="o">(</span><span class="s">&#34;Lisa&#34;</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="s">&#34;sushi&#34;</span><span class="o">)</span>
<span class="o">)</span>

<span class="c1">// Update one or more attributes of a given entity id
</span><span class="c1"></span><span class="nc">Person</span><span class="o">(</span><span class="n">johnId</span><span class="o">).</span><span class="n">age</span><span class="o">(</span><span class="mi">25</span><span class="o">).</span><span class="n">likes</span><span class="o">(</span><span class="s">&#34;thai&#34;</span><span class="o">).</span><span class="n">update</span>

<span class="c1">// Retract (&#34;delete&#34;) entity
</span><span class="c1"></span><span class="n">johnId</span><span class="o">.</span><span class="n">retract</span>

<span class="c1">// Retract attribute value
</span><span class="c1"></span><span class="nc">Person</span><span class="o">(</span><span class="n">johnId</span><span class="o">).</span><span class="n">likes</span><span class="o">().</span><span class="n">update</span>
</code></pre></div><h2 id="syncasync-apis">Sync/Async APIs</h2>
<p>All commands in Molecule can be synchronous or asynchronous:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="c1">// sync 
</span><span class="c1"></span><span class="k">val</span> <span class="n">list</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">get</span> 

<span class="c1">// async
</span><span class="c1"></span><span class="k">val</span> <span class="n">listAsync</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">List</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)]]</span> <span class="k">=</span> <span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">getAsync</span>

<span class="n">saveAsync</span>
<span class="n">insertAsync</span>
<span class="n">updateAsync</span>
<span class="n">retractAsync</span>
</code></pre></div><h2 id="attribute-types">Attribute types</h2>
<h3 id="card-one-attributes">Card-one attributes</h3>
<p><code>name</code> here is a card-one attribute with a single value</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">head</span> <span class="o">===</span> <span class="s">&#34;Bob&#34;</span>
</code></pre></div><h3 id="card-many-attributes">Card-many attributes</h3>
<p><code>interests</code> here is a card-many attribute with a Set of distinct values</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">interests</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="s">&#34;Bob&#34;</span><span class="o">,</span> <span class="nc">Set</span><span class="o">(</span><span class="s">&#34;Baseball&#34;</span><span class="o">,</span> <span class="s">&#34;Origami&#34;</span><span class="o">),</span>
  <span class="s">&#34;Liz&#34;</span><span class="o">,</span> <span class="nc">Set</span><span class="o">(</span><span class="s">&#34;Painting&#34;</span><span class="o">,</span> <span class="s">&#34;Traveling&#34;</span><span class="o">,</span> <span class="s">&#34;Tae Kwondo&#34;</span><span class="o">)</span>
<span class="o">)</span>
</code></pre></div><h3 id="map-attributes">Map attributes</h3>
<p>Keyed card-many attributes, or &ldquo;Map attributes&rdquo;, are useful for i18n for instance</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Phrases</span><span class="o">.</span><span class="n">greeting</span><span class="o">(</span><span class="s">&#34;en&#34;</span> <span class="o">-&gt;</span> <span class="s">&#34;hello&#34;</span><span class="o">,</span> <span class="s">&#34;de&#34;</span> <span class="o">-&gt;</span> <span class="s">&#34;hallo&#34;</span><span class="o">).</span><span class="n">save</span>
<span class="nc">Phrases</span><span class="o">.</span><span class="n">greeting</span><span class="o">(</span><span class="s">&#34;en&#34;</span> <span class="o">-&gt;</span> <span class="s">&#34;hello&#34;</span><span class="o">).</span><span class="n">get</span><span class="o">.</span><span class="n">head</span> <span class="o">===</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&#34;en&#34;</span> <span class="o">-&gt;</span> <span class="s">&#34;hello&#34;</span><span class="o">)</span>
<span class="nc">Phrases</span><span class="o">.</span><span class="n">greeting</span><span class="o">.</span><span class="n">k</span><span class="o">(</span><span class="s">&#34;de&#34;</span><span class="o">).</span><span class="n">get</span><span class="o">.</span><span class="n">head</span>          <span class="o">===</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&#34;de&#34;</span> <span class="o">-&gt;</span> <span class="s">&#34;hallo&#34;</span><span class="o">)</span>
</code></pre></div><h3 id="mandatory-optional-tacit">Mandatory, Optional, Tacit</h3>
<p>Attributes can be</p>
<ul>
<li>a <em>mandatory</em> value,</li>
<li>an <em>optional</em> value (<code>$</code> appended), or</li>
<li>a <em>tacit</em> value ( <code>_</code> appended) that is mandatory but not returned:</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="c1">// name is mandatory
</span><span class="c1">// age$ is optional
</span><span class="c1">// isMember_ is mandatory but not returned (tacit)
</span><span class="c1"></span><span class="k">val</span> <span class="n">membersWithOptionalAge</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">])]</span> <span class="k">=</span> <span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age$</span><span class="o">.</span><span class="n">isMember_</span><span class="o">.</span><span class="n">get</span>
</code></pre></div><h3 id="attribute-data-types">Attribute data types</h3>
<pre><code>Cardinality one             Cardinality many                 Mapped cardinality many
-------------------         -------------------------        --------------------------------
oneString    : String       manyString    : Set[String]      mapString    : Map[String, String]
oneInt       : Int          manyInt       : Set[Int]         mapInt       : Map[String, Int]
oneLong      : Long         manyLong      : Set[Long]        mapLong      : Map[String, Long]
oneFloat     : Float        manyFloat     : Set[Float]       mapFloat     : Map[String, Float]
oneDouble    : Double       manyDouble    : Set[Double]      mapDouble    : Map[String, Double]
oneBigInt    : BigInt       manyBigInt    : Set[BigInt]      mapBigInt    : Map[String, BigInt]
oneBigDecimal: BigDecimal   manyBigDecimal: Set[BigDecimal]  mapBigDecimal: Map[String, BigDecimal]
oneBoolean   : Boolean      manyBoolean   : Set[Boolean]     mapBoolean   : Map[String, Boolean]
oneDate      : Date         manyDate      : Set[Date]        mapDate      : Map[String, Date]
oneUUID      : UUID         manyUUID      : Set[UUID]        mapUUID      : Map[String, UUID]
oneURI       : URI          manyURI       : Set[URI]         mapURI       : Map[String, URI]
oneEnum      : String       manyEnum      : Set[String]
</code></pre><h2 id="attribute-values">Attribute values</h2>
<h3 id="expressions">Expressions</h3>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="c1">// equality
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="mi">42</span><span class="o">)</span>

<span class="c1">// negation
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">not</span><span class="o">(</span><span class="mi">42</span><span class="o">)</span> <span class="c1">// or
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">.!(</span><span class="mi">42</span><span class="o">)</span> 

<span class="c1">// comparison
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">.&gt;(</span><span class="mi">42</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">.&gt;=(</span><span class="mi">42</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">.&lt;(</span><span class="mi">42</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">.&lt;=(</span><span class="mi">42</span><span class="o">)</span>

<span class="c1">// null
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">()</span> <span class="c1">// or
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="nc">Nil</span><span class="o">)</span>

<span class="c1">// Word search
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">comment</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="s">&#34;nice&#34;</span><span class="o">)</span>
</code></pre></div><h3 id="aggregates">Aggregates</h3>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">count</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">countDistinct</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">distinct</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">max</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">min</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">rand</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">sample</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">avg</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">median</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">stddev</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">sum</span><span class="o">)</span>
<span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="n">variance</span><span class="o">)</span>
</code></pre></div><h3 id="logic">Logic</h3>
<p>OR</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="mi">42</span> <span class="n">or</span> <span class="mi">43</span><span class="o">)</span> <span class="c1">// same as
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="mi">42</span><span class="o">,</span> <span class="mi">43</span><span class="o">)</span>   <span class="c1">// same as
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">42</span><span class="o">,</span> <span class="mi">43</span><span class="o">))</span>
</code></pre></div><p>AND: card-many attribute <code>category</code> has both a &ldquo;restaurants&rdquo; and a &ldquo;shopping&rdquo; value:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Community</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">category_</span><span class="o">(</span><span class="s">&#34;restaurants&#34;</span> <span class="n">and</span> <span class="s">&#34;shopping&#34;</span><span class="o">).</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span><span class="s">&#34;Ballard Gossip Girl&#34;</span><span class="o">)</span>
</code></pre></div><h2 id="input-molecules">Input molecules</h2>
<p>&ldquo;Input molecules&rdquo; awaits 1, 2 or 3 input values. Useful for re-use</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">personsOfAge</span> <span class="k">=</span> <span class="n">m</span><span class="o">(</span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age_</span><span class="o">(?))</span>

<span class="n">personsOfAge</span><span class="o">(</span><span class="mi">23</span><span class="o">).</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span><span class="s">&#34;Bob&#34;</span><span class="o">)</span>
<span class="n">personsOfAge</span><span class="o">(</span><span class="mi">24</span><span class="o">).</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span><span class="s">&#34;Liz&#34;</span><span class="o">,</span> <span class="s">&#34;Don&#34;</span><span class="o">)</span>
</code></pre></div><p>2 inputs + logic (and relationships)</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">typeAndRegion</span> <span class="k">=</span> <span class="n">m</span><span class="o">(</span><span class="nc">Community</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">type_</span><span class="o">(?).</span><span class="nc">Neighborhood</span><span class="o">.</span><span class="nc">District</span><span class="o">.</span><span class="n">region_</span><span class="o">(?))</span>

<span class="c1">// Social media communities in southern districts
</span><span class="c1"></span><span class="n">typeAndRegion</span><span class="o">((</span><span class="s">&#34;twitter&#34;</span> <span class="n">or</span> <span class="s">&#34;facebook_page&#34;</span><span class="o">)</span> <span class="n">and</span> <span class="o">(</span><span class="s">&#34;sw&#34;</span> <span class="n">or</span> <span class="s">&#34;s&#34;</span> <span class="n">or</span> <span class="s">&#34;se&#34;</span><span class="o">))</span>
</code></pre></div><h2 id="relationships">Relationships</h2>
<h3 id="card-one">Card-one</h3>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="nc">Address</span><span class="o">.</span><span class="n">street</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="s">&#34;Bob&#34;</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="s">&#34;5th Avenue&#34;</span><span class="o">)</span> 
<span class="o">)</span> 
</code></pre></div><h3 id="card-many">Card-many</h3>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="c1">// flat
</span><span class="c1"></span><span class="nc">Invoice</span><span class="o">.</span><span class="n">no</span><span class="o">.</span><span class="nc">InvoiceLines</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="mi">42</span><span class="o">,</span> <span class="s">&#34;coffee&#34;</span><span class="o">),</span>
  <span class="o">(</span><span class="mi">42</span><span class="o">,</span> <span class="s">&#34;sugar&#34;</span><span class="o">)</span>
<span class="o">)</span>

<span class="c1">// nested
</span><span class="c1"></span><span class="nc">Invoice</span><span class="o">.</span><span class="n">no</span><span class="o">.</span><span class="nc">InvoiceLines</span><span class="o">.*(</span><span class="nc">InvoiceLine</span><span class="o">.</span><span class="n">item</span><span class="o">).</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="mi">42</span><span class="o">,</span> <span class="nc">List</span><span class="o">(</span><span class="s">&#34;coffee&#34;</span><span class="o">,</span> <span class="s">&#34;sugar&#34;</span><span class="o">))</span>
<span class="o">)</span>
</code></pre></div><h3 id="self-join">Self-join</h3>
<p>Relationship to the same Namespace type (Person -&gt; Person)</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nc">Spouse</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">head</span> <span class="o">===</span> <span class="o">(</span><span class="s">&#34;Bob&#34;</span><span class="o">,</span> <span class="s">&#34;Liz&#34;</span><span class="o">)</span>
</code></pre></div><h3 id="directional">Directional</h3>
<p>Relationships can be defined to go in both directions so that we can traverse a graph uniformly:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nc">Knows</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nc">Knows</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="s">&#34;Bob&#34;</span><span class="o">,</span> <span class="s">&#34;Liz&#34;</span><span class="o">,</span> <span class="s">&#34;Dan&#34;</span><span class="o">),</span>
  <span class="o">(</span><span class="s">&#34;Dan&#34;</span><span class="o">,</span> <span class="s">&#34;Liz&#34;</span><span class="o">,</span> <span class="s">&#34;Bob&#34;</span><span class="o">)</span>
  <span class="c1">// etc...
</span><span class="c1"></span><span class="o">)</span>
</code></pre></div><h3 id="associative">Associative</h3>
<p>Attributes from different Namespaces that are not explicitly related can be <em>associated</em> by sharing the same entity id. We call molecules with associative relationships &ldquo;Composite molecules&rdquo;:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="n">m</span><span class="o">(</span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">(</span><span class="s">&#34;Bob&#34;</span><span class="o">)</span> <span class="o">+</span> <span class="nc">Bar</span><span class="o">.</span><span class="n">status</span><span class="o">(</span><span class="s">&#34;regular&#34;</span><span class="o">)).</span><span class="n">save</span>
<span class="n">m</span><span class="o">(</span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="nc">Bar</span><span class="o">.</span><span class="n">status</span><span class="o">).</span><span class="n">get</span><span class="o">.</span><span class="n">head</span> <span class="o">===</span> <span class="o">(</span><span class="s">&#34;Bob&#34;</span><span class="o">,</span> <span class="s">&#34;regular&#34;</span><span class="o">)</span>
</code></pre></div><h2 id="tx-bundle">Tx Bundle</h2>
<p>Transaction bundles can atomically transact multiple operations/statements in one transaction:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="n">transact</span><span class="o">(</span>
  <span class="c1">// retract entity
</span><span class="c1"></span>  <span class="n">e1</span><span class="o">.</span><span class="n">getRetractStmts</span><span class="o">,</span>
  <span class="c1">// save new entity
</span><span class="c1"></span>  <span class="nc">Ns</span><span class="o">.</span><span class="n">int</span><span class="o">(</span><span class="mi">4</span><span class="o">).</span><span class="n">getSaveStmts</span><span class="o">,</span>
  <span class="c1">// insert multiple new entities
</span><span class="c1"></span>  <span class="nc">Ns</span><span class="o">.</span><span class="n">int</span><span class="o">.</span><span class="n">getInsertStmts</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">)),</span>
  <span class="c1">// update entity
</span><span class="c1"></span>  <span class="nc">Ns</span><span class="o">(</span><span class="n">e2</span><span class="o">).</span><span class="n">int</span><span class="o">(</span><span class="mi">20</span><span class="o">).</span><span class="n">getUpdateStmts</span>
<span class="o">)</span>
</code></pre></div><h2 id="tx-meta-data">Tx meta data</h2>
<p>Add meta data to the transaction entity itself about the transaction:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">(</span><span class="s">&#34;John&#34;</span><span class="o">).</span><span class="n">likes</span><span class="o">(</span><span class="s">&#34;pizza&#34;</span><span class="o">).</span><span class="nc">Tx</span><span class="o">(</span><span class="nc">Audit</span><span class="o">.</span><span class="n">user</span><span class="o">(</span><span class="s">&#34;Lisa&#34;</span><span class="o">).</span><span class="n">uc</span><span class="o">(</span><span class="s">&#34;survey&#34;</span><span class="o">)).</span><span class="n">save</span>
</code></pre></div><p>We can then query for specific tx meta data</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="c1">// How was John added?
</span><span class="c1">// John was added by Lisa as part of a survey
</span><span class="c1"></span><span class="nc">Person</span><span class="o">(</span><span class="n">johnId</span><span class="o">).</span><span class="n">name</span><span class="o">.</span><span class="nc">Tx</span><span class="o">(</span><span class="nc">Audit</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">uc</span><span class="o">).</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">((</span><span class="s">&#34;John&#34;</span><span class="o">,</span> <span class="s">&#34;Lisa&#34;</span><span class="o">,</span> <span class="s">&#34;survey&#34;</span><span class="o">))</span>

<span class="c1">// When did Lisa survey John?
</span><span class="c1"></span><span class="nc">Person</span><span class="o">(</span><span class="n">johnId</span><span class="o">).</span><span class="n">name_</span><span class="o">.</span><span class="n">txInstant</span><span class="o">.</span><span class="nc">Tx</span><span class="o">(</span><span class="nc">Audit</span><span class="o">.</span><span class="n">user_</span><span class="o">(</span><span class="s">&#34;Lisa&#34;</span><span class="o">).</span><span class="n">uc_</span><span class="o">(</span><span class="s">&#34;survey&#34;</span><span class="o">)).</span><span class="n">get</span><span class="o">.</span><span class="n">head</span> <span class="o">===</span> <span class="n">dateX</span>
  
<span class="c1">// Who were surveyed?  
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nc">Tx</span><span class="o">(</span><span class="nc">Audit</span><span class="o">.</span><span class="n">uc_</span><span class="o">(</span><span class="s">&#34;survey&#34;</span><span class="o">)).</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span><span class="s">&#34;John&#34;</span><span class="o">)</span>

<span class="c1">// What did people that Lisa surveyed like? 
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">likes</span><span class="o">.</span><span class="nc">Tx</span><span class="o">(</span><span class="nc">Audit</span><span class="o">.</span><span class="n">user_</span><span class="o">(</span><span class="s">&#34;Lisa&#34;</span><span class="o">).</span><span class="n">uc_</span><span class="o">(</span><span class="s">&#34;survey&#34;</span><span class="o">)).</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span><span class="s">&#34;pizza&#34;</span><span class="o">)</span>

<span class="c1">// etc..
</span></code></pre></div><h2 id="tx-function">Tx function</h2>
<p>Ensure transactional atomicity with tx functions that run within a single transaction. If any part of the function throws an exception, the whole transaction is aborted.</p>
<p>Here&rsquo;s a money transfer function where we want to be sure that both accounts are updated correctly:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="c1">// Pass in entity ids of from/to accounts and the amount to be transferred
</span><span class="c1"></span><span class="k">def</span> <span class="n">transfer</span><span class="o">(</span><span class="n">from</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span> <span class="n">to</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span> <span class="n">amount</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">conn</span><span class="k">:</span> <span class="kt">Conn</span><span class="o">)</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">Seq</span><span class="o">[</span><span class="kt">Statement</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="c1">// Validate sufficient funds in from-account
</span><span class="c1"></span>  <span class="k">val</span> <span class="n">curFromBalance</span> <span class="k">=</span> <span class="nc">Account</span><span class="o">(</span><span class="n">from</span><span class="o">).</span><span class="n">balance</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">headOption</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">curFromBalance</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="o">)</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nc">TxFnException</span><span class="o">(</span>
      <span class="s">s&#34;Can&#39;t transfer </span><span class="si">$amount</span><span class="s"> from account </span><span class="si">$from</span><span class="s"> having a balance of only </span><span class="si">$curFromBalance</span><span class="s">.&#34;</span><span class="o">)</span>

  <span class="c1">// Calculate new balances
</span><span class="c1"></span>  <span class="k">val</span> <span class="n">newFromBalance</span> <span class="k">=</span> <span class="n">curFromBalance</span> <span class="o">-</span> <span class="n">amount</span>
  <span class="k">val</span> <span class="n">newToBalance</span> <span class="k">=</span> <span class="nc">Account</span><span class="o">(</span><span class="n">to</span><span class="o">).</span><span class="n">balance</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">headOption</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="n">amount</span>

  <span class="c1">// Update accounts
</span><span class="c1"></span>  <span class="nc">Account</span><span class="o">(</span><span class="n">from</span><span class="o">).</span><span class="n">balance</span><span class="o">(</span><span class="n">newFromBalance</span><span class="o">).</span><span class="n">getUpdateStmts</span> <span class="o">++</span> <span class="nc">Account</span><span class="o">(</span><span class="n">to</span><span class="o">).</span><span class="n">balance</span><span class="o">(</span><span class="n">newToBalance</span><span class="o">).</span><span class="n">getUpdateStmts</span>
<span class="o">}</span>
</code></pre></div><p>We then call the transaction function inside a <code>transact</code> method:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="n">transact</span><span class="o">(</span><span class="n">transfer</span><span class="o">(</span><span class="n">fromAccount</span><span class="o">,</span> <span class="n">toAccount</span><span class="o">,</span> <span class="n">okAmount</span><span class="o">))</span>
</code></pre></div><h2 id="time">Time</h2>
<p>Datomic has powerful ways of accessing all the immutable data that accumulates over time in the database:</p>
<p><img src="../img/page/time/all.png" alt=""></p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="c1">// Current data
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">get</span>

<span class="c1">// As of some point in time - how did it look at that time?
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">getAsOf</span><span class="o">(</span><span class="n">nov5date</span><span class="o">)</span>

<span class="c1">// Since some point in time - what has happened after this time?
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">getSince</span><span class="o">(</span><span class="n">nov5date</span><span class="o">)</span>

<span class="c1">// History of all name operations - what names were added and retracted?
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">getHistory</span>

<span class="c1">// Test what-if scenarios given some test statements - how will it look if we do x?
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">getWith</span><span class="o">(</span><span class="n">someTestStmts</span><span class="o">)</span>
</code></pre></div><h2 id="generic-apis">Generic APIs</h2>
<p>Molecule provides access to Datomic&rsquo;s various generic interfaces and apis.</p>
<h3 id="entity-api">Entity API</h3>
<p><code>touch</code> an entity id to get all it&rsquo;s attribute values</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="n">orderId</span><span class="o">.</span><span class="n">touch</span> <span class="o">===</span> <span class="nc">Map</span><span class="o">(</span>
  <span class="s">&#34;:db/id&#34;</span> <span class="o">-&gt;</span> <span class="n">orderId</span><span class="o">,</span>
  <span class="s">&#34;:Order/lineItems&#34;</span> <span class="o">-&gt;</span> <span class="nc">List</span><span class="o">(</span>
    <span class="nc">Map</span><span class="o">(</span>
      <span class="s">&#34;:db/id&#34;</span> <span class="o">-&gt;</span> <span class="mi">102L</span><span class="o">,</span> 
      <span class="s">&#34;:LineItem/qty&#34;</span> <span class="o">-&gt;</span> <span class="mi">3</span><span class="o">,</span> 
      <span class="s">&#34;:LineItem/product&#34;</span> <span class="o">-&gt;</span> <span class="s">&#34;Milk&#34;</span><span class="o">,</span>
      <span class="s">&#34;:LineItem/price&#34;</span> <span class="o">-&gt;</span> <span class="mf">12.0</span><span class="o">),</span>
    <span class="nc">Map</span><span class="o">(</span>
      <span class="s">&#34;:db/id&#34;</span> <span class="o">-&gt;</span> <span class="mi">103L</span><span class="o">,</span> 
      <span class="s">&#34;:LineItem/qty&#34;</span> <span class="o">-&gt;</span> <span class="mi">2</span><span class="o">,</span> 
      <span class="s">&#34;:LineItem/product&#34;</span> <span class="o">-&gt;</span> <span class="s">&#34;Coffee&#34;</span><span class="o">,</span>
      <span class="s">&#34;:LineItem/price&#34;</span> <span class="o">-&gt;</span> <span class="mf">46.0</span><span class="o">)))</span>
</code></pre></div><h3 id="datom">Datom</h3>
<p>Retrieve generic data about entities and attributes:</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="c1">// Entity id of Ben with generic Datom attribute `e`
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">head</span> <span class="o">===</span> <span class="o">(</span><span class="n">benEntityId</span><span class="o">,</span> <span class="s">&#34;Ben&#34;</span><span class="o">)</span>

<span class="c1">// When was the Ben&#39;s age last changed?
</span><span class="c1"></span><span class="nc">Person</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">txInstant</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">head</span> <span class="o">===</span> <span class="o">(</span><span class="mi">24</span><span class="o">,</span> <span class="o">&lt;</span><span class="nc">April</span> <span class="mi">4</span><span class="o">&gt;)</span> <span class="c1">// (Date)
</span><span class="c1"></span>
<span class="c1">// etc...
</span></code></pre></div><h3 id="indexes">Indexes</h3>
<h4 id="eavt">EAVT</h4>
<p>Attributes and values of entity e1</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">EAVT</span><span class="o">(</span><span class="n">e1</span><span class="o">).</span><span class="n">a</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="s">&#34;:Person/name&#34;</span><span class="o">,</span> <span class="s">&#34;Ben&#34;</span><span class="o">),</span>
  <span class="o">(</span><span class="s">&#34;:Person/age&#34;</span><span class="o">,</span> <span class="mi">25</span><span class="o">),</span>
  <span class="o">(</span><span class="s">&#34;:Golf/score&#34;</span><span class="o">,</span> <span class="mf">5.7</span><span class="o">)</span>
<span class="o">)</span>
</code></pre></div><h4 id="avet">AVET</h4>
<p>Values, entities and transactions where attribute <code>:Person/age</code> is involved</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">AVET</span><span class="o">(</span><span class="s">&#34;:Person/age&#34;</span><span class="o">).</span><span class="n">e</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="mi">25</span><span class="o">,</span> <span class="n">e1</span><span class="o">,</span> <span class="n">t2</span><span class="o">),</span>
  <span class="o">(</span><span class="mi">23</span><span class="o">,</span> <span class="n">e2</span><span class="o">,</span> <span class="n">t5</span><span class="o">)</span>
  <span class="o">(</span><span class="mi">14</span><span class="o">,</span> <span class="n">e3</span><span class="o">,</span> <span class="n">t7</span><span class="o">),</span>
<span class="o">)</span>

<span class="c1">// AVET index filtered with an attribute name and a range of values
</span><span class="c1"></span><span class="nc">AVET</span><span class="o">.</span><span class="n">range</span><span class="o">(</span><span class="s">&#34;:Person/age&#34;</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">14</span><span class="o">),</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">24</span><span class="o">)).</span><span class="n">v</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="mi">14</span><span class="o">,</span> <span class="n">e4</span><span class="o">,</span> <span class="n">t7</span><span class="o">),</span>
  <span class="o">(</span><span class="mi">23</span><span class="o">,</span> <span class="n">e2</span><span class="o">,</span> <span class="n">t5</span><span class="o">)</span>
<span class="o">)</span>
</code></pre></div><h4 id="aevt">AEVT</h4>
<p>Entities, values and transactions where attribute <code>:Person/name</code> is involved</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">AEVT</span><span class="o">(</span><span class="s">&#34;:Person/name&#34;</span><span class="o">).</span><span class="n">e</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="s">&#34;Ben&#34;</span><span class="o">,</span> <span class="n">t2</span><span class="o">),</span>
  <span class="o">(</span><span class="n">e2</span><span class="o">,</span> <span class="s">&#34;Liz&#34;</span><span class="o">,</span> <span class="n">t5</span><span class="o">)</span>
<span class="o">)</span>
</code></pre></div><h4 id="vaet">VAET</h4>
<p>Get entities pointing to entity a1</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">VAET</span><span class="o">(</span><span class="n">a1</span><span class="o">).</span><span class="n">v</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="n">a1</span><span class="o">,</span> <span class="s">&#34;:Release/artists&#34;</span><span class="o">,</span> <span class="n">r1</span><span class="o">),</span>
  <span class="o">(</span><span class="n">a1</span><span class="o">,</span> <span class="s">&#34;:Release/artists&#34;</span><span class="o">,</span> <span class="n">r2</span><span class="o">),</span>
  <span class="o">(</span><span class="n">a1</span><span class="o">,</span> <span class="s">&#34;:Release/artists&#34;</span><span class="o">,</span> <span class="n">r3</span><span class="o">),</span>
<span class="o">)</span>
</code></pre></div><h3 id="log">Log</h3>
<p>Data from transaction <code>t1</code> until <code>t4</code> (exclusive)</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Log</span><span class="o">(</span><span class="nc">Some</span><span class="o">(</span><span class="n">t1</span><span class="o">),</span> <span class="nc">Some</span><span class="o">(</span><span class="n">t4</span><span class="o">)).</span><span class="n">t</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="n">t1</span><span class="o">,</span> <span class="n">e1</span><span class="o">,</span> <span class="s">&#34;:Person/name&#34;</span><span class="o">,</span> <span class="s">&#34;Ben&#34;</span><span class="o">,</span> <span class="kc">true</span><span class="o">),</span>
  <span class="o">(</span><span class="n">t1</span><span class="o">,</span> <span class="n">e1</span><span class="o">,</span> <span class="s">&#34;:Person/age&#34;</span><span class="o">,</span> <span class="mi">25</span><span class="o">,</span> <span class="kc">true</span><span class="o">),</span>

  <span class="o">(</span><span class="n">t2</span><span class="o">,</span> <span class="n">e2</span><span class="o">,</span> <span class="s">&#34;:Person/name&#34;</span><span class="o">,</span> <span class="s">&#34;Liz&#34;</span><span class="o">,</span> <span class="kc">true</span><span class="o">),</span>
  <span class="o">(</span><span class="n">t2</span><span class="o">,</span> <span class="n">e2</span><span class="o">,</span> <span class="s">&#34;:Person/age&#34;</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="kc">true</span><span class="o">),</span>

  <span class="o">(</span><span class="n">t3</span><span class="o">,</span> <span class="n">e1</span><span class="o">,</span> <span class="s">&#34;:Person/age&#34;</span><span class="o">,</span> <span class="mi">25</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span>
  <span class="o">(</span><span class="n">t3</span><span class="o">,</span> <span class="n">e1</span><span class="o">,</span> <span class="s">&#34;:Person/age&#34;</span><span class="o">,</span> <span class="mi">26</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
<span class="o">)</span>
</code></pre></div><h3 id="schema">Schema</h3>
<p>Get information about the Datomic schema which is also a way to access your Data Model programatically.</p>
<div class="highlight"><pre class="chroma"><code class="language-scala" data-lang="scala"><span class="nc">Schema</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">ns</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">fulltext$</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">get</span> <span class="o">===</span> <span class="nc">List</span><span class="o">(</span>
  <span class="o">(</span><span class="s">&#34;ind&#34;</span><span class="o">,</span> <span class="s">&#34;Person&#34;</span><span class="o">,</span> <span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="kc">true</span><span class="o">),</span> <span class="s">&#34;Person name&#34;</span><span class="o">),</span> <span class="c1">// fulltext search enabled
</span><span class="c1"></span>  <span class="o">(</span><span class="s">&#34;ind&#34;</span><span class="o">,</span> <span class="s">&#34;Person&#34;</span><span class="o">,</span> <span class="s">&#34;age&#34;</span><span class="o">,</span> <span class="nc">None</span><span class="o">,</span> <span class="s">&#34;Person age&#34;</span><span class="o">),</span>
  <span class="o">(</span><span class="s">&#34;cat&#34;</span><span class="o">,</span> <span class="s">&#34;Sport&#34;</span><span class="o">,</span> <span class="s">&#34;name&#34;</span><span class="o">,</span> <span class="nc">None</span><span class="o">,</span> <span class="s">&#34;Sport category name&#34;</span><span class="o">)</span>
<span class="o">)</span>
</code></pre></div><h3 id="next">Next</h3>
<p><a href="../code/attributes/">Attributes&hellip;</a></p>

    </div>

    <div class="col-sm-2" style="padding-left:24px;padding-right: 0px;position:sticky;top:115px">
        
<button type="button" id="sidebarCollapse" class="navbar-toggle collapsed" data-toggle="collapse">
  <i class="glyphicon glyphicon-align-left"></i>
</button>

<nav class="bs-docs-sidebar" id="sidebar">
  <ul class="bs-docs-sidenav nav">
    
      

        
        
          
            <li class="open"><a href="../code/"><b>Overview</b></a></li>
            
              <nav id="TableOfContents">
  <ul>
    <li></li>
    <li><a href="#crud">&ldquo;CRUD&rdquo;</a></li>
    <li><a href="#syncasync-apis">Sync/Async APIs</a></li>
    <li><a href="#attribute-types">Attribute types</a></li>
    <li><a href="#attribute-values">Attribute values</a></li>
    <li><a href="#input-molecules">Input molecules</a></li>
    <li><a href="#relationships">Relationships</a></li>
    <li><a href="#tx-bundle">Tx Bundle</a></li>
    <li><a href="#tx-meta-data">Tx meta data</a></li>
    <li><a href="#tx-function">Tx function</a></li>
    <li><a href="#time">Time</a></li>
    <li><a href="#generic-apis">Generic APIs</a></li>
  </ul>
</nav>
            
          
          
        
          
            <li><a href="../code/attributes/">Attributes</a></li>
          
          
        
          
            <li><a href="../code/relationships/">Relationships</a></li>
          
          
        
          
            <li><a href="../code/transactions/">Transactions</a></li>
          
          
        
          
            <li><a href="../code/transaction-functions/">Transaction Functions</a></li>
          
          
        
          
            <li><a href="../code/time/">Time</a></li>
          
          
        
          
            <li><a href="../code/generic/">Generic APIs</a></li>
          
          
        

      
    
  </ul>
</nav>
    </div>

</div> 

     
   
 


</div> 

<footer class="bs-docs-footer">

  <div class="container" style="font-size:15px">
    <ul class="bs-docs-footer-links">
      <li style="margin-top: 8px;"><a href="../front/"><img src="../img/logo/MoleculeLogo150.png" alt=""></a></li>
      <li><a href="https://github.com/scalamolecule/molecule">GitHub</a></li>
      <li><a href="https://github.com/scalamolecule/molecule-web">GitHub-web</a></li>
      <li><a href="https://gitter.im/scalamolecule/Lobby">Gitter</a></li>
      <li><a href="https://groups.google.com/forum/#!forum/molecule-dsl">Forum</a></li>
      <li><a href="../about/">About</a></li>
      <li><a href="../credits/">Credits</a></li>
      <li><a href="../changelog">Changelog</a></li>
    </ul>
    <p>Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="license">Apache License 2.0</a></p>
  </div>
</footer>


<script type="text/javascript" src="../js/jquery-1.11.2.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.min.js"></script>


<script type="text/javascript" src="../js/scripts.js"></script>
<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script src="../js/copy-button.js"></script>
<script src="../js/sidebar-collapser.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2787756-3', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>
