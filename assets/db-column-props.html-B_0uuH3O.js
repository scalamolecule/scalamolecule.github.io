import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,d as t,o as e}from"./app-CZk41djq.js";const n={};function l(p,s){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="custom-db-column-props" tabindex="-1"><a class="header-anchor" href="#custom-db-column-props"><span>Custom db column props</span></a></h1><p>Molecule supports custom database column properties, allowing you to modify the basic SQL column types with varying properties at both the domain and attribute levels.</p><h2 id="what-are-custom-database-column-properties" tabindex="-1"><a class="header-anchor" href="#what-are-custom-database-column-properties"><span>What are Custom Database Column Properties?</span></a></h2><p>By default, Molecule maps Scala types to appropriate SQL column types (e.g., <code>String</code> → <code>TEXT</code>, <code>Double</code> → <code>DOUBLE PRECISION</code>) for each database.</p><p>Custom column properties let you substitute any SQL type that maps to the same JDBC type, allowing you to use database-specific constraints, optimize storage, or enforce limits while maintaining compatibility.</p><div class="language-scala" data-highlighter="shiki" data-ext="scala" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-scala"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">trait</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyDomain</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> extends</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> DomainStructure</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Define general custom properties for the entire domain</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  generalDbColumnProperties(</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">H2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      oneString -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;VARCHAR(100)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      oneDouble -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;DECIMAL(10,2)&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ),</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">SQLite</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      oneString -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;NVARCHAR(150)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      oneDouble -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;DECIMAL(10,2)&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  trait</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Product</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // All String attributes use domain-level custom properties</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneString</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // Override with attribute-specific properties</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> sku</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneString.dbColumnProperties(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">H2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;VARCHAR(20)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // All Double attributes use domain-level custom properties</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> price</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneDouble</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><h2 id="_3-tier-precedence-system" tabindex="-1"><a class="header-anchor" href="#_3-tier-precedence-system"><span>3-Tier Precedence System</span></a></h2><p>Custom column properties follow a clear precedence hierarchy:</p><ol><li><strong>Attribute-specific</strong> (highest priority) - <code>.dbColumnProperties()</code> on individual attributes</li><li><strong>General domain-level</strong> - <code>generalDbColumnProperties()</code> for all matching types</li><li><strong>Default Molecule types</strong> (fallback) - Standard type mappings</li></ol><p>This allows you to set sensible defaults domain-wide while fine-tuning specific attributes as needed.</p><h2 id="supported-databases" tabindex="-1"><a class="header-anchor" href="#supported-databases"><span>Supported Databases</span></a></h2><p>Custom column properties work with all SQL databases:</p><ul><li>H2</li><li>SQLite</li><li>PostgreSQL</li><li>MySQL</li><li>MariaDB</li></ul><p>Each database can have its own property definitions, automatically applied during schema generation.</p><h2 id="default-type-philosophy" tabindex="-1"><a class="header-anchor" href="#default-type-philosophy"><span>Default Type Philosophy</span></a></h2><p>Molecule&#39;s default type mappings prioritize <strong>maximum precision over performance optimization</strong> for <code>BigInt</code> and <code>BigDecimal</code> types to prevent precision loss and size limitations:</p><ul><li><strong>PostgreSQL</strong>: Uses unrestricted <code>DECIMAL</code> for Float, BigInt, and BigDecimal</li><li><strong>MySQL/MariaDB</strong>: Uses <code>REAL</code> for Float, maximum precision <code>DECIMAL(65, ...)</code> for BigInt and BigDecimal</li><li><strong>H2</strong>: Uses <code>REAL</code> for Float, large precision <code>DECIMAL(100, 0)</code> for BigInt and <code>DECIMAL(65, 30)</code> for BigDecimal</li><li><strong>SQLite</strong>: Uses <code>REAL</code> for Float, <code>TEXT</code> for BigInt and BigDecimal (flexible numeric storage)</li></ul><p>While this approach ensures data accuracy for arbitrary-precision types, it may not always be optimal for performance-critical applications. Custom column properties let you tune these defaults when you need faster operations or more compact storage.</p><h2 id="use-cases" tabindex="-1"><a class="header-anchor" href="#use-cases"><span>Use Cases</span></a></h2><p><strong>Size constraints</strong>: Limit string columns to specific lengths</p><div class="language-scala" data-highlighter="shiki" data-ext="scala" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-scala"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> zipCode</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneString.dbColumnProperties(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">PostgreSQL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;VARCHAR(10)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><p><strong>Precision control</strong>: Define exact decimal precision for performance</p><div class="language-scala" data-highlighter="shiki" data-ext="scala" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-scala"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// PostgreSQL default: unrestricted DECIMAL</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// MySQL default: DECIMAL(65, 30)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Optimize with specific precision/scale when exact requirements are known</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> price</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneDouble.dbColumnProperties(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">MySQL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;DECIMAL(10,2)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> percentage</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneFloat.dbColumnProperties(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">PostgreSQL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;DECIMAL(5,2)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><p><strong>Performance optimization</strong>: Use smaller precision types for faster operations</p><div class="language-scala" data-highlighter="shiki" data-ext="scala" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-scala"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// H2 default: DECIMAL(100, 0) for BigInt, DECIMAL(65, 30) for BigDecimal</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// PostgreSQL default: unrestricted DECIMAL</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Reduce precision for better performance when range is known</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> productId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneBigInt.dbColumnProperties(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">H2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;DECIMAL(19,0)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> amount</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneBigDecimal.dbColumnProperties(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">PostgreSQL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;DECIMAL(18,4)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><p><strong>Database-specific properties</strong>: Use database-specific column properties</p><div class="language-scala" data-highlighter="shiki" data-ext="scala" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-scala"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> description</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneString.dbColumnProperties(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">PostgreSQL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;TEXT COLLATE </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">en_US</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><p><strong>Storage optimization</strong>: Choose compact types for large tables</p><div class="language-scala" data-highlighter="shiki" data-ext="scala" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-scala"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">val</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> status</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> oneString.dbColumnProperties(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">H2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;CHAR(1)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><h2 id="important-notes" tabindex="-1"><a class="header-anchor" href="#important-notes"><span>Important Notes</span></a></h2><p><strong>Type compatibility</strong>: Custom column properties must maintain the same underlying JDBC type as the attribute&#39;s Scala type. For example, <code>VARCHAR(100)</code>, <code>TEXT</code>, and <code>CHAR(10)</code> all map to the same JDBC string type, so they&#39;re interchangeable for a <code>oneString</code> attribute. Molecule performs no runtime validation - incompatible properties will cause errors during schema creation or query execution.</p><p><strong>OneTypes only</strong>: Only scalar <code>OneTypes</code> (oneString, oneInt, oneDouble, etc.) support custom properties. Set/Seq/Map types have database-specific implementations and cannot be customized.</p><p><strong>Schema generation</strong>: Custom properties only affect schema generation via <code>sbt moleculeGen</code>. They don&#39;t modify runtime query behavior.</p><p><strong>Multiple databases</strong>: Define different column properties per database to handle database-specific syntax and features.</p><h2 id="migration-notes" tabindex="-1"><a class="header-anchor" href="#migration-notes"><span>Migration Notes</span></a></h2><p>Custom database column properties are opt-in and fully backwards compatible:</p><ul><li>Existing code continues to work unchanged</li><li>Attributes without custom properties use default Molecule types</li><li>Add custom properties only where needed</li><li>No changes required to existing domain structures</li></ul>`,37)])])}const o=i(n,[["render",l]]),k=JSON.parse('{"path":"/database/setup/db-column-props.html","title":"Custom db column props","lang":"en-US","frontmatter":{"description":"Custom db column props Molecule supports custom database column properties, allowing you to modify the basic SQL column types with varying properties at both the domain and attr...","toc":{"levels":[2,3]},"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Custom db column props\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-12-21T20:01:00.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://www.scalamolecule.org/intro/database/setup/db-column-props.html"}],["meta",{"property":"og:site_name","content":"Scala Molecule"}],["meta",{"property":"og:title","content":"Custom db column props"}],["meta",{"property":"og:description","content":"Custom db column props Molecule supports custom database column properties, allowing you to modify the basic SQL column types with varying properties at both the domain and attr..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-12-21T20:01:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-21T20:01:00.000Z"}]]},"git":{"createdTime":1766347260000,"updatedTime":1766347260000,"contributors":[{"name":"marcgrue","username":"marcgrue","email":"marcgrue@gmail.com","commits":1,"url":"https://github.com/marcgrue"}]},"filePathRelative":"database/setup/db-column-props.md","autoDesc":true}');export{o as comp,k as data};
