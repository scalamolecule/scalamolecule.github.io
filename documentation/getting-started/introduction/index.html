<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <link href='http://fonts.googleapis.com/css?family=Merriweather+Sans:400,300,300italic,400italic,700,700italic,800,800italic' rel='stylesheet' type='text/css'>
  <title>Introduction</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/highlight/styles/solarized_light.css" rel="stylesheet" />
  <link href="/css/style.css" rel="stylesheet">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/img/apple-touch-icon-57-precomposed.png">
  <link rel="shortcut icon" href="/img/favicon.png">
  <link href="" rel="alternate" type="application/rss+xml" title="Molecule" />
</head>
<body>
<div class="wrapper">
<div class="container" style="padding-top:20px">
  <div class="col-md-12 column" style="padding-left:0px; margin-bottom:15px">
    <div class="col-md-12 column" style="padding-left:0px;height:50px;">

    <ul class="nav nav-pills">
      <li><a href="/" style="padding-left: 6px; padding-right: 13px; vertical-align: top; margin-top: 0px;"><img src="/img/logo/MoleculeLogo600.png" alt="" width="200"></a></li>
      
      <li class="dropdown ">
        <a data-toggle="dropdown" href="/compare/" target="_top" onclick="javascript:top.location = '\/compare\/';return true;">Compare</a>
          <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
            <li><a href="/compare/datomic/">Datomic</a></li>
            <li class="dropdown-submenu">
              <a href="/compare/sql/">SQL</a>
              <ul class="dropdown-menu">
                <li><a href="/compare/sql/slick/">Slick</a></li>
              </ul>
            </li>
            <li><a href="/compare/gremlin/">Gremlin</a></li>
        </ul>
      </li>
      <li class="dropdown ">
        <a data-toggle="dropdown" href="/resources/" target="_top" onclick="javascript:top.location = '\/resources\/';return true;">Resources</a>
          <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
            <li class="dropdown-submenu">
              <a href="/resources/tutorials/">Tutorials</a>
              <ul class="dropdown-menu">
                <li><a href="/resources/tutorials/seattle/">Seattle</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a href="/resources/videos/">Videos</a>
              <ul class="dropdown-menu">
                <li><a href="/resources/videos/2017-04-25_marc_grue/">Molecule presentation</a></li>
              </ul>
            </li>
        </ul>
      </li>
      <li class="dropdown active">
        <a data-toggle="dropdown" href="/documentation/" target="_top" onclick="javascript:top.location = '\/documentation\/';return true;">Documentation</a>
          <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
            <li class="dropdown-submenu">
              <a href="/documentation/getting-started/">Getting started</a>
              <ul class="dropdown-menu">
                <li><a href="/documentation/getting-started/introduction/">Introduction</a></li>
                <li><a href="/documentation/getting-started/quickstart/">Demo quickstart</a></li>
                <li><a href="/documentation/getting-started/project-setup/">Project setup</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a href="/documentation/schema/">Schema</a>
              <ul class="dropdown-menu">
                <li><a href="/documentation/schema/transaction/">Transaction</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a href="/documentation/attributes/">Attributes</a>
              <ul class="dropdown-menu">
                <li><a href="/documentation/attributes/basics/">Basics</a></li>
                <li><a href="/documentation/attributes/modes/">Mandatory/Tacet/Optional</a></li>
                <li><a href="/documentation/attributes/mapped/">Map attributes</a></li>
                <li><a href="/documentation/attributes/expressions/">Expressions</a></li>
                <li><a href="/documentation/attributes/aggregates/">Aggregates</a></li>
                <li><a href="/documentation/attributes/parameterized/">Parameterized</a></li>
              </ul>
            </li>
            <li><a href="/documentation/entities/">Entities</a></li>
            <li class="dropdown-submenu">
              <a href="/documentation/relationships/">Relationships</a>
              <ul class="dropdown-menu">
                <li><a href="/documentation/relationships/card-one/">Cardinality one</a></li>
                <li><a href="/documentation/relationships/card-many/">Cardinality many</a></li>
                <li><a href="/documentation/relationships/nested/">Nested</a></li>
                <li><a href="/documentation/relationships/composites/">Composites</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a href="/documentation/crud/">CRUD</a>
              <ul class="dropdown-menu">
                <li><a href="/documentation/crud/save/">Save</a></li>
                <li><a href="/documentation/crud/insert/">Insert</a></li>
                <li><a href="/documentation/crud/get/">Get</a></li>
                <li><a href="/documentation/crud/update/">Update</a></li>
                <li><a href="/documentation/crud/retract/">Retract</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a href="/documentation/transactions/">Transactions</a>
              <ul class="dropdown-menu">
                <li><a href="/documentation/transactions/tx-data/">Tx data</a></li>
                <li><a href="/documentation/transactions/tx-meta-data/">Tx meta data</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a href="/documentation/time/">Time</a>
              <ul class="dropdown-menu">
                <li><a href="/documentation/time/asof/">AsOf</a></li>
                <li><a href="/documentation/time/since/">Since</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a href="/documentation/graphs/">Graphs</a>
              <ul class="dropdown-menu">
                <li><a href="/documentation/graphs/self/">Self</a></li>
                <li><a href="/documentation/graphs/other/">Other</a></li>
                <li><a href="/documentation/graphs/edge-self/">Edge self</a></li>
                <li><a href="/documentation/graphs/edge-other/">Edge other</a></li>
              </ul>
            </li>
        </ul>
      </li>
      <li class="dropdown ">
        <a data-toggle="dropdown" href="/developer/" target="_top" onclick="javascript:top.location = '\/developer\/';return true;">Developer</a>
          <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
            <li><a href="/developer/boilerplate/">Boilerplate</a></li>
            <li><a href="/developer/transformation/">Transformation</a></li>
        </ul>
      </li>
      <li class="dropdown ">
        <a data-toggle="dropdown" href="/community/" target="_top" onclick="javascript:top.location = '\/community\/';return true;">Community</a>
          <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
        </ul>
      </li>
      <li>
        <div  style="padding-left:14px;padding-top:19px;height:24px;float:right;">
            <a href="https://github.com/scalamolecule/molecule" class="github-button" data-icon="octicon-star">Github</a>
            
          </div>
      </li>
    </ul>

</div>
  </div> 

<div class="col-sm-10 column" style="padding-left:8px;">
	

<h1 id="molecule-introduction">Molecule introduction</h1>

<p>Molecule let&rsquo;s you model and query your domain data structures directly with the words of your domain.</p>

<h3 id="query">Query</h3>

<p>Describing our domain with Attributes grouped in Namespaces allow us to for instance find Persons in our Datomic database by composing molecules attribute by attribute with the builder pattern:</p>

<pre><code class="language-scala">val personMolecule = m(Person.name.age)
</code></pre>

<p>An implicit macro method <code>get</code> will at compile time translate our molecule to a Datalog query. And at runtime it will get executed against Datomic to retrieve a type-inferred <code>Iterable</code> of tuples:</p>

<pre><code class="language-scala">val persons: Iterable[(String, Int)] = Person.name.age.get
</code></pre>

<p>The attributes of our domain directly form our molecules. Furthermore the compiler prevents us from making any invalid queries since all molecules are type-infered already in our IDE.</p>

<h3 id="insert-and-update">Insert and update</h3>

<p>We also insert and update data with molecules:</p>

<pre><code class="language-scala">// Insert and retrieve new entity id
val lisaId = Person.name(&quot;Lisa&quot;).age(&quot;27&quot;).insert.eid

// Update
Person(lisaId).age(&quot;28&quot;).update
</code></pre>

<h3 id="expressive-powers">Expressive powers</h3>

<p>We can apply conditional values, ranges etc to our molecules to express more subtle data structures:</p>

<pre><code class="language-scala">Community.name.`type`(&quot;twitter&quot; or &quot;facebook_page&quot;)
  .Neighborhood.District.region(&quot;sw&quot; or &quot;s&quot; or &quot;se&quot;)
</code></pre>

<p>which will find &ldquo;names of twitter/facebook_page communities in neighborhoods of southern districts&rdquo;.</p>

<h2 id="datomic-and-molecule">Datomic and Molecule</h2>

<p>Molecule is a domain-tailored abstraction layer on top of the Datomic database. It can therefore be good to know a little about Datomic in order to understand Molecule.</p>

<h3 id="facts-datoms-with-time-built-in">Facts/Datoms with time built in</h3>

<p>Instead of mapping objects to tables or documents, the core unit of data in Molecule is an atomic piece of information: an <em>attribute</em>.</p>

<p>Attributes are composed to form &ldquo;molecules&rdquo; that describe unique and flexible data structures in endless combinations suiting your domain. Those are then translated to Datalog queries being executed against the underlying Datomic database.</p>

<p>An attribute in Datomic is part of a <em>fact</em> or <em>Datom</em> consisting of four elements:</p>

<pre><code> John     likes    pizza      12:35:54
   |        |        |           |
Entity  Attribute  Value  Transaction/time
</code></pre>

<p>With Molecule we could model the fact like this:</p>

<pre><code class="language-scala">Person(johnId).likes(&quot;pizza&quot;).update
</code></pre>

<p><em>likes</em> is an <code>attribute</code> with <code>value</code> <em>pizza</em>. It is <strong>asserted</strong> that the <code>entity</code> <em>johnId</em> likes pizza at <code>transaction</code> time 12:35:54. A timestamp is automatically set with all transactions. But if we need &ldquo;domain time&rdquo; we could add such attribute to the transaction as well, since this is simply a saved data structure in Datomic as our domain data.</p>

<h3 id="immutable-data">Immutable data</h3>

<p>Everytime a fact is asserted the old value of the attribute is <em>not deleted</em>. A Datomic database is immutable. We can go back in time and see the values of an attribute <em>at any point in time</em>. We could for instance see all our previous addresses if this was part of our domain model.</p>

<p>Also when we delete data, it&rsquo;s actually not deleted, but &ldquo;retracted&rdquo;. Retracted data doesn&rsquo;t show up when we are querying the current database. But if we look at the database at an earlier point in time we can see the data before it got retracted.</p>

<h3 id="namespaces-and-attributes">Namespaces and attributes</h3>

<p><code>attributes</code> are organized in <code>namespaces</code> to group related qualities of our domain:</p>

<p><img src="/img/DatomicElements1.png" alt="" /></p>

<h3 id="entity-row-in-an-sql-table">Entity != row in an sql Table</h3>

<p>An <code>entity</code> can have <em>any</em> <code>attribute</code> from <em>any</em> <code>namespace</code> associated to it:</p>

<p><img src="/img/DatomicElements2.png" alt="" /></p>

<p>An entity is therefore not like a row in a table but rather a &ldquo;cross-cutting&rdquo; thing that we can freely associate any attribute value to. Note how &ldquo;attrB1&rdquo; in this example is not associated to entity1.</p>

<h3 id="further-reading">Further reading&hellip;</h3>

<p>Go straight to the <a href="/tutorials/seattle">Molecule Seattle tutorial</a> to see a wide range of
 queries that Molecule can express, or check out first how we use Molecule to
 <a href="/manual/setup">setup the database</a> and <a href="/manual/insert">populated it with data</a>.</p>

</div>

<div class="col-sm-2 column" style="padding-left:20px;padding-top:22px;padding-right: 0px;">
  <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm ">
  <ul class="bs-docs-sidenav">
    
      
        
          
            <li><a href="/documentation/">Documentation</a></li>
            
          
        
          
            <li><a href="/documentation/getting-started/">Getting started</a></li>
            
              <ul class="level2">
                
                <li class="active"><b>Introduction</b></li>
                
              
                
                <li><a href="/documentation/getting-started/quickstart/">Demo quickstart</a></li>
                
              
                
                <li><a href="/documentation/getting-started/project-setup/">Project setup</a></li>
                
              
              </ul>
            
          
        
          
            <li><a href="/documentation/schema/">Schema</a></li>
            
              <ul class="level2">
                
                <li><a href="/documentation/schema/transaction/">Transaction</a></li>
                
              
              </ul>
            
          
        
          
            <li><a href="/documentation/attributes/">Attributes</a></li>
            
              <ul class="level2">
                
                <li><a href="/documentation/attributes/basics/">Basics</a></li>
                
              
                
                <li><a href="/documentation/attributes/modes/">Mandatory/Tacet/Optional</a></li>
                
              
                
                <li><a href="/documentation/attributes/mapped/">Map attributes</a></li>
                
              
                
                <li><a href="/documentation/attributes/expressions/">Expressions</a></li>
                
              
                
                <li><a href="/documentation/attributes/aggregates/">Aggregates</a></li>
                
              
                
                <li><a href="/documentation/attributes/parameterized/">Parameterized</a></li>
                
              
              </ul>
            
          
        
          
            <li><a href="/documentation/entities/">Entities</a></li>
            
          
        
          
            <li><a href="/documentation/relationships/">Relationships</a></li>
            
              <ul class="level2">
                
                <li><a href="/documentation/relationships/card-one/">Cardinality one</a></li>
                
              
                
                <li><a href="/documentation/relationships/card-many/">Cardinality many</a></li>
                
              
                
                <li><a href="/documentation/relationships/nested/">Nested</a></li>
                
              
                
                <li><a href="/documentation/relationships/composites/">Composites</a></li>
                
              
              </ul>
            
          
        
          
            <li><a href="/documentation/crud/">CRUD</a></li>
            
              <ul class="level2">
                
                <li><a href="/documentation/crud/save/">Save</a></li>
                
              
                
                <li><a href="/documentation/crud/insert/">Insert</a></li>
                
              
                
                <li><a href="/documentation/crud/get/">Get</a></li>
                
              
                
                <li><a href="/documentation/crud/update/">Update</a></li>
                
              
                
                <li><a href="/documentation/crud/retract/">Retract</a></li>
                
              
              </ul>
            
          
        
          
            <li><a href="/documentation/transactions/">Transactions</a></li>
            
              <ul class="level2">
                
                <li><a href="/documentation/transactions/tx-data/">Tx data</a></li>
                
              
                
                <li><a href="/documentation/transactions/tx-meta-data/">Tx meta data</a></li>
                
              
              </ul>
            
          
        
          
            <li><a href="/documentation/time/">Time</a></li>
            
              <ul class="level2">
                
                <li><a href="/documentation/time/asof/">AsOf</a></li>
                
              
                
                <li><a href="/documentation/time/since/">Since</a></li>
                
              
              </ul>
            
          
        
          
            <li><a href="/documentation/graphs/">Graphs</a></li>
            
              <ul class="level2">
                
                <li><a href="/documentation/graphs/self/">Self</a></li>
                
              
                
                <li><a href="/documentation/graphs/other/">Other</a></li>
                
              
                
                <li><a href="/documentation/graphs/edge-self/">Edge self</a></li>
                
              
                
                <li><a href="/documentation/graphs/edge-other/">Edge other</a></li>
                
              
              </ul>
            
          
        
      
    
  </ul>
</nav>
</div>

     
  </div> 
</div> 
<div class="push"></div>
</div> 

<footer class="bs-docs-footer">

  <div class="container">
    <ul class="bs-docs-footer-links">
      <li style="vertical-align: top; margin-top: 0px;"><a href="/front/"><img src="/img/logo/MoleculeLogo200.png" alt=""></a></li>
      <li><a href="https://github.com/scalamolecule/molecule">GitHub</a></li>
      <li><a href="https://groups.google.com/forum/#!forum/molecule-dsl">Forum</a></li>
      <li><a href="/about/">About</a></li>
      <li><a href="/credits/">Credits</a></li>
    </ul>
    <p> Created by Marc Grue. Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="license">Apache License 2.0</a></p>
  </div>
</footer>


<script type="text/javascript" src="/js/jquery-1.11.2.min.js"></script>



<script type="text/javascript" src="/js/bootstrap.min.js"></script>



<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript" src="/js/scripts.js"></script>




<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2787756-3', 'auto');
  ga('send', 'pageview');
</script>
    
</body>
</html>
