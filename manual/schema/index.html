<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link href='http://fonts.googleapis.com/css?family=Merriweather+Sans:400,300,300italic,400italic,700,700italic,800,800italic' rel='stylesheet' type='text/css'>
  <title>Schema</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/highlight/styles/solarized_light.css" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="/vendor/font-awesome/css/font-awesome.min.css">
  <link href="/css/style.css" rel="stylesheet">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/img/apple-touch-icon-57-precomposed.png">
  <link rel="shortcut icon" href="/img/favicon.png">
  <link href="" rel="alternate" type="application/rss+xml" title="Molecule" />
</head>
<body>
<div class="wrapper">
<div class="container" style="padding-top:20px">
  <div class="col-md-12 column" style="padding-left:0px; margin-bottom:15px">
    <div class="col-md-12 column" style="padding-left:0px;height:50px;">

    <ul class="nav nav-pills">
      <li><a href="/" style="padding-left: 6px; padding-right: 13px; vertical-align: top; margin-top: 0px;"><img src="/img/logo/MoleculeLogo600.png" alt="" width="200"></a></li>
      
      
      
        <li class="dropdown ">
          <a data-toggle="dropdown" href="/compare/" target="_top" onclick="javascript:top.location = '\/compare\/';return true;">Compare</a>
          
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
              
                
              
                

                  
                    <li><a href="/compare/datomic/">Datomic</a></li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/compare/sql/">SQL</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/compare/sql/slick/">Slick</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li><a href="/compare/gremlin/">Gremlin</a></li>
                  

                
              
            </ul>
          
        </li>
      
      
        <li class="dropdown ">
          <a data-toggle="dropdown" href="/resources/" target="_top" onclick="javascript:top.location = '\/resources\/';return true;">Resources</a>
          
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
              
                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/resources/tutorials/">Tutorials</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/resources/tutorials/seattle/">Seattle</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/resources/videos/">Videos</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/resources/videos/2017-04-25_Marc_Grue/">Molecule presentation</a></li>
                        
                      </ul>
                    </li>
                  

                
              
            </ul>
          
        </li>
      
      
        <li class="dropdown active">
          <a data-toggle="dropdown" href="/manual/" target="_top" onclick="javascript:top.location = '\/manual\/';return true;">Manual</a>
          
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/manual/">Quick start</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/manual/quick-start/introduction/">Introduction</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li><a href="/manual/setup/">Setup</a></li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/manual/schema/">Schema</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/manual/schema/transaction/">Transaction</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/manual/attributes/">Attributes</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/manual/attributes/basics/">Basics</a></li>
                        
                          <li><a href="/manual/attributes/modes/">Mandatory/Tacit/Optional</a></li>
                        
                          <li><a href="/manual/attributes/mapped/">Map attributes</a></li>
                        
                          <li><a href="/manual/attributes/expressions/">Expressions</a></li>
                        
                          <li><a href="/manual/attributes/aggregates/">Aggregates</a></li>
                        
                          <li><a href="/manual/attributes/parameterized/">Parameterized</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li><a href="/manual/entities/">Entities</a></li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/manual/relationships/">Relationships</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/manual/relationships/card-one/">Cardinality one</a></li>
                        
                          <li><a href="/manual/relationships/card-many/">Cardinality many</a></li>
                        
                          <li><a href="/manual/relationships/composites/">Composites</a></li>
                        
                          <li><a href="/manual/relationships/bidirectional/">Bidirectional</a></li>
                        
                          <li><a href="/manual/relationships/self-join/">Self-join</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/manual/crud/">CRUD</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/manual/crud/save/">Save</a></li>
                        
                          <li><a href="/manual/crud/insert/">Insert</a></li>
                        
                          <li><a href="/manual/crud/composite-insert/">Composite insert</a></li>
                        
                          <li><a href="/manual/crud/get/">Get</a></li>
                        
                          <li><a href="/manual/crud/getJson/">Get Json</a></li>
                        
                          <li><a href="/manual/crud/update/">Update</a></li>
                        
                          <li><a href="/manual/crud/retract/">Retract</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/manual/transactions/">Transactions</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/manual/transactions/tx-meta-data/">Tx meta data</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/manual/time/">Time</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/manual/time/asof-since/">AsOf/Since</a></li>
                        
                          <li><a href="/manual/time/history/">History</a></li>
                        
                          <li><a href="/manual/time/with/">With</a></li>
                        
                          <li><a href="/manual/time/testing/">Testing</a></li>
                        
                      </ul>
                    </li>
                  

                
              
            </ul>
          
        </li>
      
      
        <li class="dropdown ">
          <a data-toggle="dropdown" href="/api/molecule" target="_top" onclick="javascript:top.location = '\/api\/molecule';return true;">API docs</a>
          
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/api/molecule/action">action</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/api/molecule/action/CompositeInserts.html">CompositeInserts</a></li>
                        
                          <li><a href="/api/molecule/action/Entity.html">Entity</a></li>
                        
                          <li><a href="/api/molecule/action/EntityOps.html">EntityOps</a></li>
                        
                          <li><a href="/api/molecule/action/Molecule.html">Molecule</a></li>
                        
                          <li><a href="/api/molecule/action/OptionalMapOps.html">OptionalMapOps</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/api/molecule/composition">composition</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/api/molecule/composition/Composite.html">Composite</a></li>
                        
                          <li><a href="/api/molecule/composition/CompositeInit.html">CompositeInit</a></li>
                        
                          <li><a href="/api/molecule/composition/CompositeInit_In_1.html">CompositeInit_In_1</a></li>
                        
                          <li><a href="/api/molecule/composition/CompositeInit_In_2.html">CompositeInit_In_2</a></li>
                        
                          <li><a href="/api/molecule/composition/CompositeInit_In_3.html">CompositeInit_In_3</a></li>
                        
                          <li><a href="/api/molecule/composition/Composite_In_1.html">Composite_In_1</a></li>
                        
                          <li><a href="/api/molecule/composition/Composite_In_2.html">Composite_In_2</a></li>
                        
                          <li><a href="/api/molecule/composition/Composite_In_3.html">Composite_In_3</a></li>
                        
                          <li><a href="/api/molecule/composition/Nested.html">Nested</a></li>
                        
                          <li><a href="/api/molecule/composition/Nested_In_1.html">Nested_In_1</a></li>
                        
                          <li><a href="/api/molecule/composition/Nested_In_2.html">Nested_In_2</a></li>
                        
                          <li><a href="/api/molecule/composition/Nested_In_3.html">Nested_In_3</a></li>
                        
                          <li><a href="/api/molecule/composition/Tx.html">Tx</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/api/molecule/exceptions">exceptions</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/api/molecule/exceptions/package$$MoleculeException.html">MoleculeException</a></li>
                        
                          <li><a href="/api/molecule/exceptions/package$$QueryException.html">QueryException</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/api/molecule/expression">expression</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/api/molecule/expression/AggregateKeywords.html">AggregateKeywords</a></li>
                        
                          <li><a href="/api/molecule/expression/AttrExpressions.html">AttrExpressions</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/api/molecule/facade">facade</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/api/molecule/facade/Conn.html">Conn</a></li>
                        
                          <li><a href="/api/molecule/facade/Datomic.html">Datomic</a></li>
                        
                          <li><a href="/api/molecule/facade/TxReport.html">TxReport</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/api/molecule/factory">factory</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/api/molecule/factory/Composite_Factory.html">Composite_Factory</a></li>
                        
                          <li><a href="/api/molecule/factory/Composite_In_1_Factory.html">Composite_In_1_Factory</a></li>
                        
                          <li><a href="/api/molecule/factory/Composite_In_2_Factory.html">Composite_In_2_Factory</a></li>
                        
                          <li><a href="/api/molecule/factory/Composite_In_3_Factory.html">Composite_In_3_Factory</a></li>
                        
                          <li><a href="/api/molecule/factory/Molecule_Factory.html">Molecule_Factory</a></li>
                        
                          <li><a href="/api/molecule/factory/Molecule_In_1_Factory.html">Molecule_In_1_Factory</a></li>
                        
                          <li><a href="/api/molecule/factory/Molecule_In_2_Factory.html">Molecule_In_2_Factory</a></li>
                        
                          <li><a href="/api/molecule/factory/Molecule_In_3_Factory.html">Molecule_In_3_Factory</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/api/molecule/generic">generic</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/api/molecule/generic/Datom.html">Datom</a></li>
                        
                          <li><a href="/api/molecule/generic/Db.html">Db</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/api/molecule/input">input</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/api/molecule/input/InputMolecule.html">InputMolecule</a></li>
                        
                          <li><a href="/api/molecule/input/InputMolecule_1.html">InputMolecule_1</a></li>
                        
                          <li><a href="/api/molecule/input/InputMolecule_2.html">InputMolecule_2</a></li>
                        
                          <li><a href="/api/molecule/input/InputMolecule_3.html">InputMolecule_3</a></li>
                        
                      </ul>
                    </li>
                  

                
              
                

                  
                    <li class="dropdown-submenu">
                      <a href="/api/molecule/schema">schema</a>
                      <ul class="dropdown-menu">
                        
                          <li><a href="/api/molecule/schema/SchemaTransaction.html">SchemaTransaction</a></li>
                        
                          <li><a href="/api/molecule/schema/definition$.html">definition</a></li>
                        
                      </ul>
                    </li>
                  

                
              
            </ul>
          
        </li>
      
      
        <li class="dropdown ">
          <a data-toggle="dropdown" href="/dev/" target="_top" onclick="javascript:top.location = '\/dev\/';return true;">Dev</a>
          
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
              
                

                  
                    <li><a href="/dev/">Developer</a></li>
                  

                
              
                

                  
                    <li><a href="/dev/boilerplate/">Boilerplate</a></li>
                  

                
              
                

                  
                    <li><a href="/dev/transformation/">Transformation</a></li>
                  

                
              
            </ul>
          
        </li>
      
      
        <li class="dropdown ">
          <a data-toggle="dropdown" href="/community/" target="_top" onclick="javascript:top.location = '\/community\/';return true;">Community</a>
          
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
              
                
              
                

                  
                    <li><a href="https://groups.google.com/forum/#!forum/molecule-dsl">Forum</a></li>
                  

                
              
                

                  
                    <li><a href="https://github.com/scalamolecule/molecule">Github</a></li>
                  

                
              
                

                  
                    <li><a href="https://github.com/scalamolecule/molecule/issues">Molecule issues</a></li>
                  

                
              
                

                  
                    <li><a href="https://github.com/scalamolecule/molecule-docs/issues">Molecule docs issues</a></li>
                  

                
              
            </ul>
          
        </li>
      
      <li>
        <div  style="padding-left:14px;padding-top:19px;height:24px;float:right;">
            <a href="https://github.com/scalamolecule/molecule" class="github-button" data-icon="octicon-star">Github</a>
            
          </div>
      </li>
    </ul>

</div>
  </div> 

<div class="col-sm-10 column" style="padding-left:8px;">
	

<h1 id="schema">Schema</h1>

<p>A <a href="http://docs.datomic.com/schema.html">Datomic schema</a> defines the set of possible attributes that we can use.</p>

<p>In Molecule we make this definition in a Schema definition file:</p>

<h2 id="schema-definition-file">Schema definition file</h2>

<p>Molecule provides an intuitive and type-safe dsl to model your schema in a Schema definition file.
After each change you make in this file you need to compile your project with <code>sbt compile</code> so that the
sbt-plugin can create a Molecule DSL from your definitions.</p>

<p>Let&rsquo;s look at the schema definition from the <a href="/resources/tutorials/seattle">Seattle tutorial</a>:</p>

<pre><code class="language-scala">package path.to.your.project
import molecule.schema.definition._  // import schema definition DSL

@InOut(3, 8)
object SeattleDefinition {

  trait Community {
    val name         = oneString.fulltextSearch.doc(&quot;A community's name&quot;) // optional doc text
    val url          = oneString
    val category     = manyString.fulltextSearch
    val orgtype      = oneEnum('community, 'commercial, 'nonprofit, 'personal)
    val `type`       = oneEnum('email_list, 'twitter, 'facebook_page) // + more...
    val neighborhood = one[Neighborhood]
  }

  trait Neighborhood {
    val name     = oneString
    val district = one[District]
  }

  trait District {
    val name   = oneString
    val region = oneEnum('n, 'ne, 'e, 'se, 's, 'sw, 'w, 'nw)
  }
}
</code></pre>

<p>The outer object <code>SeattleDefinition</code> encapsulates our schema definition. The name of this object has to end with &ldquo;Definition&rdquo;
in order for the sbt-molecule plugin to recognize it.</p>

<h3 id="custom-scala-doc-generation">Custom Scala Doc generation</h3>

<p>The sbt-molecule plugin even generates ScalaDoc documentation for the custom DSL generated form the schema definition file!
Attribute types are explained and an optional <code>doc(&lt;text...&gt;)</code> can be added to give a hint about the attribute when
working with the code in the IDE. Given the <code>doc</code> text above for the <code>Community.name</code> attribute we can see this in our
IDE:</p>

<p><img src="/img/schema/attr-doc.png" alt="Attribute Scala docs" /></p>

<h3 id="molecule-arity">Molecule arity</h3>

<p>The <code>@InOut(3, 8)</code> arity annotation instructs the sbt-molecule plugin to generate boilerplate code with the ability to create
molecules with up to 8 attributes including up to 3 <a href="/manual/attributes/parameterized">input attributes</a>.</p>

<p>When developing your schema you might just set the first arity annotation variable for input attributes to <code>0</code> and
then later when your schema is stabilizing add the ability to make input molecules by setting it to 1, 2 or 3 (the maximum).
Using parameterized input attributes can be a performance
optimization since using input values in Datalog queries allow Datomic to cache the query.</p>

<p>The second arity annotation parameter basically tells how long molecules you can build (this doesn&rsquo;t affect
 how many attributes you can <em>define</em> in each namespace). Generally you want to keep this number as low as possible
 not to generate more boilerplate code than necessary. The maximum arity is 22, the same as for tuples.</p>

<p>If you at some point need to make molecules with more than 22 attributes you can use
<a href="/manual/relationships/composites">composite molecules</a> or insert/query in two steps as
described in <a href="/manual/attributes/basics">attribute basics</a>.</p>

<h3 id="namespaces">Namespaces</h3>

<p>Attribute names in Datomic are namespaced keywords with the lexical form <code>&lt;Namespace&gt;.&lt;attribute&gt;</code>. Molecule lets you
define the <code>&lt;Namespace&gt;</code> part with the name of the trait, like <code>Community</code> in the Seattle
example above. In this way Molecule can construct the full name of the <code>Community.category</code> attribute etc.</p>

<p><img src="/img/DatomicElements1.png" alt="Schema" /></p>

<h3 id="namespace-table">Namespace != Table</h3>

<p>If coming from an sql background one might at first think of a namespace as
a table having columns (attributes). But this is not the case. An
entity in Datomic can associate values of attributes <em>from any namespace</em>:</p>

<p><img src="/img/DatomicElements2.png" alt="" /></p>

<p>So, when we build a molecule</p>

<pre><code>val toughCommunities = Community.name.Neighborhood.name(&quot;Tough&quot;).get
</code></pre>

<p>we <em>shouldn&rsquo;t</em> think of it like a</p>

<p>&ldquo;<code>Community</code> table with <code>name</code> field with a join to <code>Neighborhood</code> table with a <code>name</code> field set to &lsquo;Tough&rsquo;&rdquo; (wrong!)</p>

<p>but rather think it as</p>

<p>&ldquo;<strong><em>Entities</em></strong> with a <code>communityName</code> attribute having a reference to an entity with a <code>neighborhoodName</code> value &lsquo;Tough&rsquo;&rdquo;</p>

<h2 id="partitions">Partitions</h2>

<p>Namespaces can also be organized in partitions.</p>

<p>From the <a href="http://docs.datomic.com/schema.html">Datomic schema</a> reference:</p>

<p>&ldquo;All entities created in a database reside within a partition. Partitions group data together, providing locality of reference
when executing queries across a collection of entities. In general, you want to group entities based on how you&rsquo;ll use them.
Entities you&rsquo;ll often query across - like the community-related entities in our sample data - should be in the same partition
to increase query performance. Different logical groups of entities should be in different partitions. Partitions are discussed
in more detail in the Indexes topic.&rdquo;</p>

<p>In the schema definition file we can organize namespaces in partitions with objects:</p>

<pre><code class="language-scala">@InOut(0, 4)
object PartitionTestDefinition {

  object gen {
    trait Person {
      val name   = oneString
      val gender = oneEnum('male, 'female)
    }
    // ..more namespaces in the `gen` partition
  }

  object lit {
    trait Book {
      val title  = oneString
      val author = one[gen.Person]
      // To avoid attr/partition name clashes we can prepend the definition object name
      // (in case we would have needed an attribute named `gen` for instance)
      val editor = one[PartitionTestDefinition.gen.Person]
      val cat    = oneEnum('good, 'bad)
    }
    // ..more namespaces in the `lit` partition
  }
}
</code></pre>

<p>Here we have a <code>gen</code> (general) partition and a <code>lit</code> (litterature) partition. Each partition can contain as many
namespaces as you want. This can be a way also to structure large domains conceptually. The partition name has to be
lowercase and is prepended to the namespaces it contains.</p>

<p>When we build molecules the partition name is prepended to the namespace like this:</p>

<pre><code class="language-scala">lit_Book.title.cat.Author.name.gender.get === ...
</code></pre>

<p>Since <code>Author</code> is already defined as a related namespace we don&rsquo;t need to prepend the partition name there.</p>

<p>When we insert a <code>Person</code> the created entity will automatically be saved in the <code>gen</code> partition (or whatever we call it).</p>

<h2 id="attribute-types">Attribute types</h2>

<p>In the Seattle example we see the attributes being defined with the following types that should be
 pretty self-explanatory:</p>

<ul>
<li><code>oneString</code>, <code>manyString</code> etc defines cardinality and type of an attribute</li>
<li><code>oneEnum</code>/<code>manyEnum</code> defines enumerated values (pre-defined words)</li>
<li><code>one[&lt;ReferencedNamespace&gt;]</code> defines a reference to another namespace</li>
</ul>

<p>We can define the following types of attributes:</p>

<pre><code>Cardinality one              Cardinality many                 Mapped cardinality many
-------------------          -------------------------        --------------------------------
oneString     : String       manyString    : Set[String]      mapString     : Map[String, String]
oneInt        : Int          manyInt       : Set[Int]         mapInt        : Map[String, Int]
oneLong       : Long         manyLong      : Set[Long]        mapLong       : Map[String, Long]
oneFloat      : Float        manyFloat     : Set[Float]       mapFloat      : Map[String, Float]
oneDouble     : Double       manyDouble    : Set[Double]      mapDouble     : Map[String, Double]
oneBigInt     : BigInt       manyBigInt    : Set[BigInt]      mapBigInt     : Map[String, BigInt]
oneBigDecimal : BigDecimal   manyBigDecimal: Set[BigDecimal]  mapBigDecimal : Map[String, BigDecimal]
oneBoolean    : Boolean      manyBoolean   : Set[Boolean]     mapBoolean    : Map[String, Boolean]
oneDate       : Date         manyDate      : Set[Date]        mapDate       : Map[String, Date]
oneUUID       : UUID         manyUUID      : Set[UUID]        mapUUID       : Map[String, UUID]
oneURI        : URI          manyURI       : Set[URI]         mapURI        : Map[String, URI]
oneEnum       : String       manyEnum      : Set[String]
</code></pre>

<p>Cardinality-one attributes can have one value per entity.</p>

<p>Cardinality-many attributes can have a <em>Set of unique values</em> per entity. Often we choose instead to model many-values as a
many-reference to another entity that could have more than one attribute.</p>

<p>Mapped cardinality many attributes are a special Molecule variation based on cardinality-many attributes. Read more <a href="/manual/attributes/mapped">here</a>&hellip;</p>

<h3 id="reference-types">Reference types</h3>

<p>References are also treated like attributes. It&rsquo;s basically a reference to one or many entities.
We define such relationship by supplying the referenced namespace as the type parameter to <code>one</code>/<code>many</code>:</p>

<pre><code>Cardinality one         Cardinality many
---------------         ----------------
one[&lt;Ref-namespace&gt;]    many[&lt;Ref-namespace&gt;]
</code></pre>

<p>In the example above we saw a reference from Community to Neighborhood defined as <code>one[Neighborhood]</code>. We would for instance
likely define an Order/OrderLine relationship in an Order namespace as <code>many[OrderLine]</code>.</p>

<h2 id="attribute-options">Attribute options</h2>

<p>Each attribute can also have some extra options:</p>

<p>
<table border="1" cellpadding="5" cellspacing="0" style="background-color:#f5f5f5;">
  <tr>
    <th align="left" valign="top" scope="col">Option</th>
    <th valign="top" scope="col"><strong>Indexes</strong></th>
    <th scope="col">Description</th>
  </tr>
  <tr valign="top">
    <td valign="top">doc</td>
    <td align="center" valign="top">&nbsp;</td>
    <td>Attribute description.</td>
  </tr>
  <tr valign="top">
    <td valign="top">uniqueValue</td>
    <td align="center" valign="top">✔︎</td>
    <td>Attribute value is unique to each entity.<br>
      <em>Attempts to insert a duplicate value for a different entity id will fail.</em></td>
  </tr>
  <tr valign="top">
    <td valign="top">uniqueIdentity</td>
    <td align="center" valign="top">✔︎</td>
    <td>Attribute value is unique to each entity and &quot;upsert&quot; is enabled.<br>
      <em>Attempts to insert a duplicate value for a temporary entity id will cause all attributes associated with that temporary 
      id to be merged with the entity already in the database.</em></td>
  </tr>
  <tr>
    <td valign="top">indexed</td>
    <td align="center" valign="top">✔︎</td>
    <td>Generated index for this attribute. By default all attributes are set with the indexed option automatically by Molecule, so you don't need to set this.</td>
  </tr>
  <tr>
    <td valign="top">fulltextSearch</td>
    <td align="center" valign="top">✔︎</td>
    <td>Generate eventually consistent fulltext search index for this attribute.</td>
  </tr>
  <tr>
    <td valign="top">isComponent</td>
    <td align="center" valign="top">✔︎</td>
    <td>Specifies that an attribute whose type is :db.type/ref is a component. Referenced entities become subcomponents of the entity to which the attribute is applied.<br>
    <em>When you retract an entity with :db.fn/retractEntity, all subcomponents are also retracted. When you touch an entity, all its 
    subcomponent entities are touched recursively.</em></td>
  </tr>
  <tr>
    <td valign="top">noHistory</td>
    <td align="center" valign="top">&nbsp;</td>
    <td>Whether past values of an attribute should not be retained.</td>
  </tr>
</table>
</p>

<p>Datomic indexes the values of all attributes having an option except for the <code>doc</code> and <code>noHistory</code> options.</p>

<p>As you saw, we added <code>fulltextSearch</code> to some of the attributes in the Seattle definition above. Molecule&rsquo;s schema
definition DSL let&rsquo;s you only choose allowed options for any attribute type.</p>

<h3 id="next">Next</h3>

<p><a href="/manual/schema/transaction">Schema transaction&hellip;</a></p>

</div>

<div class="col-sm-2 column" style="padding-left:20px;padding-top:22px;padding-right: 0px;">
  <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm ">

  <div style="position:absolute;top: -36px; left: 0px;">
    
    <a class="navigation-control up" href="/manual/setup" style="position:absolute; top:0px; left: 56px">
      <span class="glyphicon glyphicon-chevron-up"></span>
    </a>
    
    
    <a class="navigation-control left" href="/manual/setup" style="position:absolute; top: 15px; left: 20px">
      <span class="glyphicon glyphicon-chevron-left"></span>
    </a>
    
    
    <a class="navigation-control right" href="/manual/schema/transaction" style="position:absolute; top: 15px; left: 89px">
      <span class="glyphicon glyphicon-chevron-right"></span>
    </a>
    
    
    <a class="navigation-control right" href="/manual/attributes" style="position:absolute; top: 30px; left: 54px;">
      <span class="glyphicon glyphicon-chevron-down"></span>
    </a>
    
  </div>

  <ul class="bs-docs-sidenav">
    
    
    
    
    <li><a href="/manual/">Quick start</a></li>
    
    <ul class="level2">
      
      <li><a href="/manual/quick-start/introduction/">Introduction</a></li>
      
      
    </ul>
    
    
    
    
    <li><a href="/manual/setup/">Setup</a></li>
    
    
    
    
    <li class="active"><b>Schema</b></li>
    
    <ul class="level2">
      <li><a href="/manual/schema/transaction/">Transaction</a></li>
      
    </ul>
    
    
    
    
    <li><a href="/manual/attributes/">Attributes</a></li>
    
    <ul class="level2">
      
      <li><a href="/manual/attributes/basics/">Basics</a></li>
      
      
      
      <li><a href="/manual/attributes/modes/">Mandatory/Tacit/Optional</a></li>
      
      
      
      <li><a href="/manual/attributes/mapped/">Map attributes</a></li>
      
      
      
      <li><a href="/manual/attributes/expressions/">Expressions</a></li>
      
      
      
      <li><a href="/manual/attributes/aggregates/">Aggregates</a></li>
      
      
      
      <li><a href="/manual/attributes/parameterized/">Parameterized</a></li>
      
      
    </ul>
    
    
    
    
    <li><a href="/manual/entities/">Entities</a></li>
    
    
    
    
    <li><a href="/manual/relationships/">Relationships</a></li>
    
    <ul class="level2">
      
      <li><a href="/manual/relationships/card-one/">Cardinality one</a></li>
      
      
      
      <li><a href="/manual/relationships/card-many/">Cardinality many</a></li>
      
      
      
      <li><a href="/manual/relationships/composites/">Composites</a></li>
      
      
      
      <li><a href="/manual/relationships/bidirectional/">Bidirectional</a></li>
      
      
      
      <li><a href="/manual/relationships/self-join/">Self-join</a></li>
      
      
    </ul>
    
    
    
    
    <li><a href="/manual/crud/">CRUD</a></li>
    
    <ul class="level2">
      
      <li><a href="/manual/crud/save/">Save</a></li>
      
      
      
      <li><a href="/manual/crud/insert/">Insert</a></li>
      
      
      
      <li><a href="/manual/crud/composite-insert/">Composite insert</a></li>
      
      
      
      <li><a href="/manual/crud/get/">Get</a></li>
      
      
      
      <li><a href="/manual/crud/getJson/">Get Json</a></li>
      
      
      
      <li><a href="/manual/crud/update/">Update</a></li>
      
      
      
      <li><a href="/manual/crud/retract/">Retract</a></li>
      
      
    </ul>
    
    
    
    
    <li><a href="/manual/transactions/">Transactions</a></li>
    
    <ul class="level2">
      
      <li><a href="/manual/transactions/tx-meta-data/">Tx meta data</a></li>
      
      
    </ul>
    
    
    
    
    <li><a href="/manual/time/">Time</a></li>
    
    <ul class="level2">
      
      <li><a href="/manual/time/asof-since/">AsOf/Since</a></li>
      
      
      
      <li><a href="/manual/time/history/">History</a></li>
      
      
      
      <li><a href="/manual/time/with/">With</a></li>
      
      
      
      <li><a href="/manual/time/testing/">Testing</a></li>
      
      
    </ul>
    
    
    
    
    
  </ul>
</nav>
</div>

     
  </div> 
</div> 
<div class="push"></div>
</div> 

<footer class="bs-docs-footer">

  <div class="container">
    <ul class="bs-docs-footer-links">
      <li style="vertical-align: top; margin-top: 0px;"><a href="/front/"><img src="/img/logo/MoleculeLogo200.png" alt=""></a></li>
      <li><a href="https://github.com/scalamolecule/molecule">GitHub</a></li>
      <li><a href="https://github.com/scalamolecule/molecule-docs">GitHub-docs</a></li>
      <li><a href="https://groups.google.com/forum/#!forum/molecule-dsl">Forum</a></li>
      <li><a href="/about/">About</a></li>
      <li><a href="/credits/">Credits</a></li>
    </ul>
    <p>Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="license">Apache License 2.0</a></p>
  </div>
</footer>


<script type="text/javascript" src="/js/jquery-1.11.2.min.js"></script>



<script type="text/javascript" src="/js/bootstrap.min.js"></script>



<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript" src="/js/scripts.js"></script>




<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2787756-3', 'auto');
  ga('send', 'pageview');
</script>
    
</body>
</html>
