<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <link href='http://fonts.googleapis.com/css?family=Merriweather+Sans:400,300,300italic,400italic,700,700italic,800,800italic' rel='stylesheet' type='text/css'>
  <title>Attribute</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/highlight/styles/solarized_light.css" rel="stylesheet" />
  <link href="/css/style.css" rel="stylesheet">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/img/apple-touch-icon-57-precomposed.png">
  <link rel="shortcut icon" href="/img/favicon.png">
  <link href="" rel="alternate" type="application/rss+xml" title="Molecule" />
</head>
<body>
<br>
<div class="container">
  <div class="col-md-12 column" style="padding-left:0px;">
    <div class="col-md-12 column" style="padding-left:0px;height:30px;">
      <div class="col-sm-11 column" style="padding-left:0;">
        <ul class="nav nav-pills">
          <li class="dropdown ">
            <a data-toggle="dropdown" href="/" target="_top" onclick="javascript:top.location = '/';return true;">Molecule</a>
              <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                <li><a href="http://localhost:1313/">Home</a></li>
                <li><a href="http://localhost:1313/home/introduction/">Introduction</a></li>
                <li><a href="http://localhost:1313/home/setup/">Setup</a></li>
                <li><a href="http://localhost:1313/home/about/">About</a></li>
            </ul>
          </li>
          <li class="dropdown ">
            <a data-toggle="dropdown" href="http://localhost:1313/compare/overview/" target="_top" onclick="javascript:top.location = 'http:\/\/localhost:1313\/compare\/overview\/';return true;">Compare</a>
              <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                <li><a href="http://localhost:1313/compare/datomic/">Datomic</a></li>
                <li class="dropdown-submenu">
                  <a href="http://localhost:1313/compare/sql/">SQL</a>
                  <ul class="dropdown-menu">
                    <li><a href="http://localhost:1313/compare/sql/slick/">Slick</a></li>
                  </ul>
                </li>
            </ul>
          </li>
          <li class="dropdown ">
            <a data-toggle="dropdown" href="http://localhost:1313/tutorials/overview/" target="_top" onclick="javascript:top.location = 'http:\/\/localhost:1313\/tutorials\/overview\/';return true;">Tutorials</a>
              <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                <li><a href="http://localhost:1313/tutorials/seattle/">Seattle</a></li>
            </ul>
          </li>
          <li class="dropdown active">
            <a data-toggle="dropdown" href="http://localhost:1313/manual/overview/" target="_top" onclick="javascript:top.location = 'http:\/\/localhost:1313\/manual\/overview\/';return true;">Manual</a>
              <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                <li class="dropdown-submenu">
                  <a href="http://localhost:1313/manual/attributes/">Attribute</a>
                  <ul class="dropdown-menu">
                    <li><a href="http://localhost:1313/manual/attributes/builder/">Building</a></li>
                    <li><a href="http://localhost:1313/manual/attributes/types/">Types</a></li>
                  </ul>
                </li>
                <li><a href="http://localhost:1313/manual/database-setup/">Database setup</a></li>
                <li><a href="http://localhost:1313/manual/modelling/">Modelling</a></li>
                <li class="dropdown-submenu">
                  <a href="http://localhost:1313/manual/schema/">Schema</a>
                  <ul class="dropdown-menu">
                    <li><a href="http://localhost:1313/manual/schema/schema-definition/">Schema definition</a></li>
                  </ul>
                </li>
                <li><a href="http://localhost:1313/manual/populate-database/">Populate database</a></li>
            </ul>
          </li>
          <li class="dropdown ">
            <a data-toggle="dropdown" href="http://localhost:1313/developer/overview/" target="_top" onclick="javascript:top.location = 'http:\/\/localhost:1313\/developer\/overview\/';return true;">Developer</a>
              <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                <li><a href="http://localhost:1313/developer/transformation/">Transformation</a></li>
            </ul>
          </li>
          <li class="dropdown ">
            <a data-toggle="dropdown" href="http://localhost:1313/community/overview/" target="_top" onclick="javascript:top.location = 'http:\/\/localhost:1313\/community\/overview\/';return true;">Community</a>
              <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                <li><a href="http://localhost:1313/community/forum/">Forum</a></li>
            </ul>
          </li>
        </ul>
      </div>

      <div class="col-xs-1 column" style="padding:4px;height:25px;float:right;">
        <a href="https://github.com/scalamolecule/molecule" class="github-button" data-icon="octicon-star">Github</a>        
      </div>
    </div>
  </div> 

<div class="col-sm-2 column" style="padding-left:0;padding-top:22px;padding-left:10px;">
  <ul style="list-style: none; padding:0; margin:0;font-size:12px;">
    <li><a href="http://localhost:1313/manual/overview/">Manual</a></li>
    <li class="active"><b>Attribute</b></li>
      <ul style="list-style: none; padding-left: 15px;">
        <li><a href="http://localhost:1313/manual/attributes/builder/">Building</a></li>
        <li><a href="http://localhost:1313/manual/attributes/types/">Types</a></li>
      </ul>
    <li><a href="http://localhost:1313/manual/database-setup/">Database setup</a></li>
    <li><a href="http://localhost:1313/manual/modelling/">Modelling</a></li>
    <li><a href="http://localhost:1313/manual/schema/">Schema</a></li>
      <ul style="list-style: none; padding-left: 15px;">
        <li><a href="http://localhost:1313/manual/schema/schema-definition/">Schema definition</a></li>
      </ul>
    <li><a href="http://localhost:1313/manual/populate-database/">Populate database</a></li>
  </ul>
</div>

<div class="col-sm-10 column" style="padding:0;">
	

<h1 id="basics:199f4b06fef5a61f833f209ac24fd4c2">Basics</h1>

<p>Molecule is a domain-tailored abstraction layer on top of the Datomic database. It can therefore be good to first know a little about Datomic in order to understand Molecule.</p>

<h3 id="facts-datoms:199f4b06fef5a61f833f209ac24fd4c2">Facts/Datoms</h3>

<p>The core unit of data in Datomic is a fact or a &ldquo;<em>datom</em>&rdquo; that consists of 4 elements:</p>

<pre><code> John     likes    pizza      12:35:54
   |        |        |           |
Entity  Attribute  Value  Transaction/time
</code></pre>

<p>The fact that John likes pizza at a certain time is modelled as a datom in Datomic.</p>

<p><em>likes</em> is an <code>attribute</code> with <code>value</code> <em>pizza</em>. It is <strong>asserted</strong> that the <code>entity</code> <em>johnId</em> likes pizza at <code>transaction</code> time 12:35:54 (a timestamp is automatically set with all transactions).</p>

<h3 id="datomic-attributes:199f4b06fef5a61f833f209ac24fd4c2">Datomic Attributes</h3>

<p>Attributes are often (but not necessarily!) prefixed with a Namespace in Datomic. The <code>likes</code> Attribute could for instance have been prefixed with a <code>Person</code> Namespace so that we can refer to it as <code>:person/likes</code>.</p>

<p>Namespaces are simply used to prefix Attributes with a meaningful common characteristic of your domain which can also help prevent Attribute name clashes.</p>

<h3 id="molecule-attributes:199f4b06fef5a61f833f209ac24fd4c2">Molecule Attributes</h3>

<p>With Molecule we model Namespaces with uppercase words and Attributes with lower-case words. We can model the above fact like this:</p>

<pre><code class="language-scala">Person.name(&quot;John&quot;).likes(&quot;pizza&quot;)
</code></pre>

<p>This is like a &ldquo;molecular data structure&rdquo; of Attributes with some values that we are interested in. In this case Entities with two Attributes having certain values. We can imagine that we &ldquo;project&rdquo; a data template onto the graph of data that we operate on to see if there&rsquo;s some &ldquo;matches&rdquo;.</p>

<h3 id="entities:199f4b06fef5a61f833f209ac24fd4c2">Entities</h3>

<p>An Entity is basically an id number that is created when we assert one or more facts in a transaction. An Entity is comprised by the Attributes associated with it. Or we could say that an Entity is a bunch of associations to Attribute values - or <em>Datoms</em> in the words of Datomic.</p>

<p>Those Attributes could come from multiple Namespaces which make Entities free and not bound to any Namespace.</p>

<h3 id="inserting-data:199f4b06fef5a61f833f209ac24fd4c2">Inserting data</h3>

<p>We can create a new Entity with two Attributes and return the created id:</p>

<pre><code class="language-scala">val johnId = Person.name(&quot;John&quot;).likes(&quot;pizza&quot;).insert.id
</code></pre>

<p>There&rsquo;s now an entity with two Attributes associated with it and together we can think of this entity as representing John. A transaction time is automatically set with each transaction by Datomic.</p>

<h3 id="querying-data:199f4b06fef5a61f833f209ac24fd4c2">Querying data</h3>

<h3 id="manipulating-data:199f4b06fef5a61f833f209ac24fd4c2">Manipulating data</h3>

<p>If John at a later point likes something else than pizza we can assert a new fact that will then get a later timestamp of this transaction:</p>

<pre><code class="language-scala">Person(johnId).likes(&quot;pizza&quot;).update
</code></pre>

<p>. You can see it as a &ldquo;template&rdquo; for d</p>

<p>As you see we can apply values to an Attribute to insert and update</p>

<p>Attributes are composed to form &ldquo;molecules&rdquo; that describe unique and flexible data structures in unique combinations suiting your domain. Those are then translated to Datalog queries being executed against the underlying Datomic database.</p>

<p>An attribute in Datomic is part of <em>fact</em> or <em>Datom</em> consisting of four elements:</p>

<p><em>likes</em> is an <code>attribute</code> with <code>value</code> <em>pizza</em>. It is <strong>asserted</strong> that the <code>entity</code> <em>johnId</em> likes) pizza at <code>transaction</code> time 12:35:54. A timestamp is automatically set with all transactions. But if we need &ldquo;domain time&rdquo; we could add such attribute to the transaction as well, since this is simply a saved data structure in Datomic as our domain data.</p>

<h3 id="immutable-data:199f4b06fef5a61f833f209ac24fd4c2">Immutable data</h3>

<p>Everytime a fact is asserted the old value of the attribute is <em>not deleted</em>. A Datomic database is immutable. We can go back in time and see the values of an attribute <em>at any point in time</em>. We could for instance see all our previous addresses if this was part of our domain model.</p>

<p>Also when we delete data, it&rsquo;s actually not deleted, but &ldquo;retracted&rdquo;. Retracted data doesn&rsquo;t show up when we are querying the current database. But if we look at the database at an earlier point in time we can see the data before it got retracted.</p>

<h3 id="namespaces-and-attributes:199f4b06fef5a61f833f209ac24fd4c2">Namespaces and attributes</h3>

<p><code>attributes</code> are organized in <code>namespaces</code> to group related qualities of our domain:</p>

<p><img src="/img/DatomicElements1.png" alt="" />
</p>

<h3 id="entity-row-in-an-sql-table:199f4b06fef5a61f833f209ac24fd4c2">Entity != row in an sql Table</h3>

<p>An <code>entity</code> can have <em>any</em> <code>attribute</code> from <em>any</em> <code>namespace</code> associated to it:</p>

<p><img src="/img/DatomicElements2.png" alt="" />
</p>

<p>An entity is therefore not like a row in a table but rather a &ldquo;cross-cutting&rdquo; thing that we can freely associate any attribute value to. Note how &ldquo;attrB1&rdquo; in this example is not associated to entity1.</p>

<h3 id="further-reading:199f4b06fef5a61f833f209ac24fd4c2">Further reading&hellip;</h3>

<p>Go straight to the <a href="https://github.com/scalamolecule/wiki/Molecule-Seattle-tutorial">Molecule Seattle tutorial</a> to see a wide range of
 queries that Molecule can express, or check out first how we use Molecule to
 <a href="https://github.com/scalamolecule/wiki/Setup-a-Datomic-database">setup the database</a> and <a href="https://github.com/scalamolecule/wiki/Populate-the-database">populated it with data</a>.</p>

<p>From a Schema that we define, Molecule will create the necessary boilerplate code so that we can build unique strings of &ldquo;molecular data structures&rdquo; like for instance names and ages of Persons:</p>

<pre><code class="language-scala">val persons = Person.name.age.get
</code></pre>

<p>The fundamental building blocks are Namespaces like <code>Person</code> and Attributes like <code>name</code> and <code>age</code>. Attributes are not dependent of or a sub-unit of Namespaces like Columns are to Tables in the SQL world. Namespaces are rather a way of organizing Attributes to avoid name clashes.</p>

<p>. We could for instance build a</p>

<h3 id="building-molecules:199f4b06fef5a61f833f209ac24fd4c2">Building molecules</h3>

<p>A molecule starts with a Namespace and builds on with attributes and/or other Namespaces/Attributes to form a desired data structure to work with. We could for instance have some attributes that relates to how we model a Person and organize those attributes in a <code>Person</code> namespace:</p>

<pre><code class="language-scala">trait Person {
  val name = oneString
  val age  = oneInt
}
</code></pre>

<p>We can then use the Attributes <code>name</code> and <code>age</code> to build a molecule that will query for names and ages of person in the database:</p>

<pre><code class="language-scala">val persons = Person.name.age.get
</code></pre>

<p>a <code>Person</code> namespace</p>

<p>Attributes are organized in Namespaces that are more organizational than operational as tables are in the SQL world. Namespaces are more a way of organizing attributes that have something in common according to your domain.</p>

<h3 id="safe:199f4b06fef5a61f833f209ac24fd4c2">Safe</h3>

<p>Our query asks for entities having values defined for all three attributes. If some entity doesn&rsquo;t have the <code>street</code> attribute set it won&rsquo;t be returned. So we can safely assume that our result set contains no null values and we therefore return the raw values (without using Optional for instance).</p>

</div>     
  </div> 
</div> 



<script type="text/javascript" src="/js/jquery-1.11.2.min.js"></script>



<script type="text/javascript" src="/js/bootstrap.min.js"></script>



<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript" src="/js/scripts.js"></script>




<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2787756-3', 'auto');
  ga('send', 'pageview');

</script>
    
<script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>