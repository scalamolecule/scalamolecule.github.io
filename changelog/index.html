<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
    <link href='http://fonts.googleapis.com/css?family=Merriweather+Sans:400,300,300italic,400italic,700,700italic,800,800italic'
          rel='stylesheet' type='text/css'>
    <title>Changelog</title>
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/highlight/styles/solarized_light.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" href="/vendor/font-awesome/css/font-awesome.min.css">
    <link href="/css/style.css" rel="stylesheet">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/img/apple-touch-icon-57-precomposed.png">
    <link href="" rel="alternate" type="application/rss+xml" title="Molecule"/>
</head>
<body>


<header class="bs-docs-header">
    <div class="container">
        <div class="col-md-12 column" style="padding-left:0px; padding-right:0px; margin-bottom:15px">
            <div class="col-md-10 column" style="padding-left:0px;height:50px;">

    <ul class="nav nav-pills">
        <li><a href="/" style="padding-left: 6px; padding-right: 13px; vertical-align: top; margin-top: 2px;"><img
                src="/img/logo/MoleculeLogo600.png" alt="" width="200"></a></li>
        
        
        
        <li class="dropdown ">
            <a data-toggle="dropdown" href="/compare/" target="_top"
               onclick="javascript:top.location = '\/compare\/';return true;">Compare</a>
            
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                
                
                
                

                
                <li><a href="/compare/datomic/">Datomic</a></li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/compare/sql/">SQL</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/compare/sql/slick/">Slick</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li><a href="/compare/gremlin/">Gremlin</a></li>
                

                
                
            </ul>
            
        </li>
        
        
        <li class="dropdown ">
            <a data-toggle="dropdown" href="/resources/" target="_top"
               onclick="javascript:top.location = '\/resources\/';return true;">Resources</a>
            
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                
                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/resources/tutorials/">Tutorials</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/resources/tutorials/seattle/">Seattle</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/resources/videos/">Videos</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/resources/videos/2017-04-25_Marc_Grue/">Molecule presentation</a></li>
                        
                    </ul>
                </li>
                

                
                
            </ul>
            
        </li>
        
        
        <li class="dropdown ">
            <a data-toggle="dropdown" href="/manual/" target="_top"
               onclick="javascript:top.location = '\/manual\/';return true;">Manual</a>
            
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                
                

                
                <li class="dropdown-submenu">
                    <a href="/manual/">Quick start</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/manual/quick-start/introduction/">Introduction</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li><a href="/manual/setup/">Setup</a></li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/manual/schema/">Schema</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/manual/schema/transaction/">Transaction</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/manual/attributes/">Attributes</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/manual/attributes/basics/">Building molecules</a></li>
                        
                        <li><a href="/manual/attributes/modes/">Mandatory/Tacit/Optional</a></li>
                        
                        <li><a href="/manual/attributes/mapped/">Map attributes</a></li>
                        
                        <li><a href="/manual/attributes/expressions/">Expressions</a></li>
                        
                        <li><a href="/manual/attributes/aggregates/">Aggregates</a></li>
                        
                        <li><a href="/manual/attributes/parameterized/">Parameterized</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li><a href="/manual/entities/">Entities</a></li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/manual/relationships/">Relationships</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/manual/relationships/card-one/">Cardinality one</a></li>
                        
                        <li><a href="/manual/relationships/card-many/">Cardinality many</a></li>
                        
                        <li><a href="/manual/relationships/composites/">Composites</a></li>
                        
                        <li><a href="/manual/relationships/bidirectional/">Bidirectional</a></li>
                        
                        <li><a href="/manual/relationships/self-join/">Self-join</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/manual/crud/">&#34;CRUD&#34;</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/manual/crud/save/">Save</a></li>
                        
                        <li><a href="/manual/crud/insert/">Insert</a></li>
                        
                        <li><a href="/manual/crud/get/">Get</a></li>
                        
                        <li><a href="/manual/crud/getJson/">Get Json</a></li>
                        
                        <li><a href="/manual/crud/update/">Update</a></li>
                        
                        <li><a href="/manual/crud/retract/">Retract</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/manual/transactions/">Transactions</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/manual/transactions/tx-bundle/">Tx bundle</a></li>
                        
                        <li><a href="/manual/transactions/tx-functions/">Tx functions</a></li>
                        
                        <li><a href="/manual/transactions/tx-meta-data/">Tx meta data</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/manual/time/">Time</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/manual/time/asof-since/">AsOf/Since</a></li>
                        
                        <li><a href="/manual/time/history/">History</a></li>
                        
                        <li><a href="/manual/time/with/">With</a></li>
                        
                        <li><a href="/manual/time/testing/">Testing</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/manual/generic/">Generic</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/manual/generic/datom/">Datom</a></li>
                        
                        <li><a href="/manual/generic/indexes/">Index</a></li>
                        
                        <li><a href="/manual/generic/log/">Log</a></li>
                        
                        <li><a href="/manual/generic/schema/">Schema</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/manual/debug/">Debug</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/manual/debug/datalog/">Datalog/data</a></li>
                        
                        <li><a href="/manual/debug/debug-transactions/">Transactions</a></li>
                        
                        <li><a href="/manual/debug/err/">Errors</a></li>
                        
                    </ul>
                </li>
                

                
                
            </ul>
            
        </li>
        
        
        <li class="dropdown ">
            <a data-toggle="dropdown" href="/api/molecule" target="_top"
               onclick="javascript:top.location = '\/api\/molecule';return true;">Docs</a>
            
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/api">api</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/api/Entity.html">Entity</a></li>
                        
                        <li><a href="/api/molecule/api/EntityOps.html">EntityOps</a></li>
                        
                        <li><a href="/api/molecule/api/Molecule.html">Molecule</a></li>
                        
                        <li><a href="/api/molecule/api/OptionalMapOps.html">OptionalMapOps</a></li>
                        
                        <li><a href="/api/molecule/api/ShowDebug.html">ShowDebug</a></li>
                        
                        <li><a href="/api/molecule/api/TxMethods.html">TxMethods</a></li>
                        
                        <li><a href="/api/molecule/api/exception">exception</a></li>
                        
                        <li><a href="/api/molecule/api/get">get</a></li>
                        
                        <li><a href="/api/molecule/api/getAsync">getAsync</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/composition">composition</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/composition/Composite.html">Composite</a></li>
                        
                        <li><a href="/api/molecule/composition/CompositeInit.html">CompositeInit</a></li>
                        
                        <li><a href="/api/molecule/composition/CompositeInit_In_1.html">CompositeInit_In_1</a></li>
                        
                        <li><a href="/api/molecule/composition/CompositeInit_In_2.html">CompositeInit_In_2</a></li>
                        
                        <li><a href="/api/molecule/composition/CompositeInit_In_3.html">CompositeInit_In_3</a></li>
                        
                        <li><a href="/api/molecule/composition/Composite_In_1.html">Composite_In_1</a></li>
                        
                        <li><a href="/api/molecule/composition/Composite_In_2.html">Composite_In_2</a></li>
                        
                        <li><a href="/api/molecule/composition/Composite_In_3.html">Composite_In_3</a></li>
                        
                        <li><a href="/api/molecule/composition/Nested.html">Nested</a></li>
                        
                        <li><a href="/api/molecule/composition/Nested_In_1.html">Nested_In_1</a></li>
                        
                        <li><a href="/api/molecule/composition/Nested_In_2.html">Nested_In_2</a></li>
                        
                        <li><a href="/api/molecule/composition/Nested_In_3.html">Nested_In_3</a></li>
                        
                        <li><a href="/api/molecule/composition/Tx.html">Tx</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/exceptions">exceptions</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/exceptions/package$$MoleculeCompileException.html">MoleculeCompileException</a></li>
                        
                        <li><a href="/api/molecule/exceptions/package$$MoleculeException.html">MoleculeException</a></li>
                        
                        <li><a href="/api/molecule/exceptions/package$$QueryException.html">QueryException</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/expression">expression</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/expression/AggregateKeywords.html">AggregateKeywords</a></li>
                        
                        <li><a href="/api/molecule/expression/LogicImplicits.html">AttrExpressions</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/facade">facade</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/facade/Conn.html">Conn</a></li>
                        
                        <li><a href="/api/molecule/facade/Datomic.html">Datomic</a></li>
                        
                        <li><a href="/api/molecule/facade/TxReport.html">TxReport</a></li>
                        
                        <li><a href="/api/molecule/facade/exception">exception</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/factory">factory</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/factory/Composite_Factory2.html">Composite_Factory2</a></li>
                        
                        <li><a href="/api/molecule/factory/Composite_In_1_Factory2.html">Composite_In_1_Factory2</a></li>
                        
                        <li><a href="/api/molecule/factory/Composite_In_2_Factory2.html">Composite_In_2_Factory2</a></li>
                        
                        <li><a href="/api/molecule/factory/Composite_In_3_Factory2.html">Composite_In_3_Factory2</a></li>
                        
                        <li><a href="/api/molecule/factory/Molecule_Factory2.html">Molecule_Factory2</a></li>
                        
                        <li><a href="/api/molecule/factory/Molecule_In_1_Factory2.html">Molecule_In_1_Factory2</a></li>
                        
                        <li><a href="/api/molecule/factory/Molecule_In_2_Factory2.html">Molecule_In_2_Factory2</a></li>
                        
                        <li><a href="/api/molecule/factory/Molecule_In_3_Factory2.html">Molecule_In_3_Factory2</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/generic">generic</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/generic/datom/index.html">Datom</a></li>
                        
                        <li><a href="/api/molecule/generic/index/index.html">Index</a></li>
                        
                        <li><a href="/api/molecule/generic/Log.html">Log</a></li>
                        
                        <li><a href="/api/molecule/generic/schema/index.html">Schema</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/input">input</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/input/InputMolecule.html">InputMolecule</a></li>
                        
                        <li><a href="/api/molecule/input/InputMolecule_1.html">InputMolecule_1</a></li>
                        
                        <li><a href="/api/molecule/input/InputMolecule_2.html">InputMolecule_2</a></li>
                        
                        <li><a href="/api/molecule/input/InputMolecule_3.html">InputMolecule_3</a></li>
                        
                        <li><a href="/api/molecule/input/exception">exception</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/macros">macros</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/macros/TxFns.html">TxFns</a></li>
                        
                    </ul>
                </li>
                

                
                
                

                
                <li class="dropdown-submenu">
                    <a href="/api/molecule/schema">schema</a>
                    <ul class="dropdown-menu">
                        
                        <li><a href="/api/molecule/schema/SchemaTransaction.html">SchemaTransaction</a></li>
                        
                        <li><a href="/api/molecule/schema/definition$.html">definition</a></li>
                        
                    </ul>
                </li>
                

                
                
            </ul>
            
        </li>
        
        
        <li class="dropdown ">
            <a data-toggle="dropdown" href="/dev/" target="_top"
               onclick="javascript:top.location = '\/dev\/';return true;">Dev</a>
            
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                
                

                
                <li><a href="/dev/">Developer</a></li>
                

                
                
                

                
                <li><a href="/dev/boilerplate/">Boilerplate</a></li>
                

                
                
                

                
                <li><a href="/dev/transformation/">Transformation</a></li>
                

                
                
            </ul>
            
        </li>
        
        
        <li class="dropdown ">
            <a data-toggle="dropdown" href="/community/" target="_top"
               onclick="javascript:top.location = '\/community\/';return true;">Community</a>
            
            <ul class="dropdown-menu level1" role="menu" aria-labelledby="dropdownMenu">
                
                
                
                

                
                <li><a href="https://gitter.im/scalamolecule/Lobby">Gitter</a></li>
                

                
                
                

                
                <li><a href="https://groups.google.com/forum/#!forum/molecule-dsl">Forum</a></li>
                

                
                
                

                
                <li><a href="https://github.com/scalamolecule/molecule">Github</a></li>
                

                
                
                

                
                <li><a href="https://github.com/scalamolecule/molecule/issues">Molecule issues</a></li>
                

                
                
                

                
                <li><a href="https://github.com/scalamolecule/molecule-web/issues">Molecule docs issues</a></li>
                

                
                
            </ul>
            
        </li>
        
        <li>
            
        </li>
    </ul>

</div>

            <div class="col-md-2 column" style="padding-top:20px;padding-right:0px;">
                <ul class="nav nav-pills" style="float:right;">
                    <li>
                        <a href="/changelog" style="margin-top:-2px;">v0.17.2</a>
                    </li>
                    <li>
                        <div style="padding-left:14px;">
                            <a href="https://github.com/scalamolecule/molecule" class="github-button"
                               data-icon="octicon">Github</a>
                        </div>
                    </li>
                </ul>
            </div>

        </div>

    </div>
</header>

<div class="wrapper">
    
     

<div class="container" style="padding-top:20px">

    <div class="col-sm-10 column" style="padding-left:8px;">
        

<h1 id="top">Molecule changelog</h1>

<p><a href="https://github.com/scalamolecule/molecule/releases">Github releases</a></p>

<p>Main changes:</p>

<ul>
<li>2019-01-15 v0.17.0 <a href="#22">Datoms, Indexes, Log, Schema and debugging</a></li>
<li>2018-12-02 v0.16.1 <a href="#21">Sbt-molecule 0.7.0, bootstrap speed optimization</a></li>
<li>2018-11-25 v0.16.0 <a href="#20">Async API + tx functions</a></li>
<li>2018-10-25 v0.15.0 <a href="#19">10x-100x Compilation speed boost</a></li>
<li>2018-09-06 v0.14.0 <a href="#18">Scala docs and semantic updates</a></li>
<li>2017-11-13 v0.13.0 <a href="#17">Native Json output</a></li>
<li>2017-05-28 v0.12.0 <a href="#16">Optional values in save-molecules</a></li>
<li>2017-05-19 v0.11.0 <a href="#15">Time API</a></li>
<li>2016-10-19 v0.10.0 <a href="#14">Entity selection retrieval and manipulation</a></li>
<li>2016-07-24 v0.9.0 <a href="#13">Bidirectional references</a></li>
<li>2016-06-13 v0.8.0 <a href="#12">Composites &amp; Tx meta data</a></li>
<li>2016-06-04 v0.7.0 <a href="#11">sbt-molecule plugin code generation</a></li>
<li>2016-05-30 v0.6.2 <a href="#10">Various improvements and bug fixes</a></li>
<li>2016-04-25 v0.6.1 <a href="#9">Keyed attribute maps</a></li>
<li>2015-12-14 v0.5.0 <a href="#8">Map Attributes - Multilingual support</a></li>
<li>2015-11-14 v0.4.3 <a href="#7">Nested adjacent references</a></li>
<li>2015-11-13 v0.4.2 <a href="#6">Back references in nested inserts/gets</a></li>
<li>2015-10-28 v0.4.1 <a href="#5">Differentiating between optional values in insert/get</a></li>
<li>2015-10-25 v0.4.0 <a href="#4">Optional values (like Null)</a></li>
<li>2015-10-04 v0.3.0 <a href="#3">Nested data structures</a></li>
<li>2014-12-25 v0.2.0 <a href="#2">Implemented Day-Of-Datomic and MBrainz</a></li>
<li>2014-07-02 v0.1.0 <a href="#1">Initial commit - Seattle tutorial</a></li>
</ul>

<h2 id="22"><a href="#top">☝︎</a> Datoms, Indexes, Log, Schema and debugging</h2>

<p><em>2019-01-15 v0.17.0</em></p>

<p>7 Generic APIs introduced/streamlined to access data and schema generically. Some examples:</p>

<h4 id="datoms">Datoms</h4>

<p>Entity id of Ben with generic datom attribute <code>e</code> on a custom molecule&hellip;</p>

<pre><code class="language-scala">Person.e.name.get.head === (benEntityId, &quot;Ben&quot;)
</code></pre>

<h4 id="eavt-index">EAVT index</h4>

<p>Attributes/values of entity id <code>e1</code>&hellip;</p>

<pre><code class="language-scala">EAVT(e1).e.a.v.t.get === List(
  (e1, &quot;:person/name&quot;, &quot;Ben&quot;, t1),
  (e1, &quot;:person/age&quot;, 42, t2),
  (e1, &quot;:golf/score&quot;, 5.7, t2)
)
</code></pre>

<h4 id="avet-index">AVET index</h4>

<p>Values and entity associations for attribute <code>:person/age</code>&hellip;</p>

<pre><code class="language-scala">AVET(&quot;:person/age&quot;).v.e.t.get === List(
  (42, e1, t2),
  (37, e2, t5),
  (14, e3, t7)
)
</code></pre>

<p>Datomic&rsquo;s <a href="http://docs.datomic.com/on-prem/javadoc/datomic/Database.html#indexRange(java.lang.Object,%20java.lang.Object,%20java.lang.Object)">indexRange API</a>
is also implemented&hellip;</p>

<pre><code class="language-scala">// Entities and transactions of age attribute with values between 14 and 37
AVET.range(&quot;:person/age&quot;, Some(14), Some(37)).v.e.t.get === List(
  (14, e4, t7) // 14 is included in value range
)
</code></pre>

<h4 id="aevt-index">AEVT index</h4>

<p>Entity ids, values and transaction t&rsquo;s of attribute <code>:person/name</code>:</p>

<pre><code class="language-scala">AEVT(&quot;:person/name&quot;).e.v.t.get === List(
  (e1, &quot;Ben&quot;, t2),
  (e2, &quot;Liz&quot;, t5)
)
</code></pre>

<h4 id="vaet-index">VAET index</h4>

<p>Reverse index for ref attributes&hellip;</p>

<pre><code class="language-scala">// Say we have 3 entities pointing to one entity:
Release.e.name.Artists.e.name.get === List(
  (r1, &quot;Abbey Road&quot;, a1, &quot;The Beatles&quot;),
  (r2, &quot;Magical Mystery Tour&quot;, a1, &quot;The Beatles&quot;),
  (r3, &quot;Let it be&quot;, a1, &quot;The Beatles&quot;),
)

// .. then we can get the reverse relationships with the VAET Index:
VAET(a1).v.a.e.get === List(
  (a1, &quot;:release/artists&quot;, r1),
  (a1, &quot;:release/artists&quot;, r2),
  (a1, &quot;:release/artists&quot;, r3)
)
</code></pre>

<h4 id="log-index">Log index</h4>

<p>Access to datoms index sorted by transaction/time:</p>

<pre><code class="language-scala">// Data from transaction t1 (inclusive) until t4 (exclusive)
Log(Some(t1), Some(t4)).t.e.a.v.op.get === List(
  (t1, e1, &quot;:person/name&quot;, &quot;Ben&quot;, true),
  (t1, e1, &quot;:person/age&quot;, 41, true),

  (t2, e2, &quot;:person/name&quot;, &quot;Liz&quot;, true),
  (t2, e2, &quot;:person/age&quot;, 37, true),

  (t3, e1, &quot;:person/age&quot;, 41, false),
  (t3, e1, &quot;:person/age&quot;, 42, true)
)
</code></pre>

<h4 id="schema">Schema</h4>

<p>Programatically explore your <code>Schema</code> structure&hellip;</p>

<pre><code class="language-scala">// Datomic type and cardinality of attributes
Schema.a.tpe.card.get === List (
  (&quot;:sales_customer/name&quot;, &quot;string&quot;, &quot;one&quot;),
  (&quot;:accounting_invoice/invoiceLine&quot;, &quot;ref&quot;, &quot;many&quot;),
)
</code></pre>

<h3 id="debugging">Debugging</h3>

<p>Various debugging methods to explore molecule queries and transactional commands.</p>

<h2 id="21"><a href="#top">☝︎</a> Sbt-molecule plugin compilation speed optimizations</h2>

<p><em>2018-11-25 v0.16.1</em></p>

<p>Minor upgrade to match <a href="https://github.com/scalamolecule/sbt-molecule">sbt-molecule</a> plugin v0.7.0.</p>

<p>When compiling a molecule project with <code>sbt compile</code>, compilation of boilerplate
code is now 4-5x faster than with v0.6.2. Using lazy vals for attributes and
methods for reference namespaces did the trick.</p>

<p>Since attributes are now defined as lazy vals in boilerplate code, we can no longer
override some super/base structure where we earlier saved the doc comments. Alternatively
we could add doc comments to all arities of boilerplate attributes. But that would be
a lot of redundancy. Combined with the massive compilation speed improvement doc comments
are therefore skipped.</p>

<h2 id="20"><a href="#top">☝︎</a> Async API + tx functions</h2>

<p><em>2018-11-25 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.16.0">v0.16.0</a></em></p>

<h3 id="sync-asyncapis">Sync/AsyncAPIs</h3>

<p>All getter methods now have an asynchronous equivalent method that returns a Scala Future with the data:</p>

<ul>
<li><code>get</code> / <code>getAsync</code> - Default List of typed tuples for convenient access to smaller data sets.</li>
<li><code>getArray</code> / <code>getAsyncArray</code> - Array of typed tuples for fast retrieval and traversing of large data sets.</li>
<li><code>getIterable</code> / <code>getAsyncIterable</code> - Iterable of typed tuples for lazy evaluation of data</li>
<li><code>getJson</code> / <code>getAsyncJson</code> - Json formatted result data</li>
<li><code>getRaw</code> / <code>getAsyncRaw</code> - Raw untyped data from Datomic</li>
</ul>

<p>All transactional operations on molecules now similarly have async implementations returning a Future with
a <code>TxReport</code> containing data about the transaction.</p>

<ul>
<li><code>save</code> / <code>saveAsync</code></li>
<li><code>insert</code> / <code>insertAsync</code></li>
<li><code>update</code> / <code>updateAsync</code></li>
<li><code>retract</code> / <code>retractAsync</code></li>
</ul>

<h3 id="tx-functions">Tx functions</h3>

<p>Molecule now implements typed transaction functions.</p>

<p>Within the tx function you have access to the transaction database value so that you can ensure any
synchronization constraints before returning the resulting tx statements to be transacted. To abort
the whole transaction if a constraint is not met, simply throw an exception. Either all tx statements
will transact successfully or none will thereby ensuring atomicity of the transaction.</p>

<p>Any complexity of logic can be performed within a tx function as long as no side effects are produced
(like trying to update the database within the tx method body).</p>

<h3 id="tx-function-definitions">Tx function definitions</h3>

<p>Tx functions in Datomic are untyped (takes arguments of type <code>Object</code>). But Molecule allows you to
define typed tx methods inside a <code>@TxFns</code>-annotated object that will automatically create equivalent &ldquo;twin&rdquo;
functions with the shape that Datomic expects and save them in the Datamic database transparently for you.</p>

<pre><code class="language-scala">@TxFns
object myTxFns {
  // Constraint check before multiple updates
  def transfer(from: Long, to: Long, amount: Int)(implicit conn: Conn): Seq[Seq[Statement]] = {
    // Validate sufficient funds in from-account
    val curFromBalance = Ns(from).int.get.headOption.getOrElse(0)
    
    if (curFromBalance &lt; amount)
      // Throw exception to abort the whole transaction
      throw new TxFnException(s&quot;Can't transfer $amount from account $from having a balance of only $curFromBalance.&quot;)

    // Calculate new balances
    val newFromBalance = curFromBalance - amount
    val newToBalance = Ns(to).int.get.headOption.getOrElse(0) + amount

    // Update accounts
    Ns(from).int(newFromBalance).getUpdateTx ++ Ns(to).int(newToBalance).getUpdateTx
  }
}
</code></pre>

<p>Tx function are invoked in application code with the <code>transact</code> or <code>transactAsync</code> method:</p>

<pre><code class="language-scala">transact(transfer(fromAccount, toAccount, 20))
</code></pre>

<p><code>transact</code> (or <code>transactAsync</code>) is a macro that analyzes the tx function signature to be able to
invoke its generated twin method within Datomic.</p>

<h3 id="bundled-transactions">Bundled transactions</h3>

<p>If the transactional logic is not dependent on access to the transaction database value,
multiple &ldquo;bundled&rdquo; tx statements can now be created by adding molecule tx statements to
one of the bundling <code>transact</code> or <code>transactAsync</code> methods:</p>

<pre><code class="language-scala">transact(
  // retract
  e1.getRetractTx,
  // save
  Ns.int(4).getSaveTx,
  // insert
  Ns.int.getInsertTx(List(5, 6)),
  // update
  Ns(e2).int(20).getUpdateTx
)
</code></pre>

<p>Tx statement getters for the molecule operations are used to get the tx statements to be transacted
in one transaction. As with tx functions, only all tx statements will atomically transact or none will
if there is some transactional error.</p>

<h3 id="composite-syntax">Composite syntax</h3>

<p>Composite molecules are now tied together with <code>+</code> instead of <code>~</code>.</p>

<pre><code class="language-scala">m(Ref2.int2 + Ns.int).get.sorted === Seq(
  (1, 11),
  (2, 22)
)
</code></pre>

<p>This change was made to avoid collision with the upcoming splice operator <code>~</code> in the next
major version of Scala/Dotty (see <a href="https://www.scala-lang.org/blog/2018/04/30/in-a-nutshell.html">MACROS: THE PLAN FOR SCALA 3</a>)</p>

<p>Composite inserts previously had its own special insert method but now shares syntax
with other inserts</p>

<pre><code class="language-scala">val List(e1, e2) = Ref2.int2 + Ns.int insert Seq(
  // Two rows of data
  (1, 11),
  (2, 22)
) eids
</code></pre>

<h2 id="19"><a href="#top">☝︎</a> 10x-100x Compilation speed boost!</h2>

<p><em>2018-10-25 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.15.0">v0.15.0</a></em></p>

<p>The core macro transformation engine has been re-written from the ground up and
<a href="http://www.lihaoyi.com/post/MicrooptimizingyourScalacode.html#bit-packing">micro-optimizations</a>
applied wherever possible. This has resulted in dramatic compilation speed improvements, some several orders of magnitude!</p>

<p>Macro materialization of molecules earlier produced a lot of code that has now been moved out to static methods. An absolute
minimal amount of code is now generated minimizing the job of the macros and the compiler. As an example, the
<a href="https://github.com/scalamolecule/molecule/blob/master/examples/src/test/scala/molecule/examples/seattle/SeattleTests.scala">Seattle tests</a>
file sometimes took up to 70 seconds to compile and now average around 4 seconds. Some long molecules with close to 22
attributes almost never finished compiling but now take about 2 seconds to compile! This is good news since users of
Molecule can therefore now freely create as large molecules as they please without any speed penalty.</p>

<h3 id="5-optimized-getter-groups">5 optimized getter groups</h3>

<p>Type casting of returned data from Datomic was earlier not completely optimized. Taking advice from
<a href="http://www.lihaoyi.com/post/BenchmarkingScalaCollections.html">Haoyi&rsquo;s &ldquo;Benchmarking Scala Collections&rdquo;</a>
Molecule now also returns super fast mutable pre-allocated Arrays of typed data for large data sets.</p>

<p>Json has also been thoroughly optimized to build as fast as possible directly from raw Datomic data.</p>

<p>So Molecule now offers 5 optimized <a href="http://www.scalamolecule.org/api/molecule/action/get/">getter groups</a>:</p>

<ul>
<li><code>get</code> - Default List of typed tuples for convenient access to smaller data sets.</li>
<li><code>getArray</code> - Array of typed tuples for fast retrieval and traversing of large data sets.</li>
<li><code>getIterable</code> - Iterable of typed tuples for lazy evaluation of data</li>
<li><code>getJson</code> - Json formatted result data</li>
<li><code>getRaw</code> - Raw untyped data from Datomic</li>
</ul>

<p>Each getter group comes with all time-related variations:</p>

<ul>
<li><code>get</code></li>
<li><code>getAsOf(t)</code></li>
<li><code>getSince(t)</code></li>
<li><code>getWith(txData)</code></li>
<li><code>getHistory</code> (only implemented for List getter)</li>
</ul>

<h2 id="18"><a href="#top">☝︎</a> Scala docs and semantic updates</h2>

<p><em>2018-09-06 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.14.0">v0.14.0</a></em></p>

<p>Major overhaul of Molecule:</p>

<h3 id="thorough-scala-docs-api-documentation">Thorough Scala docs API documentation</h3>

<p>All relevant public interfaces have been documented in the new <a href="http://www.scalamolecule.org/api/molecule">Scala docs</a>.
Shortcuts to Scala docs sub packages and documents are also directly available via &ldquo;API docs&rdquo; in the menu on the
<a href="http://www.scalamolecule.org">Molecule website</a>.</p>

<p>To aid constructing molecules in your code, all attributes defined now also have Scala docs automatically defined
by the <a href="https://github.com/scalamolecule">sbt-molecule plugin</a> upon compilation.</p>

<h3 id="input-molecules-correctly-implemented">Input molecules correctly implemented</h3>

<p>Input molecules are now semantically correctly implemented and thoroughly tested
(<a href="https://github.com/scalamolecule/molecule/blob/master/coretests/src/test/scala/molecule/coretests/input1">1 input</a>,
<a href="https://github.com/scalamolecule/molecule/blob/master/coretests/src/test/scala/molecule/coretests/input2">2 inputs</a>,
<a href="https://github.com/scalamolecule/molecule/blob/master/coretests/src/test/scala/molecule/coretests/input3">3 inputs</a>).</p>

<h3 id="interfaces-updated-and-streamlined">Interfaces updated and streamlined</h3>

<p>The standard getters return Lists of tuples of type-casted tuples.</p>

<ul>
<li><code>get</code></li>
<li><code>getAsOf(t)</code></li>
<li><code>getSince(t)</code></li>
<li><code>getHistory</code></li>
<li><code>getWith(txData)</code></li>
</ul>

<p>If large data sets are expected, an Iterable of tuples of lazily type-cased tuples can be retrieved instead.
Data is type-casted on each call to <code>next</code> on the iterator.</p>

<ul>
<li><code>getIterable</code></li>
<li><code>getIterableAsOf(t)</code></li>
<li><code>getIterableSince(t)</code></li>
<li><code>getIterableHistory</code></li>
<li><code>getIterableWith(txData)</code></li>
</ul>

<p>If typed data is not required we can get the raw untyped java collections of Lists of objects.</p>

<ul>
<li><code>getRaw</code></li>
<li><code>getRawAsOf(t)</code></li>
<li><code>getRawSince(t)</code></li>
<li><code>getRawHistory</code></li>
<li><code>getRawWith(txData)</code></li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<p>The whole directory layout of the Molecule library has been re-arranged and optimized, including many interfaces.
So you might have to change some method names if you have used earlier versions of Molecule.</p>

<h2 id="17"><a href="#top">☝︎</a> Native Json output</h2>

<p><em>2017-11-13 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.13.0">v0.13.0</a></em></p>

<p>We can now get data in json format directly from the database by calling <code>getJson</code> on a molecule. So instead of converting
tuples of data to json with some 3rd party library we can call <code>getJson</code> and pass the json data string directly to an
Angular table for instance.</p>

<p>Internally, Molecule builds the json string in a StringBuffer directly from the raw data coming from Datomic
(with regards to types being quoted or not). This should make it the fastest way of supplying json data when needed.</p>

<h3 id="flat-data">Flat data</h3>

<p>Normal &ldquo;flat&rdquo; molecules creates json with a row on each line in the output:</p>

<pre><code class="language-scala">Person.name.age.getJson ===
  &quot;&quot;&quot;[
    |{&quot;name&quot;: &quot;Fred&quot;, &quot;age&quot;: 38},
    |{&quot;name&quot;: &quot;Lisa&quot;, &quot;age&quot;: 35}
    |]&quot;&quot;&quot;.stripMargin
</code></pre>

<h3 id="composite-data">Composite data</h3>

<p>Composite data has potential field name clashes so each sub part of the composite is rendered
as a separate json object tied together in an array for each row:</p>

<pre><code class="language-scala">m(Person.name.age ~ Category.name.importance).getJson ===
  &quot;&quot;&quot;[
    |[{&quot;name&quot;: &quot;Fred&quot;, &quot;age&quot;: 38}, {&quot;name&quot;: &quot;Marketing&quot;, &quot;importance&quot;: 6}],
    |[{&quot;name&quot;: &quot;Lisa&quot;, &quot;age&quot;: 35}, {&quot;name&quot;: &quot;Management&quot;, &quot;importance&quot;: 7}]
    |]&quot;&quot;&quot;.stripMargin
</code></pre>

<p>Note how a field <code>name</code> appears in each sub object. Since the molecule is defined in client code it is presumed that
the semantics of eventual duplicate field names are also handled by client code.</p>

<h3 id="nested-data">Nested data</h3>

<p>Nested date is rendered as a json array with json objects for each nested row:</p>

<pre><code class="language-scala">(Invoice.no.customer.InvoiceLines * InvoiceLine.item.qty.amount).getJson ===
  &quot;&quot;&quot;[
    |{&quot;no&quot;: 1, &quot;customer&quot;: &quot;Johnson&quot;, &quot;invoiceLines&quot;: [
    |   {&quot;item&quot;: &quot;apples&quot;, &quot;qty&quot;: 10, &quot;amount&quot;: 12.0},
    |   {&quot;item&quot;: &quot;oranges&quot;, &quot;qty&quot;: 7, &quot;amount&quot;: 3.5}]},
    |{&quot;no&quot;: 2, &quot;customer&quot;: &quot;Benson&quot;, &quot;invoiceLines&quot;: [
    |   {&quot;item&quot;: &quot;bananas&quot;, &quot;qty&quot;: 3, &quot;amount&quot;: 3.0},
    |   {&quot;item&quot;: &quot;oranges&quot;, &quot;qty&quot;: 1, &quot;amount&quot;: 0.5}]}
    |]&quot;&quot;&quot;.stripMargin
</code></pre>

<h2 id="16"><a href="#top">☝︎</a> Optional values in save-molecules</h2>

<p><em>2017-05-28 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.12.0">v0.12.0</a></em></p>

<p>Often, form submissions have some optional field values. Molecule now allow us to <code>save</code> molecules with both mandatory
and optional attributes.</p>

<p>We could for instance have <code>aName</code>,  <code>optionalLikes</code> and <code>anAge</code> values from a form submission that we want to save.
We can now apply those values directly to a mandatory <code>name</code> attribute, an optional <code>likes$</code> attribute (<code>$</code> appended
makes it optional) and a mandatory <code>age</code> attribute of a save-molecule and then save it:</p>

<pre><code class="language-scala">Person
  .name(aName)
  .likes$(optionalLikes)
  .age(anAge)
  .save
</code></pre>

<p>We can also, as before, <em>insert</em> the data using an &ldquo;insert-molecule&rdquo; as a template:</p>

<pre><code class="language-scala">Person.name.likes$.age.insert(
  aName, optionalLikes, anAge
)
</code></pre>

<p>It can be a matter of taste if you want to <code>save</code> or <code>insert</code> - but now you can choose :-)</p>

<h2 id="15"><a href="#top">☝︎</a> Time API</h2>

<p><em>2017-05-19 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.11.0">v0.11.0</a></em></p>

<p>Datomic has some extremely powerful time functionality that Molecule now makes available in an intuitive way:</p>

<h3 id="ad-hoc-time-queries">Ad-hoc time queries</h3>

<p>Ad-hoc time queries against our database can now be made with the following time-aware getter methods on a molecule:</p>

<pre><code class="language-scala">Person.name.age.getAsOf(t) === ... // Persons as of a point in time `t`

Person.name.age.getSince(t) === ... // Persons added after a point in time `t`

Person(fredId).age.getHistory === ... // Current and previous ages of Fred in the db
</code></pre>

<p><code>t</code> can be a transaction entity id (<code>Long</code>), a transaction number (<code>Long</code>) or a <code>java.util.Date</code>.</p>

<p>If we want to test the outcome of some transaction without affecting the production db we can apply transaction data to
the <code>getWith(txData)</code> method:</p>

<pre><code class="language-scala">Person.name.age.getWith(
  // Testing adding some transactional data to the current db
  Person.name(&quot;John&quot;).age(42).saveTx, // Save transaction data
  Person.name.age.insertTx(
    List((&quot;Lisa&quot;, 34), (&quot;Pete&quot;, 55)) // Insert transaction data
  ),
  Person(fredId).age(28).updateTx, // Update transaction data
  someEntityId.retractTx // Retraction transaction data
) === ... // Persons from db including transactions tested 
</code></pre>

<p>By adding the <code>Tx</code> suffix to the standard molecule commands (<code>save</code>, <code>insert</code>, <code>update</code> or <code>retract</code>)
we can get the transactional data that those operations would normally transact directly. Here, <code>&lt;command&gt;Tx</code> methods
on transaction molecules just return the transaction data so that we can apply it to the <code>getWith(txData)</code> method.
This make it convenient for us to ask speculative questions like &ldquo;what would I get if I did those transactions&rdquo;.</p>

<p>For more complex test scenarios we can now use a test database:</p>

<h3 id="test-db">Test db</h3>

<p>All molecules expect an implicit connection object to be in scope. If we then set a temporary test database on such <code>conn</code> object
we can subsequentially freely perform tests against this temporary database as though it was a &ldquo;branch&rdquo; (think git).</p>

<p>When the connection/db goes out of scope it is simply garbage collected automatically by the JVM. At any point we can also
explicitly go back to continuing using our live production db.</p>

<p>To make a few tests with our filtered db we can now do like this:</p>

<pre><code class="language-scala">// Current state
Person(fredId).name.age.get.head === (&quot;Fred&quot;, 27)

// Create &quot;branch&quot; of our production db as it is right now
conn.testDbAsOfNow  

// Perform multiple operations on test db
Person(fredId).name(&quot;Frederik&quot;).update
Person(fredId).age(28).update

// Verify expected outcome of operations
Person(fredId).name.age.get.head === (&quot;Frederik&quot;, 28)

// Then go back to production state
conn.useLiveDb

// Production state is unchanged!
Person(fredId).name.age.get.head === (&quot;Fred&quot;, 27)
</code></pre>

<h3 id="test-db-with-domain-classes">Test db with domain classes</h3>

<p>When molecules are used inside domain classes we want to test the domain operations also without affecting the state of our production database.
And also ideally without having to create mockups of our domain objects. This is now possible by setting a temporary test database on the implicit
connection object that all molecules expect to be present in their scope - which includes the molecules inside domain classes.</p>

<p>When we test against a temporary database, Molecule internally uses the <code>with</code> function of Datomic to apply transaction data to a &ldquo;branch&rdquo; of
the database that is simply garbage collected when it goes out of scope!</p>

<p>To make a few tests on a domain object that have molecule calls internally we can now do like this:</p>

<pre><code class="language-scala">// Some domain object that we want to test
val domainObj = MyDomainClass(params..) // having molecule transactions inside...
domainObj.myState === &quot;some state&quot;

// Create &quot;branch&quot; of our production db as it is right now
conn.testDbAsOfNow  

// Test some domain object operations
domainObj.doThis
domainObj.doThat

// Verify expected outcome of operations
domainObj.myState === &quot;some expected changed state&quot;

// Then go back to production state
conn.useLiveDb

// Production state is unchanged!
domainObj.myState == &quot;some state&quot;
</code></pre>

<p>Since internal domain methods will in turn call other domain methods that also expects an implicit conn object then the same test db is even
propragated recursively inside the chain of domain operations.</p>

<h3 id="multiple-time-views">Multiple time views</h3>

<p>We can apply the above approach with several time views of our database:</p>

<pre><code class="language-scala">conn.testDbAsOfNow
conn.testDbAsOf(t)
conn.testDbSince(t)
conn.testWith(txData)
</code></pre>

<p>This make it possible to run arbitrarily complex test scenarios directly against our production data at any point in time without having to do
any manual setup or tear-down of mock domain/database objects!</p>

<h2 id="14"><a href="#top">☝︎</a> Entity selection retrieval and manipulation</h2>

<p><em>2016-10-19 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.10.0">v0.10.0</a></em></p>

<p>Molecule now allows retrieving attribute values of selected entities:</p>

<pre><code class="language-scala">val List(e1, e2, e3) = Ns.int.insert(1, 2, 3).eids

// Use selected entity ids to access attributes of those entities
Ns(e1, e2).int.get === List(1, 2)

// Or use a variable with a collection of entity ids
val e23 = Seq(e2, e3)
Ns(e23).int.get === List(2, 3)
</code></pre>

<p>Likewise we can update attribute values of selected entities (group editing):</p>

<pre><code class="language-scala">val List(a, b, c) = Ns.str.int insert List((&quot;a&quot;, 1), (&quot;b&quot;, 2), (&quot;c&quot;, 3)) eids

// Apply value to attribute of multiple entities
Ns(a, b).int(4).update
Ns.str.int.get.sorted === List((&quot;a&quot;, 4), (&quot;b&quot;, 4), (&quot;c&quot;, 3))
</code></pre>

<p>See more examples
<a href="https://github.com/scalamolecule/molecule/blob/master/coretest/src/test/scala/molecule/attr/EntitySelection.scala">here</a> and
<a href="https://github.com/scalamolecule/molecule/blob/master/coretest/src/test/scala/molecule/manipulation/UpdateMultipleEntities.scala">here</a>.</p>

<p>Datomic encourages multi-step queries where you find some entities ids with one query and then pass those ids on as input
to the following query. Since we don&rsquo;t have the cost of round-trips to a database server, this is a powerful technique
that Molecule now supports with ease.</p>

<h2 id="13"><a href="#top">☝︎</a> Bidirectional references</h2>

<p><em>2016-07-24 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.9.0">v0.9.0</a></em></p>

<p>Major upgrade of Molecule introducing <em>Bidirectional</em> references.</p>

<p>Normal Datomic references are unidirectional. If we add a friend reference from Ann to Ben</p>

<pre><code class="language-scala">Person.name(&quot;Ann&quot;).Friends.name(&quot;Ben&quot;).save
</code></pre>

<p>Then we can naturally query to get friends of Ann</p>

<pre><code class="language-scala">Person.name_(&quot;Ann&quot;).Friends.name.get === List(&quot;Ben&quot;)
</code></pre>

<p>But what if we want to find friends of Ben? This will give us nothing:</p>

<pre><code class="language-scala">Person.name_(&quot;Ben&quot;).Friends.name.get === List()
</code></pre>

<p>Instead we would have to think backwards to get the back reference</p>

<pre><code class="language-scala"> Person.name.Friends.name_(&quot;Ben&quot;).get === List(&quot;Ann&quot;)
</code></pre>

<p>If we want to traverse deeper into a friendship graph we would have to query both forward and backward for each step in the graph
which would quickly become a pain. With Molecules new bidirectional references we can uniformly query from both ends:</p>

<pre><code class="language-scala"> Person.name_(&quot;Ann&quot;).Friends.name.get === List(&quot;Ben&quot;)
 Person.name_(&quot;Ben&quot;).Friends.name.get === List(&quot;Ann&quot;)
</code></pre>

<p>Please see <a href="http://www.scalamolecule.org/manual/query/bidirectional%20refs/">Bidirectional refs</a> for more information and the
<a href="https://github.com/scalamolecule/molecule/blob/master/examples/src/test/scala/molecule/examples/gremlin/gettingStarted/">Gremlin graph examples</a>.
- This release also adds support for BigInts and BigDecimals. Only bytes is not supported now due to the limited
  capabilities this type has in Datomic.
- Input molecules can now also include nested data structures.</p>

<h2 id="12"><a href="#top">☝︎</a> Composites &amp; Tx meta data</h2>

<p><em>2016-06-13 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.8.0">v0.8.0</a></em></p>

<p><a href="http://www.scalamolecule.org/manual/query/composites/">Composites</a> and
<a href="http://www.scalamolecule.org/manual/query/txMetaData/">Transaction meta data</a> are two new major functionalities added to Molecule.</p>

<p>Merge up to 22 sub-molecules as a Composite. Composite inserts create entities with data of attributes type-checking against
each sub-molecule. Sub-molecules don&rsquo;t need to be related. The created entity is what ties it all together which is a core
feature of Datomic that sets it apart from table/join-thinking.</p>

<p>An obvious candidate for composites is cross-cutting data that could be applied to any entity of our domain - like Tags. No need anymore
to litter all parts of your domain with refs to Tags. Keep your domain namespaces intrinsic and compose instead!</p>

<p>Even transaction meta data can now be applied:</p>

<pre><code class="language-scala">// Insert comma-separated molecules that become one composite molecule
insert(
  Article.name.author, Tag.name.weight
)(
  // 2 entities/&quot;rows&quot; created 
  ((&quot;Battle of Waterloo&quot;, &quot;Ben Bridge&quot;), (&quot;serious&quot;, 5)),
  ((&quot;Best jokes ever&quot;, &quot;John Cleese&quot;), (&quot;fun&quot;, 3))
)(
  // Transaction meta data is saved with the tx entity created
  MetaData.submitter_(&quot;Brenda Johnson&quot;).usecase_(&quot;AddReviews&quot;)
)
</code></pre>

<p>And we can then query the composed molecule:</p>

<pre><code class="language-scala">// Important articles submitted by Brenda Johnson
// In queries we tie composite molecule parts together with `~`
m(Article.name.author ~ Tag.weight.&gt;=(4).tx_(MetaData.submitter_(&quot;Brenda Johnson&quot;))).get === List(
  ((&quot;Battle of Waterloo&quot;, &quot;Ben Bridge&quot;), 5)
)
</code></pre>

<h2 id="11"><a href="#top">☝︎</a> sbt-molecule plugin code generation</h2>

<p><em>2016-06-04 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.7.0">v0.7.0</a></em></p>

<p>Previous fragile build system now standardized to use the new <a href="https://github.com/scalamolecule/sbt-molecule">sbt-molecule plugin</a>
to generate and package Molecule boilerplate code.</p>

<p>Several updates to <a href="http://www.scalamolecule.org">scalamolecule.org</a>.</p>

<h2 id="10"><a href="#top">☝︎</a> Various improvements and bug fixes</h2>

<p><em>2016-05-30 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.6.2">v0.6.2</a></em></p>

<ul>
<li>HList support dropped (was very incomplete anyway)</li>
<li><a href="https://github.com/scalamolecule/molecule/commit/70a951c5742ffe3925d777c0dfc284f223414445">Support for inserting more than 22 facts for a single namespace</a></li>
<li><a href="https://github.com/scalamolecule/molecule/commit/2c18c1e0255e0179d07272179ad1140d748abeec">Null references</a> now supported</li>
<li><a href="https://github.com/scalamolecule/molecule/commit/508e93753eb1e8080a24b40af6fb9ab8c229d0aa">Boilerplate in/out separated to avoid too big boilerplate files</a></li>
<li><a href="https://github.com/scalamolecule/molecule/commit/a4680b2ec483ec66ce4128e4cdd9657a9ad09fdb">Negation now takes Seq of values</a></li>
<li>Upgrade to sbt 0.13.11 using a build.sbt file</li>
</ul>

<h2 id="9"><a href="#top">☝︎</a> Keyed attribute maps</h2>

<p><em>2016-04-25 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.6.1">v0.6.1</a></em></p>

<p>Each defined attribute map now adds an additional attribute with a &ldquo;K&rdquo; appended to the attribute name. This &ldquo;Keyed attribute map&rdquo; expects
a key and will then return the single value type instead of a Map of key/values:</p>

<pre><code class="language-Scala">// Normal attribute map returning maps of key/values
Ns.int.greetings(&quot;en&quot;).get === List(
  (1, Map(&quot;en&quot; -&gt; &quot;Hi there&quot;)),
  (2, Map(&quot;en&quot; -&gt; &quot;Hi&quot;)),
  (3, Map(&quot;en&quot; -&gt; &quot;Hello&quot;))
)

// &quot;Keyed attribute map&quot; returning values directly (matching the key)
Ns.int.greetingsK(&quot;en&quot;).get === List(
  (1, &quot;Hi there&quot;),
  (2, &quot;Hi&quot;),
  (3, &quot;Hello&quot;)
)
</code></pre>

<p>This makes it more convenient to get to the values directly instead of having to extract them from returned Maps.</p>

<h2 id="8"><a href="#top">☝︎</a> Map Attributes - Multilingual support</h2>

<p><em>2015-12-14 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.5.0">v0.5.0</a></em></p>

<p>Molecule now supports an easy way to handle multilingual values; say, names of greetings in different languages for various entities - all
with one &ldquo;Map Attribute&rdquo; like <code>greetings</code>:</p>

<pre><code class="language-Scala">Ns.int.greetings insert List(
  (1, Map(&quot;en&quot; -&gt; &quot;Hi there&quot;)),
  (2, Map(&quot;fr&quot; -&gt; &quot;Bonjour&quot;, &quot;en&quot; -&gt; &quot;Hi&quot;)),
  (3, Map(&quot;en&quot; -&gt; &quot;Hello&quot;)),
  (4, Map(&quot;da&quot; -&gt; &quot;Hej&quot;))
)
</code></pre>

<p>Other types are supported too. So we could for instance have timezones as Float values for different countries etc.</p>

<p>Each key is prepended to its value and saved as a cardinality many value (&ldquo;en@Hi there&rdquo;) in Datomic. When we then retrieve the values,
Molecule automatically splits the values into typed key/value pairs in a map so that we can conveniently continue to work with them in Scala:</p>

<pre><code class="language-Scala">Ns.int.greetings.get === List(
  (1, Map(&quot;en&quot; -&gt; &quot;Hi there&quot;)),
  (2, Map(&quot;fr&quot; -&gt; &quot;Bonjour&quot;, &quot;en&quot; -&gt; &quot;Hi&quot;)),
  (3, Map(&quot;en&quot; -&gt; &quot;Hello&quot;)),
  (4, Map(&quot;da&quot; -&gt; &quot;Hej&quot;))
)

// English values only (find all values having &quot;en&quot; as key)
Ns.int.greetings(&quot;en&quot;).get === List(
  (1, Map(&quot;en&quot; -&gt; &quot;Hi there&quot;)),
  (2, Map(&quot;en&quot; -&gt; &quot;Hi&quot;)),
  (3, Map(&quot;en&quot; -&gt; &quot;Hello&quot;))
)

// English values containing the substring &quot;Hi&quot;
Ns.int.greetings(&quot;en&quot; -&gt; &quot;Hi&quot;).get === List(
  (1, Map(&quot;en&quot; -&gt; &quot;Hi there&quot;)),
  (2, Map(&quot;en&quot; -&gt; &quot;Oh, Hi&quot;))
)

// All values containing the substring &quot;He&quot;
Ns.int.greetings(&quot;_&quot; -&gt; &quot;He&quot;).get === List(
  (3, Map(&quot;en&quot; -&gt; &quot;Hello&quot;)),
  (4, Map(&quot;da&quot; -&gt; &quot;Hej&quot;))
)
</code></pre>

<h2 id="7"><a href="#top">☝︎</a> Nested adjacent references</h2>

<p><em>2015-11-14 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.4.3">v0.4.3</a></em></p>

<p>If we insert a nested data structure like this:</p>

<pre><code class="language-Scala">m(Ns.str.Refs1 * (Ref1.int1.Refs2 * Ref2.int2)) insert List(
  (&quot;a&quot;, List(
    (1, List(11)))),
  (&quot;b&quot;, List(
    (2, List(21, 22)),
    (3, List(31)))))
</code></pre>

<p>we can now query for each <code>Ns.str</code> paired with all its nested <code>Ref2.int2</code>&rsquo;s:</p>

<pre><code class="language-Scala">m(Ns.str.Refs1 * Ref1.Refs2.int2).get === List(
  (&quot;a&quot;, List(11)),
  (&quot;b&quot;, List(22, 21, 31)))
</code></pre>

<p>Resolution is recursive, so Molecule handles arbitrarily deep nested data structures.</p>

<h2 id="6"><a href="#top">☝︎</a> Back references in nested inserts/gets</h2>

<p><em>2015-11-13 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.4.2">v0.4.2</a></em></p>

<p>Now we can insert/get related values from multiple related namespaces in one go:</p>

<pre><code class="language-scala">m(lit_Book.title.Author.name._Book.Reviewers * gen_Person.name) insert List(
  (&quot;book&quot;, &quot;John&quot;, List(&quot;Marc&quot;))
)
m(lit_Book.title.Author.name._Book.Reviewers * gen_Person.name).get === List(
  (&quot;book&quot;, &quot;John&quot;, List(&quot;Marc&quot;))
)
</code></pre>

<p>From the <code>Book</code> namespace we reference first the <code>Author</code> namespace and then go back to the <code>Book</code> namespace again with
the <code>_Book</code> back reference so that we can then reference the <code>Reviewers</code> namespace. Like multiple connected &ldquo;arms&rdquo; of a complex molecule.</p>

<h2 id="5"><a href="#top">☝︎</a> Differentiating between optional values in insert/get</h2>

<p><em>2015-10-28 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.4.1">v0.4.1</a></em></p>

<p>Single optional values should be retrievable. But when inserting we want to avoid creating orphan referenced entities with
no asserted attribute values. Example from
<a href="https://github.com/scalamolecule/molecule/blob/8e5c0437c245201f5e174cb407ae74cdbc654257/coretest/src/test/scala/molecule/Relations.scala#L196-L236">Relations</a> test:</p>

<pre><code class="language-scala">&quot;No mandatory attributes after card-one ref&quot; in new CoreSetup {
  m(Ns.str.Ref1.int1) insert List(
    (&quot;a&quot;, 1),
    (&quot;b&quot;, 2))

  // Ok to ask for an optional referenced value
  m(Ns.str.Ref1.int1$).get === List(
    (&quot;a&quot;, Some(1)),
    (&quot;b&quot;, Some(2)))

  // But in insert molecules we don't want to create referenced orphan entities
  (m(Ns.str.Ref1.int1$).insert must throwA[RuntimeException]).message === &quot;Got the exception&quot; +
    &quot;java.lang.RuntimeException: &quot; +
    &quot;[output.Molecule:modelCheck (4)] Namespace `Ref1` in insert molecule&quot; + 
    &quot;has no mandatory attributes. Please add at least one.&quot;
}
</code></pre>

<h2 id="4"><a href="#top">☝︎</a> Optional values (like Null)</h2>

<p><em>2015-10-25 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.4.0">v0.4.0</a></em></p>

<p>Molecule now supports optional values:</p>

<pre><code class="language-scala">val names = Person.firstName.middleName$.lastName.get map { 
  case (firstName, Some(middleName), lastName) =&gt; s&quot;$firstName $middleName $lastName&quot; 
  case (firstName, None, lastName)             =&gt; s&quot;$firstName $lastName&quot; 
}
</code></pre>

<p>Also when inserting varying data sets, this comes in handy, like for instance if middle names are sometimes present and sometimes not:</p>

<pre><code class="language-scala">Person.firstName.middleName$.lastName insert List(
  (&quot;John&quot;, None, &quot;Doe&quot;),
  (&quot;Lisa&quot;, Some(&quot;van&quot;), &quot;Hauen&quot;)
)
</code></pre>

<p>See more examples of even deeply nested optional values in the
<a href="https://github.com/scalamolecule/molecule/blob/80765bfbae17657cd0fa0fa099a6ba22f41a179f/coretest/src/test/scala/molecule/OptionalValues.scala">OptionalValues</a> tests.</p>

<h2 id="3"><a href="#top">☝︎</a> Nested data structures</h2>

<p><em>2015-10-04 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.3.0">v0.3.0</a></em></p>

<p><a href="https://github.com/scalamolecule/molecule/blob/master/examples/src/test/scala/molecule/examples/dayOfDatomic/ProductsAndOrders.scala">Products and Orders</a>
shows how Molecule can now retrieve nested data structures at up to 10 levels deep (more can be implemented if necessary). This means
that you don&rsquo;t need to manually organize the flat output from Datomic into hierarchical data structures yourself when you query for
one-many or many-many data. Molecule does it for you.</p>

<h2 id="2"><a href="#top">☝︎</a> Implemented Day-Of-Datomic and MBrainz</h2>

<p><em>2014-12-25 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.2.0">v0.2.0</a></em></p>

<ul>
<li>Nested molecules</li>
<li>Transitive molecules</li>
<li>Simplifying API</li>
</ul>

<h2 id="1"><a href="#top">☝︎</a> Initial commit - <a href="/resources/tutorials/seattle/">Seattle tutorial</a></h2>

<p><em>2014-07-02 <a href="https://github.com/scalamolecule/molecule/releases/tag/v0.1.0">v0.1.0</a></em></p>

    </div>

    <div class="col-sm-2 column" style="padding-left:20px;padding-top:22px;padding-right: 0px;">
        <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm ">

  <div style="position:absolute;top: 15px; left: 0px;">
    
    
    
    
  </div>

  <ul class="bs-docs-sidenav">
    
  </ul>
</nav>
    </div>

</div> 

     
   
 
<div class="push"></div>
</div> 

<footer class="bs-docs-footer">

  <div class="container">
    <ul class="bs-docs-footer-links">
      <li style="vertical-align: top; margin-top: 0px;"><a href="/front/"><img src="/img/logo/MoleculeLogo200.png" alt=""></a></li>
      <li><a href="https://github.com/scalamolecule/molecule">GitHub</a></li>
      <li><a href="https://github.com/scalamolecule/molecule-web">GitHub-web</a></li>
      <li><a href="https://groups.google.com/forum/#!forum/molecule-dsl">Forum</a></li>
      <li><a href="/about/">About</a></li>
      <li><a href="/credits/">Credits</a></li>
    </ul>
    <p>Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="license">Apache License 2.0</a></p>
  </div>
</footer>


<script type="text/javascript" src="/js/jquery-1.11.2.min.js"></script>



<script type="text/javascript" src="/js/bootstrap.min.js"></script>



<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript" src="/js/scripts.js"></script>




<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2787756-3', 'auto');
  ga('send', 'pageview');
</script>
    
</body>
</html>
