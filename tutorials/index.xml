<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Tutorials on Molecule</title>
    <link>http://localhost:1313/tutorials/</link>
    <description>Recent content in Tutorials on Molecule</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    
    
    <lastBuildDate>Fri, 02 Jan 2015 22:06:44 CET</lastBuildDate>
    <atom:link href="http://localhost:1313/tutorials/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Presentation</title>
      <link>http://localhost:1313/tutorials/presentation/</link>
      <pubDate>Fri, 02 Jan 2015 22:06:44 CET</pubDate>
      
      <guid>http://localhost:1313/tutorials/presentation/</guid>
      <description>

&lt;h1 id=&#34;molecule-presentation-sample-code-snippets:82edc323b2fe0e0e86215b27014d533e&#34;&gt;Molecule presentation sample code snippets&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.id.nameMap.get.head === (101, Map(
    &amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;,
    &amp;quot;de&amp;quot; -&amp;gt; &amp;quot;Dmitri Schostakowitsch&amp;quot;,
    &amp;quot;fr&amp;quot; -&amp;gt; &amp;quot;Dmitri Chostakovitch&amp;quot;
  ))
  
// By key
Person.nameMapK(&amp;quot;fr&amp;quot;).get.head === &amp;quot;Dmitri Chostakovitch&amp;quot;

// By value
Person.id.nameMap_(&amp;quot;Dmitri Chostakovitch&amp;quot;).get.head === 101
Person.id.nameMap_(&amp;quot;.*Shosta.*&amp;quot;).get.head === 101

// By key and value
Person.id.nameMap_(&amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;).get.head === 101
Person.id.nameMap_(&amp;quot;en&amp;quot;)(&amp;quot;.*Shosta.*&amp;quot;).get.head === 101
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.id.nameMap.get.head === (101, Map(
    &amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;,
    &amp;quot;de&amp;quot; -&amp;gt; &amp;quot;Dmitri Schostakowitsch&amp;quot;,
    &amp;quot;fr&amp;quot; -&amp;gt; &amp;quot;Dmitri Chostakovitch&amp;quot;
  ))
  
// By key
Person.nameMapK(&amp;quot;fr&amp;quot;).get.head === &amp;quot;Dmitri Chostakovitch&amp;quot;

// By value
Person.id.nameMap_(&amp;quot;Dmitri Chostakovitch&amp;quot;).get.head === 101
Person.id.nameMap_(&amp;quot;.*Shosta.*&amp;quot;).get.head === 101
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.id.nameMap.get.head === (101, Map(
    &amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;,
    &amp;quot;de&amp;quot; -&amp;gt; &amp;quot;Dmitri Schostakowitsch&amp;quot;,
    &amp;quot;fr&amp;quot; -&amp;gt; &amp;quot;Dmitri Chostakovitch&amp;quot;
  ))
  
// By key
Person.nameMapK(&amp;quot;fr&amp;quot;).get.head === &amp;quot;Dmitri Chostakovitch&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.id.nameMap.get.head === (101, Map(
    &amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;,
    &amp;quot;de&amp;quot; -&amp;gt; &amp;quot;Dmitri Schostakowitsch&amp;quot;,
    &amp;quot;fr&amp;quot; -&amp;gt; &amp;quot;Dmitri Chostakovitch&amp;quot;
  ))
  
// By key
Person.nameMapK(&amp;quot;fr&amp;quot;).get.head === &amp;quot;Dmitri Chostakovitch&amp;quot;
Person.nameMapK(&amp;quot;fr|en&amp;quot;).get.head === &amp;quot;Dmitri Chostakovitch&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name
  .Home.street.city._Person
  .Work.street.city.get.head === (
  &amp;quot;Fred&amp;quot;, 
  &amp;quot;Baker st. 7&amp;quot;, &amp;quot;Boston&amp;quot;, 
  &amp;quot;Downtown 1&amp;quot;, &amp;quot;Boston&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name
  .Home.street.city._Person
  .Cottage.street.city._Person
  .Work.street.city.get.head === (
  &amp;quot;Fred&amp;quot;, 
  &amp;quot;Baker st. 7&amp;quot;, &amp;quot;Boston&amp;quot;, 
  &amp;quot;Mountain way 32&amp;quot;, &amp;quot;Woods town&amp;quot;, 
  &amp;quot;Downtown 1&amp;quot;, &amp;quot;Boston&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Home.street.city.get.head === (
  &amp;quot;Fred&amp;quot;, &amp;quot;Baker St. 7&amp;quot;, &amp;quot;Boston&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.get  // &amp;quot;We need an M2 with a &#39;get&#39; method!&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age  // extends M2[String, Int])
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Person.name.age).get     ...or...       Person.name.age.get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;implicit def m[A, B](dsl: M2[A, B]): Molecule2[A, B] = macro from2attr[A, B]
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;implicit def m[A, B](dsl: M2[A, B]): Molecule2[A, B] = macro from2attr[A, B]

// Macro implementation (simplified)
def from2attr[A, B](dsl: M2[A, B]): Molecule2[A, B] = {
  val query = ??? // todo
  q&amp;quot;&amp;quot;&amp;quot;
    new Molecule2[A, B] {
      def get: Iterable[(A, B)] = datomic.Peer.q(${query}, conn.db).asScala.map(
        _.asScala match {
          case Seq(a, b) =&amp;gt; (a.asInstanceOf[A], b.asInstanceOf[B])
        }
      )
    }
  &amp;quot;&amp;quot;&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;

// Macro implementation (simplified)
def from2attr[A, B](dsl: M2[A, B]): Molecule2[A, B] = {
  val query = ??? // todo
  q&amp;quot;&amp;quot;&amp;quot;
    new Molecule2[A, B] {
      def get: Iterable[(A, B)] = datomic.Peer.q(${query}, conn.db).asScala.map(
        _.asScala match {
          case Seq(a, b) =&amp;gt; (a.asInstanceOf[A], b.asInstanceOf[B])
        }
      )
    }
  &amp;quot;&amp;quot;&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;



  val query = ??? // todo
  q&amp;quot;&amp;quot;&amp;quot;
    new Molecule2[A, B] {
      def get: Iterable[(A, B)] = datomic.Peer.q(${query}, conn.db).asScala.map(
        _.asScala match {
          case Seq(a, b) =&amp;gt; (a.asInstanceOf[A], b.asInstanceOf[B])
        }
      )
    }
  &amp;quot;&amp;quot;&amp;quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;




  q&amp;quot;&amp;quot;&amp;quot;
    new Molecule2[A, B] {
      def get: Iterable[(A, B)] = datomic.Peer.q(${query}, conn.db).asScala.map(
        _.asScala match {
          case Seq(a, b) =&amp;gt; (a.asInstanceOf[A], b.asInstanceOf[B])
        }
      )
    }
  &amp;quot;&amp;quot;&amp;quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;implicit def m[A, B](dsl: M2[A, B]): Molecule2[A, B] = macro from2attr[A, B]

def from2attr[A: c.WeakTypeTag, B: c.WeakTypeTag]
    (c: Context)
    (dsl: c.Expr[M2[A, B]])
: c.Expr[Molecule2[A, B]] = {
  val query = ???
  c.Expr(
    q&amp;quot;&amp;quot;&amp;quot;
      new Molecule2[${c.weakTypeOf[A]}, ${c.weakTypeOf[B]}] {
        def get = datomic.Peer.q(${query}, conn.db).asScala.map( _.asScala match {
            case Seq(a, b) =&amp;gt;
              (a.asInstanceOf[${c.weakTypeOf[A]}], b.asInstanceOf[${c.weakTypeOf[B]}])
          }
        )
      }
    &amp;quot;&amp;quot;&amp;quot;
  )
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val (email, oldPassw) = User(eid).email.passw.get.head
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val encryptedNewPassw = encrypt(newPassw)
User(eid).passw(encryptedNewPassw).save
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Actions
val saveJohn      = Person.str(&amp;quot;John&amp;quot;).int(44).saveTx
val insertMembers = Person.str.int insertTx List((&amp;quot;Lisa&amp;quot;, 23), (&amp;quot;Pete&amp;quot;, 24))
val updateFred    = Person(fred).int(43).updateTx

val base     = m(Person.name.age)
val expected = List(
  (&amp;quot;Fred&amp;quot;, 43), // Updated
  (&amp;quot;John&amp;quot;, 44), // Saved
  (&amp;quot;Lisa&amp;quot;, 23), // Inserted
  (&amp;quot;Pete&amp;quot;, 24)  // Inserted
)

// Test: Order of actions doesn&#39;t affect outcome
base.getWith(saveJohn, insertMembers, updateFred) === expected
base.getWith(saveJohn, updateFred, insertMembers) === expected
base.getWith(insertMembers, saveJohn, updateFred) === expected
base.getWith(insertMembers, updateFred, saveJohn) === expected
base.getWith(updateFred, saveJohn, insertMembers) === expected
base.getWith(updateFred, insertMembers, saveJohn) === expected
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Actions
val saveJohn      = Person.str(&amp;quot;John&amp;quot;).int(44).saveTx
val insertMembers = Person.str.int insertTx List((&amp;quot;Lisa&amp;quot;, 23), (&amp;quot;Pete&amp;quot;, 24))
val updateFred    = Person(fred).int(43).updateTx

val base     = m(Person.name.age)
val expected = List(
  (&amp;quot;Fred&amp;quot;, 43), // Updated
  (&amp;quot;John&amp;quot;, 44), // Saved
  (&amp;quot;Lisa&amp;quot;, 23), // Inserted
  (&amp;quot;Pete&amp;quot;, 24)  // Inserted
)

// Test: Order of actions doesn&#39;t affect outcome
base.getWith(saveJohn, insertMembers, updateFred).get.toSeq.sorted === expected
base.getWith(saveJohn, updateFred, insertMembers).get.toSeq.sorted === expected
base.getWith(insertMembers, saveJohn, updateFred).get.toSeq.sorted === expected
base.getWith(insertMembers, updateFred, saveJohn).get.toSeq.sorted === expected
base.getWith(updateFred, saveJohn, insertMembers).get.toSeq.sorted === expected
base.getWith(updateFred, insertMembers, saveJohn).get.toSeq.sorted === expected
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val fred = Person.name(&amp;quot;Fred&amp;quot;).age(42).save.eid
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))

Person.name.age.getWith(
  Person.name(&amp;quot;John&amp;quot;).age(44).saveTx,
  Person.name.age insertTx List(
    (&amp;quot;Lisa&amp;quot;, 23),
    (&amp;quot;Pete&amp;quot;, 24)
  ),
  Person(fred).age(43).updateTx
) === List(
  (&amp;quot;Fred&amp;quot;, 43), // Updated
  (&amp;quot;John&amp;quot;, 44), // Saved
  (&amp;quot;Lisa&amp;quot;, 23), // Inserted
  (&amp;quot;Pete&amp;quot;, 24)  // Inserted
)

// Nothing changed
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val fred = Person.name(&amp;quot;Fred&amp;quot;).age(42).save.eid
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))

Person.name.age.getWith(
  Person.name.age insertTx List(
    (&amp;quot;Lisa&amp;quot;, 23),
    (&amp;quot;Pete&amp;quot;, 24)
  )
) === List(
  (&amp;quot;Fred&amp;quot;, 42), // unchanged
  (&amp;quot;Lisa&amp;quot;, 23), // inserted
  (&amp;quot;Pete&amp;quot;, 24)  // inserted
)

// Nothing changed
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val fred = Person.name(&amp;quot;Fred&amp;quot;).age(42).save.eid
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))

Person.name.age.getWith(
  Person.name(&amp;quot;John&amp;quot;).age(44).saveTx
) === List(
  (&amp;quot;Fred&amp;quot;, 42), // unchanged
  (&amp;quot;John&amp;quot;, 44)  // new saved
)

// Nothing changed
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val fred = Person.name(&amp;quot;Fred&amp;quot;).age(42).save.eid
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))

Person.name.age.getWith(
  Person(fred).age(43).updateTx
) === List(
  (&amp;quot;Fred&amp;quot;, 43) // updated
)

// Nothing changed
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;List(
  [:db/add, 17592186045445, :ns/int, 43]
)
List(
    [:db/add, #db/id[:db.part/user -1000112], :ns/str, John], 
    [:db/add, #db/id[:db.part/user -1000112], :ns/int, 44]
)
List(
    [:db/add, #db/id[:db.part/user -1000113], :ns/str, Lisa], 
    [:db/add, #db/id[:db.part/user -1000113], :ns/int, 23], 
    [:db/add, #db/id[:db.part/user -1000114], :ns/str, Pete], 
    [:db/add, #db/id[:db.part/user -1000114], :ns/int, 24]
)
List(
    [:db/add, 17592186045445, :ns/int, 43]
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;List(
  [:db/add, 17592186045445, :ns/int, 43]
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val fred = Person.name(&amp;quot;Fred&amp;quot;).age(42).save.eid
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))

Person.name.age.getWith ( // previously `imagine`
  // Manipulate some data...
) === List(
  // Expected result?
)

// Nothing changed
Person.name.age.get === List((&amp;quot;Fred&amp;quot;, 42))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val tx1 = Person.likes(&amp;quot;pizza&amp;quot;).save
val tx2 = Person.likes(&amp;quot;pasta&amp;quot;).save
val tx3 = Person.likes(&amp;quot;sushi&amp;quot;).save
val tx4 = Person.likes(&amp;quot;burger&amp;quot;).save

// Values since tx2 (tx2 itself excluded)
// (previously `since(tx2).get`)
Person.likes.getSince(tx2) === List(&amp;quot;sushi&amp;quot;, &amp;quot;burger&amp;quot;)  
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.op.txInstant
  .tx_(Audit.user.uc).getHistory === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, true, &amp;quot;2017-04-25 13:52:07&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;survey&amp;quot;),
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, false, &amp;quot;2017-04-26 18:35:41&amp;quot;, &amp;quot;Peter&amp;quot;, &amp;quot;interview&amp;quot;),
  (&amp;quot;Fred&amp;quot;, &amp;quot;pasta&amp;quot;, true, &amp;quot;2017-04-26 18:35:41&amp;quot;, &amp;quot;Peter&amp;quot;, &amp;quot;interview&amp;quot;)
)

Person.name.likes.op.txInstant
  .tx_(Audit.user_(&amp;quot;Peter&amp;quot;).uc_(&amp;quot;interview&amp;quot;)).getHistory === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, false, &amp;quot;2017-04-26 18:35:41&amp;quot;),
  (&amp;quot;Fred&amp;quot;, &amp;quot;pasta&amp;quot;, true, &amp;quot;2017-04-26 18:35:41&amp;quot;)
)

Person.name.likes_(&amp;quot;pizza&amp;quot;).op_(false).txInstant
  .tx_(Audit.uc_(&amp;quot;interview&amp;quot;)).getHistory === List( // previosuly `history.get`
  (&amp;quot;Fred&amp;quot;, &amp;quot;2017-04-26 18:35:41&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.op.txInstant
  .tx_(Audit.user.uc).getHistory === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, true, &amp;quot;2017-04-25 13:52:07&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;survey&amp;quot;),
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, false, &amp;quot;2017-04-26 18:35:41&amp;quot;, &amp;quot;Peter&amp;quot;, &amp;quot;interview&amp;quot;),
  (&amp;quot;Fred&amp;quot;, &amp;quot;pasta&amp;quot;, true, &amp;quot;2017-04-26 18:35:41&amp;quot;, &amp;quot;Peter&amp;quot;, &amp;quot;interview&amp;quot;)
)

Person.name.likes.op.txInstant
  .tx_(Audit.user_(&amp;quot;Peter&amp;quot;).uc_(&amp;quot;interview&amp;quot;)).getHistory === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, false, &amp;quot;2017-04-26 18:35:41&amp;quot;),
  (&amp;quot;Fred&amp;quot;, &amp;quot;pasta&amp;quot;, true, &amp;quot;2017-04-26 18:35:41&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.op.txInstant
  .tx_(Audit.user.uc).getHistory === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, true, &amp;quot;2017-04-25 13:52:07&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;survey&amp;quot;),
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, false, &amp;quot;2017-04-26 18:35:41&amp;quot;, &amp;quot;Peter&amp;quot;, &amp;quot;interview&amp;quot;),
  (&amp;quot;Fred&amp;quot;, &amp;quot;pasta&amp;quot;, true, &amp;quot;2017-04-26 18:35:41&amp;quot;, &amp;quot;Peter&amp;quot;, &amp;quot;interview&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(fred).likes.op
  .tx_(Audit.user.uc).getHistory === List(
  (&amp;quot;pizza&amp;quot;, true),
  (&amp;quot;pizza&amp;quot;, false),
  (&amp;quot;pasta&amp;quot;, true)
)

Person.name.likes.op_(false).txInstant
  .tx_(Audit.user.uc).getHistory === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, &amp;quot;2017-04-26 18:35:41&amp;quot;, &amp;quot;Peter&amp;quot;, &amp;quot;interview&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(fred).likes.op.getHistory === List(
  (&amp;quot;pizza&amp;quot;, true),
  (&amp;quot;pizza&amp;quot;, false),
  (&amp;quot;pasta&amp;quot;, true)
)

Person(fred).likes.getHistory === List(&amp;quot;pizza&amp;quot;, &amp;quot;pasta&amp;quot;)

Person(fred).likes.op_(false).getHistory === List(&amp;quot;pizza&amp;quot;)

Person.name.likes.op_(false).txInstant.getHistory === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, &amp;quot;2017-04-26 18:35:41&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(fred).likes.op.getHistory === List(
  (&amp;quot;pizza&amp;quot;, true),
  (&amp;quot;pizza&amp;quot;, false),
  (&amp;quot;pasta&amp;quot;, true)
)

Person(fred).likes.getHistory === List(&amp;quot;pizza&amp;quot;, &amp;quot;pasta&amp;quot;)

Person(fred).likes.op_(false).getHistory === List(&amp;quot;pizza&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(fred).likes.op.getHistory === List(
  (&amp;quot;pizza&amp;quot;, true),
  (&amp;quot;pizza&amp;quot;, false),
  (&amp;quot;pasta&amp;quot;, true)
)

Person(fred).likes.getHistory === List(&amp;quot;pizza&amp;quot;, &amp;quot;pasta&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(fred).likes.op.getHistory === List( // previously `history.get`
  (&amp;quot;pizza&amp;quot;, true),
  (&amp;quot;pizza&amp;quot;, false),
  (&amp;quot;pasta&amp;quot;, true)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val result = Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;).save
val fred   = result.eid
val t1     = result.t
Person(fred).likes.get.head === &amp;quot;pizza&amp;quot;

val t2 = Person(fred).likes(&amp;quot;pasta&amp;quot;).update.t
Person(fred).likes.get.head === &amp;quot;pasta&amp;quot;

Person(fred).likes.getAsOf(t1).head === &amp;quot;pizza&amp;quot; // previously `asOf(t1).get`
Person(fred).likes.getAsOf(t2).head === &amp;quot;pasta&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala`&#34;&gt;val result = Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;).save
val fred   = result.eid
val t1     = result.t
Person(fred).likes.get.head === &amp;quot;pizza&amp;quot;

val t2 = Person(fred).likes(&amp;quot;pasta&amp;quot;).update.t
Person(fred).likes.get.head === &amp;quot;pasta&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val result = Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;).save
val fred   = result.eid
val t1     = result.t
Person(fred).likes.get.head === &amp;quot;pizza&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.likes.tx_(Audit.user_(&amp;quot;Lisa&amp;quot;).uc_(&amp;quot;survey&amp;quot;)).get === List(&amp;quot;pizza&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.tx_(Audit.uc_(&amp;quot;survey&amp;quot;)).get === List(&amp;quot;Fred&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(e5).name.txInstant.tx(Audit.user.uc).get === List( 
  (&amp;quot;Fred&amp;quot;, &amp;quot;Tue Apr 26 18:35:41 CEST 2017&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;survey&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(e5).name.tx(Audit.user.uc).get === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;survey&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(e5).name.tx(Audit.user.uc).get === List((&amp;quot;Fred&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;survey&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;)
  .tx_(Audit.user_(&amp;quot;Lisa&amp;quot;).uc_(&amp;quot;survey&amp;quot;)).save
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;trait Audit {
  val user   = oneString
  val usecase = oneString
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(e5).name_.txInstant.get.head === date1
Person(e5).name_.tx.get.head === t4
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(e5).name_.txInstant.get.head === date1  // Tue Apr 26 18:35:41
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(e5).name_.tx.get.head === tx4  // 13194139534340L
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val e5 = Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;).save.eid
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;).save
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Property graph
Person.name_(&amp;quot;Ann&amp;quot;).Knows.weight.Person.name.get === List((7, &amp;quot;Ben&amp;quot;))
Person.name_(&amp;quot;Ben&amp;quot;).Knows.weight.Person.name.get === List((7, &amp;quot;Ann&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Knows.*(Knows.weight.Person.name).insert(
  &amp;quot;Ann&amp;quot;, List((7, &amp;quot;Ben&amp;quot;), (8, &amp;quot;Joe&amp;quot;)))

Person.name_(&amp;quot;Ann&amp;quot;).Knows.weight.Person.name.get === 
  List((7, &amp;quot;Ben&amp;quot;), (8, &amp;quot;Joe&amp;quot;))

Person.name_(&amp;quot;Ben&amp;quot;).Knows.weight.Person.name.get === 
  List((7, &amp;quot;Ann&amp;quot;))

Person.name_(&amp;quot;Joe&amp;quot;).Knows.weight.Person.name.get === 
  List((8, &amp;quot;Ann&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Entity
object Person extends Person
trait Person {
  val knows = 
    manyBiEdge[Knows.person.type]
  
  val name = oneString
}

// Property edge
object Knows extends Knows
trait Knows {
  val person = 
    target[Person.knows.type]
  
  // Property
  val weight = oneInt
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Entity
object Person extends Person
trait Person {
  // A ==&amp;gt; edge -- a
  val knows = manyBiEdge[Knows.person.type]
  
  val name = oneString
}

// Property edge
object Knows extends Knows
trait Knows {
  // a --- edge ==&amp;gt; a
  val person: AnyRef = target[Person.knows.type]
  
  // Property
  val weight = oneInt
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Graph
Person.name(&amp;quot;Ann&amp;quot;).Friends.name(&amp;quot;Ben&amp;quot;).save
Person.name(&amp;quot;Ben&amp;quot;).Friends.name(&amp;quot;Joe&amp;quot;).save

Person.name_(&amp;quot;Ann&amp;quot;).Friends.Friends.name.not(&amp;quot;Ann&amp;quot;).get === List(&amp;quot;Joe&amp;quot;)
Person.name_(&amp;quot;Joe&amp;quot;).Friends.Friends.name.not(&amp;quot;Joe&amp;quot;).get === List(&amp;quot;Ann&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Graph
Person.name(&amp;quot;Ann&amp;quot;).Friends.name(&amp;quot;Ben&amp;quot;).save
Person.name(&amp;quot;Ben&amp;quot;).Friends.name(&amp;quot;Joe&amp;quot;).save

//                    Ben   Ann/Joe
Person.name_(&amp;quot;Ann&amp;quot;).Friends.Friends.name.get === List(&amp;quot;Ann&amp;quot;, &amp;quot;Joe&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name(&amp;quot;Ann&amp;quot;).Friends.name(&amp;quot;Ben&amp;quot;).save

Person.name_(&amp;quot;Ann&amp;quot;).Friends.name.get === List(&amp;quot;Ben&amp;quot;)
Person.name_(&amp;quot;Ben&amp;quot;).Friends.name.get === List(&amp;quot;Ann&amp;quot;)

Ann --&amp;gt; Ben
Ben &amp;lt;-- Ann // reverse ref
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;trait Person {
  val name    = oneString
  val friends = manyBi[Person]
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Friends.name_(&amp;quot;Ben&amp;quot;).get === List(&amp;quot;Ann&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name_(&amp;quot;Ben&amp;quot;).Friends.name.get === List()
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name_(&amp;quot;Ann&amp;quot;).Friends.name.get === List(&amp;quot;Ben&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name(&amp;quot;Ann&amp;quot;).Friends.name(&amp;quot;Ben&amp;quot;).save

Person.name_(&amp;quot;Ann&amp;quot;).Friends.name.get === List(&amp;quot;Ben&amp;quot;)
Person.name_(&amp;quot;Ben&amp;quot;).Friends.name.get === List()

Person.name.Friends.name_(&amp;quot;Ben&amp;quot;).get === List(&amp;quot;Ann&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name(&amp;quot;Ann&amp;quot;).Friends.name(&amp;quot;Ben&amp;quot;).save

Person.name_(&amp;quot;Ann&amp;quot;).Friends.name.get === List(&amp;quot;Ben&amp;quot;)
Person.name_(&amp;quot;Ben&amp;quot;).Friends.name.get === List()
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name(&amp;quot;Ann&amp;quot;).Friends.name(&amp;quot;Ben&amp;quot;).save

Person.name_(&amp;quot;Ann&amp;quot;).Friends.name.get === List(&amp;quot;Ben&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;trait Person {
  val name    = oneString
  val friends = many[Person]
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;trait Person {
  // A ==&amp;gt; a
  val spouse  = oneBi[Person]
  val friends = manyBi[Person]

  // A ==&amp;gt; b
  val pet     = oneBi[Animal.master.type]
  val buddies = manyBi[Animal.buddies.type]

  // A ==&amp;gt; edge -- a
  val loves = oneBiEdge[Loves.person.type]
  val knows = manyBiEdge[Knows.person.type]

  // A ==&amp;gt; edge -- b
  val favorite = oneBiEdge[Favorite.animal.type]
  val closeTo  = manyBiEdge[CloseTo.animal.type]

  val name = oneString
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Mix input, static expressions and relationships...
val americansYoungerThan = m(Person.id.age_.&amp;lt;(?).Country.name_(&amp;quot;USA&amp;quot;))
val americanKids         = americansYoungerThan(13).get
val americanBabies       = americansYoungerThan(1).get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Multiple input parameters + logic
val person = m(Person.id.name_(?).age_(?))

// AND
val john42 = person(&amp;quot;John&amp;quot; and 42).get.head

// AND/OR
val john42orJonas38  = person((&amp;quot;John&amp;quot; and 42) or (&amp;quot;Jonas&amp;quot; and 38)).get 
val john42orJonas38b = person((&amp;quot;John&amp;quot;, 42), (&amp;quot;Jonas&amp;quot;, 38)).get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Mix input, static expressions and relationships...
val americansYoungerThan = m(Person.id.age_.&amp;lt;(?).Country.name_(&amp;quot;USA&amp;quot;))
val americanKids         = americansYoungerThan(13).get
val americanBabies       = americansYoungerThan(1).get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Multiple input parameters + logic
val person = m(Person.id.name_(?).age_(?))

// AND
val john42 = person(&amp;quot;John&amp;quot; and 42).get.head
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// 1 input parameter
val person = m(Person.id.name_(?))

val john     = person(&amp;quot;John&amp;quot;).get.head
val students = person(allStudentNames).get.head
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val persons = datomic.Peer.q(
  &amp;quot;&amp;quot;&amp;quot;
    |[:find ?id
    | :in $ ?names
    | :where
    |   [?e :person/name ?names]]
  &amp;quot;&amp;quot;&amp;quot;.stripMargin, conn.db, &amp;quot;John&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;fredId.retract

Person.name(&amp;quot;Fred&amp;quot;).get.size === 0 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.id.nameMap.insert(
  101,
  Map(
    &amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;,
    &amp;quot;de&amp;quot; -&amp;gt; &amp;quot;Dmitri Schostakowitsch&amp;quot;,
    &amp;quot;fr&amp;quot; -&amp;gt; &amp;quot;Dmitri Chostakovitch&amp;quot;,
    &amp;quot;es&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakóvich&amp;quot;
  )
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;trait Person {
  val id      = oneInt
  val nameMap = mapString
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;fredId.retract

Person.name(&amp;quot;Fred&amp;quot;).get.size === 0 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(bob).hobbies.add(&amp;quot;stars&amp;quot;).update
Person(bob).hobbies.get.head === Set(&amp;quot;golf&amp;quot;, &amp;quot;cars&amp;quot;, &amp;quot;stars&amp;quot;)

Person(bob).hobbies.replace(&amp;quot;cars&amp;quot; -&amp;gt; &amp;quot;trains&amp;quot;).update
Person(bob).hobbies.get.head === Set(&amp;quot;golf&amp;quot;, &amp;quot;trains&amp;quot;, &amp;quot;stars&amp;quot;)

Person(bob).hobbies.remove(&amp;quot;golf&amp;quot;).update
Person(bob).hobbies.get.head === Set(&amp;quot;trains&amp;quot;, &amp;quot;stars&amp;quot;)

Person(bob).hobbies(&amp;quot;skiing&amp;quot;, &amp;quot;stamps&amp;quot;).update
Person(bob).hobbies.get.head === Set(&amp;quot;skiing&amp;quot;, &amp;quot;stamps&amp;quot;)

Person(bob).hobbies().update
Person(bob).hobbies.get.head === Set()
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Assert new fact
Person(fred).likes(&amp;quot;pasta&amp;quot;).update
Person(fred).likes$.get.head === Some(&amp;quot;pasta&amp;quot;)

// Retract old fact
Person(fred).likes().update
Person(fred).likes$.get.head === None
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Assert new fact
Person(fred).likes(&amp;quot;pasta&amp;quot;).update
Person(fred).likes$.get.head === Some(&amp;quot;pasta&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(fred).likes(&amp;quot;pasta&amp;quot;).update
Person(fred).likes$.get.head === Some(&amp;quot;pasta&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Re-use insert molecules
val insertPerson = Person.name.likes$.age.insert
val fredId = insertPerson(&amp;quot;Fred&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 38).eid 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes$ insert List(
  (&amp;quot;Fred&amp;quot;, 38, Some(&amp;quot;pizza&amp;quot;)),
  (&amp;quot;Lisa&amp;quot;, 7, None),
  (&amp;quot;Ben&amp;quot;, 5, Some(&amp;quot;pizza&amp;quot;))
)

// Re-use insert-molecules
val insertPerson = Person.name.age.likes$.insert
val fred = insertPerson(&amp;quot;Fred&amp;quot;, 38, Some(&amp;quot;pizza&amp;quot;)).eid
val ben  = insertPerson(&amp;quot;Lisa&amp;quot;, 7, None).eid
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes$.age insert List(
  (&amp;quot;Fred&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 38),
  (&amp;quot;Lisa&amp;quot;, None, 7),
  (&amp;quot;Ben&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person
  .name(&amp;quot;Fred&amp;quot;)
  .age(38)
  .likes(&amp;quot;pizza&amp;quot;).save
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes$.get === List(
  (&amp;quot;Fred&amp;quot;, 38, Some(&amp;quot;pizza&amp;quot;)),
  (&amp;quot;Lisa&amp;quot;, 7, None),
  (&amp;quot;Ben&amp;quot;, 5, Some(&amp;quot;pizza&amp;quot;))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes$ insert List(
  (&amp;quot;Fred&amp;quot;, 38, Some(&amp;quot;pizza&amp;quot;)),
  (&amp;quot;Lisa&amp;quot;, 7, None),
  (&amp;quot;Ben&amp;quot;, 5, Some(&amp;quot;pizza&amp;quot;))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Save 1 molecule
Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;).age(38).save

// Insert
Person.name.likes$.age insert List(
  (&amp;quot;Fred&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 38),
  (&amp;quot;Lisa&amp;quot;, None, 7),
  (&amp;quot;Ben&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;).age(38).save
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Person.name.likes.age ~ Site.cat.status ~ Loc.tag).get === List(
  ((&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, 38), (&amp;quot;customer&amp;quot;, &amp;quot;good&amp;quot;), &amp;quot;city&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Person.name.likes.age ~ Site.cat.status).get === List(
  ((&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, 38), (&amp;quot;customer&amp;quot;, &amp;quot;good&amp;quot;))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Person.name.likes.age ~ Site.cat).get === List(
  ((&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, 38), &amp;quot;customer&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Person.name.likes.age ~ Site.cat).get === List(
  ((&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, 38), &amp;quot;customer&amp;quot;)
)

val ((name, likes, age), cat) = m(Person.name.likes.age ~ Site.cat).get.head
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.age ~ Site.cat
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name  = oneString
    val likes = oneString
    val age   = oneInt
  }
  trait Site {
    val cat    = oneString
    val status = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.age.Site.cat
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name  = oneString
    val likes = oneString
    val age   = oneInt
    val site  = one[Site] // Not intrinsic!
  }
  trait Site {
    val cat    = oneString
    val status = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.age.Site.cat
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name  = oneString
    val likes = oneString
    val age   = oneInt
    val site  = one[Site]
  }
  trait Site {
    val cat    = oneString
    val status = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.age .. ? .. Site.cat
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name  = oneString
    val likes = oneString
    val age   = oneInt
  }
  trait Site {
    val cat    = oneString
    val status = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;fredId.touch === Map( // Map[String, Any]
  &amp;quot;:db/id&amp;quot; -&amp;gt; 101L,
  &amp;quot;:person/name&amp;quot; -&amp;gt; &amp;quot;Fred&amp;quot;,
  &amp;quot;:person/likes&amp;quot; -&amp;gt; &amp;quot;pizza&amp;quot;,
  &amp;quot;:person/age&amp;quot;	-&amp;gt; 38,
  &amp;quot;:site/cat&amp;quot; -&amp;gt; &amp;quot;customer&amp;quot;
)

val siteCat_? : Option[String] = fredId[String](&amp;quot;:site/cat&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;fredId.touch === Map(
  &amp;quot;:db/id&amp;quot; -&amp;gt; 101L,
  &amp;quot;:person/name&amp;quot; -&amp;gt; &amp;quot;Fred&amp;quot;,
  &amp;quot;:person/likes&amp;quot; -&amp;gt; &amp;quot;pizza&amp;quot;,
  &amp;quot;:person/age&amp;quot;	-&amp;gt; 38,
  &amp;quot;:site/cat&amp;quot; -&amp;gt; &amp;quot;customer&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Order.orderid.LineItems * (
  LineItem.product.price.quantity.Comments * (
    Comment.text.descr.Authors * Person.name))).get === List(
      (23, List(
        (chocolateId, 48.00, 1, List(
          (&amp;quot;first&amp;quot;, &amp;quot;1a&amp;quot;, List(&amp;quot;Marc Grue&amp;quot;)),
          (&amp;quot;product&amp;quot;, &amp;quot;1b&amp;quot;, List(&amp;quot;Marc Grue&amp;quot;)))),
        (whiskyId, 38.00, 2, List(
          (&amp;quot;second&amp;quot;, &amp;quot;2b&amp;quot;, List(&amp;quot;Don Juan&amp;quot;, &amp;quot;Stuart Halloway&amp;quot;)),
          (&amp;quot;is&amp;quot;, &amp;quot;2b&amp;quot;, List(&amp;quot;Nick Smith&amp;quot;)),
          (&amp;quot;best&amp;quot;, &amp;quot;2c&amp;quot;, List(&amp;quot;test&amp;quot;))))
      ))
    )
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Touch entity facts hierarchy recursively
orderId.touch === Map(
  &amp;quot;:db/id&amp;quot; -&amp;gt; 101L,
  &amp;quot;:order/lineItems&amp;quot; -&amp;gt; List(
    Map(
      &amp;quot;:db/id&amp;quot; -&amp;gt; 102L, 
      &amp;quot;:lineItem/qty&amp;quot; -&amp;gt; 3, 
      &amp;quot;:lineItem/product&amp;quot; -&amp;gt; &amp;quot;Milk&amp;quot;,
      &amp;quot;:lineItem/price&amp;quot; -&amp;gt; 12.0),
    Map(
      &amp;quot;:db/id&amp;quot; -&amp;gt; 103L, 
      &amp;quot;:lineItem/qty&amp;quot; -&amp;gt; 2, 
      &amp;quot;:lineItem/product&amp;quot; -&amp;gt; &amp;quot;Coffee&amp;quot;,
      &amp;quot;:lineItem/price&amp;quot; -&amp;gt; 46.0)))

// Optional typed attribute value
fredId[String](&amp;quot;:person/likes&amp;quot;) === Some(&amp;quot;pizza&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Nested molecule
m(Order.id.Items * LineItem.qty.product.price).get === List(
  (1, List(
    (3, &amp;quot;Milk&amp;quot;, 12.0), 
    (2, &amp;quot;Coffee&amp;quot;, 46.0)))
)

// Entity api - .touch
101.touch === Map(
  &amp;quot;:db/id&amp;quot; -&amp;gt; 101L,
  &amp;quot;:order/lineItems&amp;quot; -&amp;gt; List(
    Map(
      &amp;quot;:db/id&amp;quot; -&amp;gt; 102L, 
      &amp;quot;:lineItem/qty&amp;quot; -&amp;gt; 3, 
      &amp;quot;:lineItem/product&amp;quot; -&amp;gt; &amp;quot;Milk&amp;quot;,
      &amp;quot;:lineItem/price&amp;quot; -&amp;gt; 12.0),
    Map(
      &amp;quot;:db/id&amp;quot; -&amp;gt; 103L, 
      &amp;quot;:lineItem/qty&amp;quot; -&amp;gt; 2, 
      &amp;quot;:lineItem/product&amp;quot; -&amp;gt; &amp;quot;Coffee&amp;quot;,
      &amp;quot;:lineItem/price&amp;quot; -&amp;gt; 46.0)))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Adjacent facts
Order.id.Items.qty.product.price.get === List(
  (1, 3, &amp;quot;Milk&amp;quot;, 12.0),
  (1, 2, &amp;quot;Coffee&amp;quot;, 46.0)
)

// Nested facts
m(Order.id.Items * LineItem.qty.product.price).get === List(
  (1, List(
    (3, &amp;quot;Milk&amp;quot;, 12.0), 
    (2, &amp;quot;Coffee&amp;quot;, 46.0)))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Adjacent facts
Order.id.Items.qty.product.price.get === List(
  (1, 3, &amp;quot;Milk&amp;quot;, 12.0),
  (1, 2, &amp;quot;Coffee&amp;quot;, 46.0)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object OrderDefinition {

  trait Order {
    val id    = oneInt
    val items = many[LineItem].subComponents
  }

  trait LineItem {
    val qty     = oneInt
    val product = oneString
    val price   = oneDouble
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object ProductsOrderDefinition {

  trait Order {
    val id    = oneInt
    val items = many[LineItem].subComponents
  }

  trait LineItem {
    val product = one[Product]
    val price   = oneDouble
    val qty     = oneInt
  }

  trait Product {
    val description = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Home.street.city. ..??
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name = oneString
    val age  = oneInt
    val home = one[Addr]
  }
  trait Addr {
    val street = oneString
    val city   = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name = oneString
    val age  = oneInt
    val home = one[Addr]
    val work = one[Addr]
  }
  trait Addr {
    val street = oneString
    val city   = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Home.street.city
Person.name.Work.street.city
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Home.street.city
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Home.street.city.get.head === (
  &amp;quot;Fred&amp;quot;, &amp;quot;Baker St. 7&amp;quot;, &amp;quot;Boston&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age(5 or 6 or 7).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
Person.name.age(5, 6, 7).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
Person.name.age(Seq(5, 6, 7)).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.age(min).get.head           === 5 
Person.age(max).get.head           === 38 
Person.age(sum).get.head           === 50 
Person.age(count).get.head         === 3 
Person.age(countDistinct).get.head === 3 
Person.age(avg).get.head           === 16.66666667
Person.age(median).get.head        === 7 
Person.age(variance).get.head      === 228.2222222222 
Person.age(stddev).get.head        === 15.107025591499
 
Person.age(distinct).get.head  === Vector(5, 7, 38) 
Person.age(min(2)).get.head    === Vector(5, 7) 
Person.age(max(2)).get.head    === Vector(38, 7) 
Person.age(rand(2)).get.head   === Stream(5, ?) 
Person.age(sample(2)).get.head === Vector(7, 38) 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.&amp;gt;(7).get === List(
  (&amp;quot;Fred&amp;quot;, 38)
)
Person.name.age.&amp;gt;=(7).get === List(
  (&amp;quot;Fred&amp;quot;, 38),
  (&amp;quot;Lisa&amp;quot;, 7)
)
Person.name.age.&amp;lt;(7).get === List(
  (&amp;quot;Ben&amp;quot;, 5)
)
Person.name.age.&amp;lt;=(7).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes_(nil).get === List(
  &amp;quot;Lisa&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.not(38).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
Person.name.age.!=(38).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Equality - exact matches only
Person.name(&amp;quot;Fred&amp;quot;).age.get === List()

Person.name(&amp;quot;Fred Ben&amp;quot;).age.get === List(
  (&amp;quot;Fred Ben&amp;quot;, 38)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.contains(&amp;quot;Ben&amp;quot;).get === List(
  &amp;quot;Fred Ben&amp;quot;, &amp;quot;Ben&amp;quot;
)

Person.name.contains(&amp;quot;Be&amp;quot;).get === List()
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age_(38).get === List(
  &amp;quot;Fred&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes_(&amp;quot;pizza&amp;quot;).get === List(
  &amp;quot;Fred&amp;quot;, &amp;quot;Ben&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes(&amp;quot;pizza&amp;quot;).get === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;),
  (&amp;quot;Ben&amp;quot;, &amp;quot;pizza&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.get === List(
  &amp;quot;Fred&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;Ben&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.get: Iterable[String] === List(
  &amp;quot;Fred&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;Ben&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.get: Iterable[(String, Int)] === List(
  (&amp;quot;Fred&amp;quot;, 38),
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes.get === List(
  (&amp;quot;Fred&amp;quot;, 38, &amp;quot;pizza&amp;quot;),
  (&amp;quot;Ben&amp;quot;, 5, &amp;quot;pizza&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;
</description>
    </item>
    
    <item>
      <title>Presentation</title>
      <link>http://localhost:1313/tutorials/presentation1/</link>
      <pubDate>Fri, 02 Jan 2015 22:06:44 CET</pubDate>
      
      <guid>http://localhost:1313/tutorials/presentation1/</guid>
      <description>

&lt;h1 id=&#34;molecule-presentation-sample-code-snippets:4de62b990e046bc5411eac36a57bd8c2&#34;&gt;Molecule presentation sample code snippets&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;fredId.retract

Person.name(&amp;quot;Fred&amp;quot;).get.size === 0 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.id.nameMap.one === (101, Map(
    &amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;,
    &amp;quot;de&amp;quot; -&amp;gt; &amp;quot;Dmitri Schostakowitsch&amp;quot;,
    &amp;quot;fr&amp;quot; -&amp;gt; &amp;quot;Dmitri Chostakovitch&amp;quot;
  ))
  
// By key
Person.nameMapK(&amp;quot;fr&amp;quot;).one === &amp;quot;Dmitri Chostakovitch&amp;quot;

// By value
Person.id.nameMap_(&amp;quot;Dmitri Chostakovitch&amp;quot;).one === 101
Person.id.nameMap_(&amp;quot;.*Shosta.*&amp;quot;).one === 101

// By key and value
Person.id.nameMap_(&amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;).one === 101
Person.id.nameMap_(&amp;quot;en&amp;quot;)(&amp;quot;.*Shosta.*&amp;quot;).one === 101
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.id.nameMap.one === (101, Map(
    &amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;,
    &amp;quot;de&amp;quot; -&amp;gt; &amp;quot;Dmitri Schostakowitsch&amp;quot;,
    &amp;quot;fr&amp;quot; -&amp;gt; &amp;quot;Dmitri Chostakovitch&amp;quot;
  ))
  
// By key
Person.nameMapK(&amp;quot;fr&amp;quot;).one === &amp;quot;Dmitri Chostakovitch&amp;quot;
Person.nameMapK(&amp;quot;fr|en&amp;quot;).one === &amp;quot;Dmitri Chostakovitch&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// In definition file
val nameMap = mapString
 
// Insert mapped data
Person.id.nameMap.insert(
  101,
  Map(
    &amp;quot;en&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakovich&amp;quot;,
    &amp;quot;de&amp;quot; -&amp;gt; &amp;quot;Dmitri Schostakowitsch&amp;quot;,
    &amp;quot;fr&amp;quot; -&amp;gt; &amp;quot;Dmitri Chostakovitch&amp;quot;,
    &amp;quot;es&amp;quot; -&amp;gt; &amp;quot;Dmitri Shostakóvich&amp;quot;
  )
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;fredId.retract

Person.name(&amp;quot;Fred&amp;quot;).get.size === 0 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(bob).hobbies.add(&amp;quot;stars&amp;quot;).update
Person(bob).hobbies.get.head === Set(&amp;quot;golf&amp;quot;, &amp;quot;cars&amp;quot;, &amp;quot;stars&amp;quot;)

Person(bob).hobbies.replace(&amp;quot;cars&amp;quot; -&amp;gt; &amp;quot;trains&amp;quot;).update
Person(bob).hobbies.get.head === Set(&amp;quot;golf&amp;quot;, &amp;quot;trains&amp;quot;, &amp;quot;stars&amp;quot;)

Person(bob).hobbies.remove(&amp;quot;golf&amp;quot;).update
Person(bob).hobbies.get.head === Set(&amp;quot;trains&amp;quot;, &amp;quot;stars&amp;quot;)

Person(bob).hobbies(&amp;quot;skiing&amp;quot;, &amp;quot;stamps&amp;quot;).update
Person(bob).hobbies.get.head === Set(&amp;quot;skiing&amp;quot;, &amp;quot;stamps&amp;quot;)

Person(bob).hobbies().update
Person(bob).hobbies.get.head === Set()
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Assert new fact
Person(fred).likes(&amp;quot;pasta&amp;quot;).update
Person(fred).likes$.get.head === Some(&amp;quot;pasta&amp;quot;)

// Retract old fact
Person(fred).likes().update
Person(fred).likes$.get.head === None
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Assert new fact
Person(fred).likes(&amp;quot;pasta&amp;quot;).update
Person(fred).likes$.get.head === Some(&amp;quot;pasta&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person(fred).likes(&amp;quot;pasta&amp;quot;).update
Person(fred).likes$.get.head === Some(&amp;quot;pasta&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Re-use insert molecules
val insertPerson = Person.name.likes$.age.insert
val fredId = insertPerson(&amp;quot;Fred&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 38).eid 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes$ insert List(
  (&amp;quot;Fred&amp;quot;, 38, Some(&amp;quot;pizza&amp;quot;)),
  (&amp;quot;Lisa&amp;quot;, 7, None),
  (&amp;quot;Ben&amp;quot;, 5, Some(&amp;quot;pizza&amp;quot;))
)

// Re-use insert-molecules
val insertPerson = Person.name.age.likes$.insert
val fred = insertPerson(&amp;quot;Fred&amp;quot;, 38, Some(&amp;quot;pizza&amp;quot;)).eid
val ben  = insertPerson(&amp;quot;Lisa&amp;quot;, 7, None).eid
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes$.age insert List(
  (&amp;quot;Fred&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 38),
  (&amp;quot;Lisa&amp;quot;, None, 7),
  (&amp;quot;Ben&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person
  .name(&amp;quot;Fred&amp;quot;)
  .age(38)
  .likes(&amp;quot;pizza&amp;quot;).save
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes$.get === List(
  (&amp;quot;Fred&amp;quot;, 38, Some(&amp;quot;pizza&amp;quot;)),
  (&amp;quot;Lisa&amp;quot;, 7, None),
  (&amp;quot;Ben&amp;quot;, 5, Some(&amp;quot;pizza&amp;quot;))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes$ insert List(
  (&amp;quot;Fred&amp;quot;, 38, Some(&amp;quot;pizza&amp;quot;)),
  (&amp;quot;Lisa&amp;quot;, 7, None),
  (&amp;quot;Ben&amp;quot;, 5, Some(&amp;quot;pizza&amp;quot;))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Save 1 molecule
Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;).age(38).save

// Insert
Person.name.likes$.age insert List(
  (&amp;quot;Fred&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 38),
  (&amp;quot;Lisa&amp;quot;, None, 7),
  (&amp;quot;Ben&amp;quot;, Some(&amp;quot;pizza&amp;quot;), 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name(&amp;quot;Fred&amp;quot;).likes(&amp;quot;pizza&amp;quot;).age(38).save
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Person.name.likes.age ~ Site.cat.status ~ Loc.tag).get === List(
  ((&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, 38), (&amp;quot;customer&amp;quot;, &amp;quot;good&amp;quot;), &amp;quot;city&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Person.name.likes.age ~ Site.cat.status).get === List(
  ((&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, 38), (&amp;quot;customer&amp;quot;, &amp;quot;good&amp;quot;))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Person.name.likes.age ~ Site.cat).get === List(
  ((&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, 38), &amp;quot;customer&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Person.name.likes.age ~ Site.cat).get === List(
  ((&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, 38), &amp;quot;customer&amp;quot;)
)

val ((name, likes, age), cat) = m(Person.name.likes.age ~ Site.cat).get.head
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.age ~ Site.cat
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name  = oneString
    val likes = oneString
    val age   = oneInt
  }
  trait Site {
    val cat    = oneString
    val status = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.age.Site.cat
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name  = oneString
    val likes = oneString
    val age   = oneInt
    val site  = one[Site] // Not intrinsic!
  }
  trait Site {
    val cat    = oneString
    val status = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.age.Site.cat
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name  = oneString
    val likes = oneString
    val age   = oneInt
    val site  = one[Site]
  }
  trait Site {
    val cat    = oneString
    val status = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes.age .. ? .. Site.cat
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name  = oneString
    val likes = oneString
    val age   = oneInt
  }
  trait Site {
    val cat    = oneString
    val status = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;fredId.touch === Map( // Map[String, Any]
  &amp;quot;:db/id&amp;quot; -&amp;gt; 101L,
  &amp;quot;:person/name&amp;quot; -&amp;gt; &amp;quot;Fred&amp;quot;,
  &amp;quot;:person/likes&amp;quot; -&amp;gt; &amp;quot;pizza&amp;quot;,
  &amp;quot;:person/age&amp;quot;	-&amp;gt; 38,
  &amp;quot;:site/cat&amp;quot; -&amp;gt; &amp;quot;customer&amp;quot;
)

val siteCat_? : Option[String] = fredId[String](&amp;quot;:site/cat&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;fredId.touch === Map(
  &amp;quot;:db/id&amp;quot; -&amp;gt; 101L,
  &amp;quot;:person/name&amp;quot; -&amp;gt; &amp;quot;Fred&amp;quot;,
  &amp;quot;:person/likes&amp;quot; -&amp;gt; &amp;quot;pizza&amp;quot;,
  &amp;quot;:person/age&amp;quot;	-&amp;gt; 38,
  &amp;quot;:site/cat&amp;quot; -&amp;gt; &amp;quot;customer&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Order.orderid.LineItems * (
  LineItem.product.price.quantity.Comments * (
    Comment.text.descr.Authors * Person.name))).get === List(
      (23, List(
        (chocolateId, 48.00, 1, List(
          (&amp;quot;first&amp;quot;, &amp;quot;1a&amp;quot;, List(&amp;quot;Marc Grue&amp;quot;)),
          (&amp;quot;product&amp;quot;, &amp;quot;1b&amp;quot;, List(&amp;quot;Marc Grue&amp;quot;)))),
        (whiskyId, 38.00, 2, List(
          (&amp;quot;second&amp;quot;, &amp;quot;2b&amp;quot;, List(&amp;quot;Don Juan&amp;quot;, &amp;quot;Stuart Halloway&amp;quot;)),
          (&amp;quot;is&amp;quot;, &amp;quot;2b&amp;quot;, List(&amp;quot;Nick Smith&amp;quot;)),
          (&amp;quot;best&amp;quot;, &amp;quot;2c&amp;quot;, List(&amp;quot;test&amp;quot;))))
      ))
    )
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Touch entity facts hierarchy recursively
orderId.touch === Map(
  &amp;quot;:db/id&amp;quot; -&amp;gt; 101L,
  &amp;quot;:order/lineItems&amp;quot; -&amp;gt; List(
    Map(
      &amp;quot;:db/id&amp;quot; -&amp;gt; 102L, 
      &amp;quot;:lineItem/qty&amp;quot; -&amp;gt; 3, 
      &amp;quot;:lineItem/product&amp;quot; -&amp;gt; &amp;quot;Milk&amp;quot;,
      &amp;quot;:lineItem/price&amp;quot; -&amp;gt; 12.0),
    Map(
      &amp;quot;:db/id&amp;quot; -&amp;gt; 103L, 
      &amp;quot;:lineItem/qty&amp;quot; -&amp;gt; 2, 
      &amp;quot;:lineItem/product&amp;quot; -&amp;gt; &amp;quot;Coffee&amp;quot;,
      &amp;quot;:lineItem/price&amp;quot; -&amp;gt; 46.0)))

// Optional typed attribute value
fredId[String](&amp;quot;:person/likes&amp;quot;) === Some(&amp;quot;pizza&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Nested molecule
m(Order.id.Items * LineItem.qty.product.price).get === List(
  (1, List(
    (3, &amp;quot;Milk&amp;quot;, 12.0), 
    (2, &amp;quot;Coffee&amp;quot;, 46.0)))
)

// Entity api - .touch
101.touch === Map(
  &amp;quot;:db/id&amp;quot; -&amp;gt; 101L,
  &amp;quot;:order/lineItems&amp;quot; -&amp;gt; List(
    Map(
      &amp;quot;:db/id&amp;quot; -&amp;gt; 102L, 
      &amp;quot;:lineItem/qty&amp;quot; -&amp;gt; 3, 
      &amp;quot;:lineItem/product&amp;quot; -&amp;gt; &amp;quot;Milk&amp;quot;,
      &amp;quot;:lineItem/price&amp;quot; -&amp;gt; 12.0),
    Map(
      &amp;quot;:db/id&amp;quot; -&amp;gt; 103L, 
      &amp;quot;:lineItem/qty&amp;quot; -&amp;gt; 2, 
      &amp;quot;:lineItem/product&amp;quot; -&amp;gt; &amp;quot;Coffee&amp;quot;,
      &amp;quot;:lineItem/price&amp;quot; -&amp;gt; 46.0)))
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Adjacent facts
Order.id.Items.qty.product.price.get === List(
  (1, 3, &amp;quot;Milk&amp;quot;, 12.0),
  (1, 2, &amp;quot;Coffee&amp;quot;, 46.0)
)

// Nested facts
m(Order.id.Items * LineItem.qty.product.price).get === List(
  (1, List(
    (3, &amp;quot;Milk&amp;quot;, 12.0), 
    (2, &amp;quot;Coffee&amp;quot;, 46.0)))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Adjacent facts
Order.id.Items.qty.product.price.get === List(
  (1, 3, &amp;quot;Milk&amp;quot;, 12.0),
  (1, 2, &amp;quot;Coffee&amp;quot;, 46.0)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object OrderDefinition {

  trait Order {
    val id    = oneInt
    val items = many[LineItem].subComponents
  }

  trait LineItem {
    val qty     = oneInt
    val product = oneString
    val price   = oneDouble
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object ProductsOrderDefinition {

  trait Order {
    val id    = oneInt
    val items = many[LineItem].subComponents
  }

  trait LineItem {
    val product = one[Product]
    val price   = oneDouble
    val qty     = oneInt
  }

  trait Product {
    val description = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name
  .Home.street.city._Person
  .Work.street.city.one === (
  &amp;quot;Fred&amp;quot;, 
  &amp;quot;Baker st. 7&amp;quot;, &amp;quot;Boston&amp;quot;, 
  &amp;quot;Downtown 1&amp;quot;, &amp;quot;Boston&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name
  .Home.street.city._Person
  .Cottage.street.city._Person
  .Work.street.city.one === (
  &amp;quot;Fred&amp;quot;, 
  &amp;quot;Baker st. 7&amp;quot;, &amp;quot;Boston&amp;quot;, 
  &amp;quot;Mountain way 32&amp;quot;, &amp;quot;Woods town&amp;quot;, 
  &amp;quot;Downtown 1&amp;quot;, &amp;quot;Boston&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Home.street.city. ..??
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name = oneString
    val age  = oneInt
    val home = one[Addr]
  }
  trait Addr {
    val street = oneString
    val city   = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name = oneString
    val age  = oneInt
    val home = one[Addr]
    val work = one[Addr]
  }
  trait Addr {
    val street = oneString
    val city   = oneString
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Home.street.city
Person.name.Work.street.city
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Home.street.city
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.Home.street.city.one === (
  &amp;quot;Fred&amp;quot;, &amp;quot;Baker St. 7&amp;quot;, &amp;quot;Boston&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age(5 or 6 or 7).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
Person.name.age(5, 6, 7).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
Person.name.age(Seq(5, 6, 7)).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.age(min).one           === 5 
Person.age(max).one           === 38 
Person.age(sum).one           === 50 
Person.age(count).one         === 3 
Person.age(countDistinct).one === 3 
Person.age(avg).one           === 16.66666667
Person.age(median).one        === 7 
Person.age(variance).one      === 228.2222222222222 
Person.age(stddev).one        === 15.107025591499546
 
Person.age(distinct).one  === Vector(5, 7, 38) 
Person.age(min(2)).one    === Vector(5, 7) 
Person.age(max(2)).one    === Vector(38, 7) 
Person.age(rand(2)).one   === Stream(5, ?) 
Person.age(sample(2)).one === Vector(7, 38) 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.&amp;gt;(7).get === List(
  (&amp;quot;Fred&amp;quot;, 38)
)
Person.name.age.&amp;gt;=(7).get === List(
  (&amp;quot;Fred&amp;quot;, 38),
  (&amp;quot;Lisa&amp;quot;, 7)
)
Person.name.age.&amp;lt;(7).get === List(
  (&amp;quot;Ben&amp;quot;, 5)
)
Person.name.age.&amp;lt;=(7).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes_(nil).get === List(
  &amp;quot;Lisa&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.not(38).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
Person.name.age.!=(38).get === List(
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Equality - exact matches only
Person.name(&amp;quot;Fred&amp;quot;).age.get === List()

Person.name(&amp;quot;Fred Ben&amp;quot;).age.get === List(
  (&amp;quot;Fred Ben&amp;quot;, 38)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.contains(&amp;quot;Ben&amp;quot;).get === List(
  &amp;quot;Fred Ben&amp;quot;, &amp;quot;Ben&amp;quot;
)

Person.name.contains(&amp;quot;Be&amp;quot;).get === List()
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age_(38).get === List(
  &amp;quot;Fred&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes_(&amp;quot;pizza&amp;quot;).get === List(
  &amp;quot;Fred&amp;quot;, &amp;quot;Ben&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.likes(&amp;quot;pizza&amp;quot;).get === List(
  (&amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;),
  (&amp;quot;Ben&amp;quot;, &amp;quot;pizza&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.get === List(
  &amp;quot;Fred&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;Ben&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.get: Iterable[String] === List(
  &amp;quot;Fred&amp;quot;, &amp;quot;Lisa&amp;quot;, &amp;quot;Ben&amp;quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.get: Iterable[(String, Int)] === List(
  (&amp;quot;Fred&amp;quot;, 38),
  (&amp;quot;Lisa&amp;quot;, 7),
  (&amp;quot;Ben&amp;quot;, 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes.get === List(
  (&amp;quot;Fred&amp;quot;, 38, &amp;quot;pizza&amp;quot;),
  (&amp;quot;Ben&amp;quot;, 5, &amp;quot;pizza&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes_.get === List(
  (&amp;quot;Fred&amp;quot;, 38),
  (&amp;quot;Ben&amp;quot;, 5)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.likes$.get === List(
  (&amp;quot;Fred&amp;quot;, 38, Some(&amp;quot;pizza&amp;quot;)),
  (&amp;quot;Lisa&amp;quot;, 7, None),
  (&amp;quot;Ben&amp;quot;, 5, Some(&amp;quot;pizza&amp;quot;))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.e(101).name.likes.age.get === List(
  (101, &amp;quot;Fred&amp;quot;, &amp;quot;pizza&amp;quot;, 38)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val persons: Iterable[(String, Option[String])] = Person.name.age_.likes$.get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name(&amp;quot;Fred&amp;quot;).age(39).saveD
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age.updateD
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age extends M2[String, Int]
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object oneString
object oneInt
...
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;object YourDomainDefinition {
  trait Person {
    val name = oneString
    val age  = oneInt
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;trait M1[A] {
  def get: Iterable[A] = ???
}
trait M2[A, B] {
  def get: Iterable[(A, B)] = ???
}

object Person {
  val name : Person1[String] = ???
  val age  : Person1[Int]    = ???
}
class Person1[A] extends M1[A] {
  val name : Person2[A, String] = ???
  val age  : Person2[A, Int]    = ???
}
class Person2[A, B] extends M2[A, B]
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;implicit def m[A, B](dsl: M2[A, B]): Molecule2[String, Int] = macro from2attr[A, B]
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;implicit def m[A, B](dsl: M2[A, B]): Molecule2[A, B] = macro from2attr[A, B]

// Macro implementation (simplified)
def from2attr[A, B](dsl: M2[A, B]): Molecule2[A, B] = {
  val query = ??? // todo
  q&amp;quot;&amp;quot;&amp;quot;
    new Molecule2[A, B] {
      def get: Iterable[(A, B)] = datomic.Peer.q(${query}, conn.db).asScala.map(
        _.asScala match {
          case Iterable(a, b) =&amp;gt; (a.asInstanceOf[A], b.asInstanceOf[B])
        }
      )
    }
  &amp;quot;&amp;quot;&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// Macro implementation (simplified)
def from2attr[A, B](dsl: M2[A, B]): Molecule2[A, B] = {

  def traverse(dsl: Tree, elements: Seq[Attr] = Nil): Seq[Attr] = dsl match {
    case q&amp;quot;$prev.$attr&amp;quot; =&amp;gt; traverse(prev) :+ Attr(attr.ns, attr.name, attr.tpe, attr.card)
    case q&amp;quot;$ns&amp;quot;         =&amp;gt; elements
  }
  val query = traverse(dsl.tree).toQueryString
  
  q&amp;quot;&amp;quot;&amp;quot;
    new Molecule2[A, B] {
      def get: Iterable[(A, B)] = datomic.Peer.q(${query}, conn.db).asScala.map(
        _.asScala match {
          case Seq(a, b) =&amp;gt; (a.asInstanceOf[A], b.asInstanceOf[B])
        }
      )
    }
  &amp;quot;&amp;quot;&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;1-output-molecule-saved:4de62b990e046bc5411eac36a57bd8c2&#34;&gt;1 ## output.Molecule.saveD&lt;/h2&gt;

&lt;p&gt;========================================================================
Model(
  Atom(person,name,String,1,Eq(List(Fred)),None,List(),List())&lt;/p&gt;

&lt;h2 id=&#34;atom-person-age-long-1-eq-list-39-none-list-list:4de62b990e046bc5411eac36a57bd8c2&#34;&gt;Atom(person,age,Long,1,Eq(List(39)),None,List(),List()))&lt;/h2&gt;

&lt;p&gt;List(
  :db/add   &amp;lsquo;tempId                          :person/name    Values(Eq(List(Fred)),None)&lt;/p&gt;

&lt;h2 id=&#34;db-add-e-person-age-values-eq-list-39-none:4de62b990e046bc5411eac36a57bd8c2&#34;&gt;:db/add   &amp;lsquo;e                               :person/age     Values(Eq(List(39)),None))&lt;/h2&gt;

&lt;p&gt;List(
  :db/add   #db/id[:db.part/user -1000008]   :person/name    Fred&lt;/p&gt;

&lt;h1 id=&#34;db-add-db-id-db-part-user-1000008-person-age-39:4de62b990e046bc5411eac36a57bd8c2&#34;&gt;:db/add   #db/id[:db.part/user -1000008]   :person/age     39)&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;implicit def m[A, B](dsl: M2[A, B]): Molecule2[A, B] = 
  macro from2attr[A, B]

def from2attr[A: c.WeakTypeTag, B: c.WeakTypeTag]
    (c: Context)
    (dsl: c.Expr[M2[A, B]])
: c.Expr[Molecule2[A, B]] = {
  import c.universe._
  c.Expr(
    q&amp;quot;&amp;quot;&amp;quot;
      new Molecule2[${c.weakTypeOf[A]}, ${c.weakTypeOf[B]}] {
        def get = ??? // query + casting...
      }
    &amp;quot;&amp;quot;&amp;quot;
  )
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;implicit def m[A, B](dsl: M2[A, B]): Molecule2[A, B] = macro from2attr[A, B]
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;implicit def m[A, B](dsl: M2[A, B]): Molecule2[A, B] = macro from2attr[A, B]

def from2attr[A: c.WeakTypeTag, B: c.WeakTypeTag]
    (c: Context)
    (dsl: c.Expr[M2[A, B]])
: c.Expr[Molecule2[A, B]] = {
  val query = ???
  c.Expr(
    q&amp;quot;&amp;quot;&amp;quot;
      new Molecule2[${c.weakTypeOf[A]}, ${c.weakTypeOf[B]}] {
        def get = datomic.Peer.q(${query}, conn.db).asScala.map( _.asScala match {
            case Seq(a, b) =&amp;gt;
              (a.asInstanceOf[${c.weakTypeOf[A]}], b.asInstanceOf[${c.weakTypeOf[B]}])
          }
        )
      }
    &amp;quot;&amp;quot;&amp;quot;
  )
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Person.name.age
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val persons = Person.name.age.get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val persons = datomic.Peer.q(
  &amp;quot;&amp;quot;&amp;quot;
    |[:find ?name ?age
    | :where
    |   [?e :person/name ?name]
    |   [?e :person/age ?age]]
  &amp;quot;&amp;quot;&amp;quot;.stripMargin, conn.db)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val persons: Iterable[(String, Int)] = Person.name.age.get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val persons: java.util.Collection[java.util.List[Object]] = datomic.Peer.q(
  &amp;quot;&amp;quot;&amp;quot;
    |[:find ?name ?age
    | :where
    |   [?e :person/name ?name]
    |   [?e :person/age ?age]]
  &amp;quot;&amp;quot;&amp;quot;.stripMargin, conn.db)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val persons: Iterable[(String, Int)] = datomic.Peer.q(
  &amp;quot;&amp;quot;&amp;quot;
    |[:find ?name ?age
    | :where
    |   [?e :person/name ?name]
    |   [?e :person/age ?age]]
  &amp;quot;&amp;quot;&amp;quot;.stripMargin, conn.db
).asScala.map(_.asScala match {
    case Seq(name, age) =&amp;gt;
      (name.asInstanceOf[String], age.asInstanceOf[Long].toInt)
  }
)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val personsMolecule: Molecule2[String, Int] = m(Person.name.age)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;new Molecule2[String, Int] {
  def get: Iterable[(String, Int)] = datomic.Peer.q(
    &amp;quot;&amp;quot;&amp;quot;
      |[:find ?name ?age
      | :where
      |   [?e :person/name ?name]
      |   [?e :person/age ?age]]
    &amp;quot;&amp;quot;&amp;quot;.stripMargin, conn.db
  ).asScala.map( _.asScala match {
    case Seq(name, age) =&amp;gt; 
      (name.asInstanceOf[String], age.asInstanceOf[Long].toInt)
    }
  )
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val personM: Molecule2[String, Int] = m(Person.name.age)
val persons: Iterable[(String, Int)] = personM.get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// compile-time
val personMolecule: Molecule2[String, Int] = m(Person.name.age)

// runtime
val persons: Iterable[(String, Int)] = personMolecule.get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;implicit def m[A, B](dsl: M2[A, B]) = macro MakeMolecule.from2attr[A, B]

// compile-time
val personMolecule: Molecule2[String, Int] = m(Person.name.age)

// runtime
val persons: Iterable[(String, Int)] = personMolecule.get

// compile-time + runtime
val persons: Iterable[(String, Int)] = Person.name.age.get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// implicit def macro
implicit def m[A, B](dsl: M2[A, B]) = macro MakeMolecule.from2attr[A, B]

// compile-time + runtime
val persons: Iterable[(String, Int)] = Person.name.age.get
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// implicit def macro
implicit def m[A, B](dsl: M2[A, B]): Molecule2[String, Int] = macro from2attr[A, B]

// compile-time
val personMolecule: Molecule2[String, Int] = m(Person.name.age)

// runtime
val persons: Iterable[(String, Int)] = personMolecule.get

// compile-time + runtime
val persons: Iterable[(String, Int)] = Person.name.age.get
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;
</description>
    </item>
    
    <item>
      <title>Tutorials</title>
      <link>http://localhost:1313/tutorials/overview/</link>
      <pubDate>Fri, 02 Jan 2015 22:06:44 CET</pubDate>
      
      <guid>http://localhost:1313/tutorials/overview/</guid>
      <description>

&lt;h1 id=&#34;molecule-tutorials:68f80267fa3a50980dbb745a782b8dca&#34;&gt;Molecule tutorials&lt;/h1&gt;

&lt;p&gt;As we see more tutorials on Molecule we&amp;rsquo;ll collect them here:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle&#34;&gt;Seattle tutorial&lt;/a&gt; - all-round introduction to using Molecule:

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle/#0:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Basic introduction to Molecule&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle/#1:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Queries with attributes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle/#4:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Relationships across references&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle/#5:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Parameterized molecules for caching queries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle/#6:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Functions and fulltext search in queries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle/#8:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Querying with rules - logical OR&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle/#9:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Working with time&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle/#10:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Inserting data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/tutorials/seattle/#11:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Updating/deleting data&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Wish-list for cookbook recipees (in random order):&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Transaction management - saving meta data with your transactions&lt;/li&gt;
&lt;li&gt;Schema queries - what do we use them for?&lt;/li&gt;
&lt;li&gt;Pagination - how do we retrive paginated result sets?&lt;/li&gt;
&lt;li&gt;Authorization - roles and groups&lt;/li&gt;
&lt;li&gt;Recursive queries - examples and uses&lt;/li&gt;
&lt;li&gt;more&amp;hellip;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Seattle</title>
      <link>http://localhost:1313/tutorials/seattle/</link>
      <pubDate>Fri, 02 Jan 2015 22:06:44 CET</pubDate>
      
      <guid>http://localhost:1313/tutorials/seattle/</guid>
      <description>

&lt;h1 id=&#34;contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Molecule Seattle tutorial&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#1:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;A first query&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Querying &lt;em&gt;for&lt;/em&gt; an attribute&amp;rsquo;s value&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Querying &lt;em&gt;by&lt;/em&gt; attribute values&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Querying across references&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#5:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Parameterizing queries - input molecules&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#6:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Invoking functions in queries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#7:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Querying with fulltext search&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#8:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Querying with rules - logical OR&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#9:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Working with time&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#10:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Insert data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#11:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Update and/or delete data&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Credits: This tutorial is based on the original
&lt;a href=&#34;http://docs.datomic.com/tutorial.html&#34;&gt;Datomic Seattle tutorial&lt;/a&gt; and some text
passages have been quoted as-is or been slightly modified to describe
how Molecule works.&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&#34;0:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Introduction&lt;/h2&gt;

&lt;p&gt;After &lt;a href=&#34;http://localhost:1313/manual/setup&#34;&gt;setting up the database&lt;/a&gt; and &lt;a href=&#34;http://localhost:1313/manual/populate-database&#34;&gt;populating it with data&lt;/a&gt; we can
start making queries. We make queries by building &amp;ldquo;molecules&amp;rdquo; which are
chains of attributes put together with the builder pattern. We can imagine
this as a 3-dimensional data structure of atoms bound together in various
patterns to build molecules&amp;hellip;&lt;/p&gt;

&lt;h3 id=&#34;molecule-builder-pattern:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Molecule builder pattern&lt;/h3&gt;

&lt;p&gt;The first thing you do with Molecule is to define your domain namespaces and attributes in a
trait that defines namespaces with attributes for your domain:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;trait Community {
  val name = oneString.fullTextSearch
  val url  = oneString
  ...
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;name&lt;/code&gt; field defines an attribute of type String with cardinality one. Adding the
&lt;code&gt;fullTextSearch&lt;/code&gt; option will tell Datomic that we want to be able to make fulltext
searches on the values of this attribute.&lt;/p&gt;

&lt;p&gt;After defining the schema like this, we run &lt;code&gt;sbt compile&lt;/code&gt; and Molecule will generate some
boilerplate traits that allow us to build molecules of our attributes:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val nameUrls = m(Community.name.url).get
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Since the &lt;code&gt;m&lt;/code&gt; method is implicit we can generally just write&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val nameUrls = Community.name.url.get
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you look at the generated namespace code you&amp;rsquo;ll see that it is a
little more complex behind the scenes. That&amp;rsquo;s because we want our IDE
to be able to infer the type of each attribute. If we for instance had
an &lt;code&gt;age&lt;/code&gt; attribute of type &lt;code&gt;Int&lt;/code&gt; we could infer the return types of
calling the &lt;code&gt;get&lt;/code&gt; method on a molecule. That would return
a List of name/age tuples of type &lt;code&gt;Seq[(String, Int)]&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val nameAges: Seq[(String, Int)] = Community.name.age.get
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;A feature of Molecule is to omit the values of an attribute from the result set
by adding an underscore to the attribute name:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val names: Seq[String] = Community.name.age_.get
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is handy if we want to query for entities that we want to be sure have an age and
where we at the same time don&amp;rsquo;t need the age returned.&lt;/p&gt;

&lt;p&gt;Now let&amp;rsquo;s follow along the
&lt;a href=&#34;http://docs.datomic.com/tutorial.html&#34;&gt;Datomic Seattle tutorial&lt;/a&gt; and
see how Molecule can perform the same queries.&lt;/p&gt;

&lt;h2 id=&#34;1:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; A first query&lt;/h2&gt;

&lt;p&gt;To find communities we can make a &lt;code&gt;communities&lt;/code&gt; molecule looking for entities with Community name:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val communities = m(Community.name)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;With this molecule at hand we can get the community names:
Or we can ask for the size of our returned data set:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;communities.get === // List of community names...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;or we could check how many communities we have&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;communities.get.size === 150
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If we want the entity ids of our communities we can add the generic attribute &lt;code&gt;e&lt;/code&gt; to our molecule.
We might not be interested in the names but we want to make sure that we find entities having a name,
so we add the &lt;code&gt;name&lt;/code&gt; attribute with an underscore (to omit it from the result set):&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.e.name_.get(3) === List(17592186045518L, 17592186045516L, 17592186045514L)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;contents-3d29aefa7257f22b89227d9f373cd5f9-getting-an-entity-s-attribute-values:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Getting an entity&amp;rsquo;s attribute values&lt;/h2&gt;

&lt;p&gt;A way to get additional attribute values once we have an entity id is to &lt;code&gt;touch&lt;/code&gt; it:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val communityId = Community.e.name_.get.head

// Use the community id to touch all the entity&#39;s attribute values
communityId.touch === Map(
  &amp;quot;:community/type&amp;quot; -&amp;gt; &amp;quot;:community.type/website&amp;quot;,
  &amp;quot;:community/url&amp;quot; -&amp;gt; &amp;quot;http://www.greenlakecommunitycouncil.org/&amp;quot;,
  &amp;quot;:community/category&amp;quot; -&amp;gt; List(&amp;quot;community council&amp;quot;),
  &amp;quot;:community/orgtype&amp;quot; -&amp;gt; &amp;quot;:community.orgtype/community&amp;quot;,
  &amp;quot;:db/id&amp;quot; -&amp;gt; 17592186045665L,
  &amp;quot;:community/name&amp;quot; -&amp;gt; &amp;quot;Greenlake Community Council&amp;quot;,
  &amp;quot;:community/neighborhood&amp;quot; -&amp;gt; Map(
    &amp;quot;:db/id&amp;quot; -&amp;gt; 17592186045666L,
    &amp;quot;:neighborhood/district&amp;quot; -&amp;gt; Map(
      &amp;quot;:db/id&amp;quot; -&amp;gt; 17592186045667L,
      &amp;quot;:district/name&amp;quot; -&amp;gt; &amp;quot;Northwest&amp;quot;,
      &amp;quot;:district/region&amp;quot; -&amp;gt; &amp;quot;:district.region/sw&amp;quot;),
    &amp;quot;:neighborhood/name&amp;quot; -&amp;gt; &amp;quot;Green Lake&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can also retrive attribute values one by one by simply applying an attribute name to the entity id:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;communityId(&amp;quot;:community/name&amp;quot;) === Some(&amp;quot;Greenlake Community Council&amp;quot;)
communityId(&amp;quot;:community/url&amp;quot;) === Some(&amp;quot;http://www.greenlakecommunitycouncil.org/&amp;quot;)
communityId(&amp;quot;:community/category&amp;quot;) === Some(Set(&amp;quot;community council&amp;quot;))
communityId(&amp;quot;:community/emptyOrBogusAttribute&amp;quot;) === None
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;2:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Querying &lt;em&gt;for&lt;/em&gt; an attribute&amp;rsquo;s value&lt;/h2&gt;

&lt;p&gt;After defining a molecule like &lt;code&gt;Community.name&lt;/code&gt; we can call the &lt;code&gt;get&lt;/code&gt;
method on it to retrieve values that matches it. When there&amp;rsquo;s only one
attribute defined in the molecule we&amp;rsquo;ll get a list of this attribute&amp;rsquo;s
value back.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.get(3) === List(
  &amp;quot;KOMO Communities - Ballard&amp;quot;,
  &amp;quot;Ballard Blog&amp;quot;,
  &amp;quot;Ballard Historical Society&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If our molecule defines two or more attributes we&amp;rsquo;ll get tuples of
values back.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.url.get(3) === List(
  (&amp;quot;Broadview Community Council&amp;quot;, &amp;quot;http://groups.google.com/group/broadview-community-council&amp;quot;),
  (&amp;quot;KOMO Communities - Wallingford&amp;quot;, &amp;quot;http://wallingford.komonews.com&amp;quot;),
  (&amp;quot;Aurora Seattle&amp;quot;, &amp;quot;http://www.auroraseattle.com/&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;3:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Querying &lt;em&gt;by&lt;/em&gt; attribute values&lt;/h2&gt;

&lt;p&gt;When applying a value to an attribute we narrow the selection of
entities that will match our molecule data structure. Let&amp;rsquo;s find communities
of type &amp;ldquo;twitter&amp;rdquo;:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.`type`(&amp;quot;twitter&amp;quot;).get(3) === List(
  (&amp;quot;Columbia Citizens&amp;quot;, &amp;quot;twitter&amp;quot;),
  (&amp;quot;Discover SLU&amp;quot;, &amp;quot;twitter&amp;quot;),
  (&amp;quot;Fremont Universe&amp;quot;, &amp;quot;twitter&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(We use the back-ticks to avoid having Scala to think of &lt;code&gt;type&lt;/code&gt;
as a Scala keyword)&lt;/p&gt;

&lt;p&gt;Since the &lt;code&gt;type&lt;/code&gt; will always be &amp;ldquo;twitter&amp;rdquo; we could omit it from the result set
by adding an underscore to the &lt;code&gt;type&lt;/code&gt; attribute (and we don&amp;rsquo;t need the back-ticks anymore).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.type_(&amp;quot;twitter&amp;quot;).get(3) === List(
  &amp;quot;Magnolia Voice&amp;quot;, &amp;quot;Columbia Citizens&amp;quot;, &amp;quot;Discover SLU&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notice that we get some different communities. We are not guaranteed a specific order
of returned values and the first 3 values can therefore vary as we see here even though
the molecules/queries are similar.&lt;/p&gt;

&lt;p&gt;In most of our examples we supply static data like &amp;ldquo;twitter&amp;rdquo; but even
though our molecules are created at compile time we can even supply
data as variables like we would do with user input from forms etc.
So we could as well write the following and get the same result.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val tw = &amp;quot;twitter&amp;quot;
Community.name.type_(tw).get(3) === List(
  &amp;quot;Magnolia Voice&amp;quot;, &amp;quot;Columbia Citizens&amp;quot;, &amp;quot;Discover SLU&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Retrieving values of many-attributes like &lt;code&gt;category&lt;/code&gt; gives us sets
of values back&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name_(&amp;quot;belltown&amp;quot;).category.one === Set(&amp;quot;events&amp;quot;, &amp;quot;news&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Since we often want a single result back, Molecule supplies a &lt;code&gt;one&lt;/code&gt; convenience method that calls &lt;code&gt;get.head&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;We can apply multiple values to many-attributes like &lt;code&gt;category&lt;/code&gt; and
it will match entities having any of those values (OR-semantics).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.category_(&amp;quot;news&amp;quot;, &amp;quot;arts&amp;quot;).get(3) === List(
  &amp;quot;Beach Drive Blog&amp;quot;,
  &amp;quot;KOMO Communities - Ballard&amp;quot;,
  &amp;quot;Ballard Blog&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;4:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Querying across references&lt;/h2&gt;

&lt;p&gt;The sample data model includes three main entity types communities,
neighborhoods and districts that are related to each other with references.
Molecule lets you traverse those references by going from one namespace
to the next. Let&amp;rsquo;s find communities in the noth-eastern region:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.Neighborhood.District.region_(&amp;quot;ne&amp;quot;).get(3) === List(
  &amp;quot;Maple Leaf Community Council&amp;quot;,
  &amp;quot;Hawthorne Hills Community Website&amp;quot;,
  &amp;quot;KOMO Communities - View Ridge&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Or comunity names and their region:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.Neighborhood.District.region.get(3) === List(
  (&amp;quot;KOMO Communities - North Seattle&amp;quot;,&amp;quot;n&amp;quot;),
  (&amp;quot;Morgan Junction Community Association&amp;quot;,&amp;quot;sw&amp;quot;),
  (&amp;quot;Friends of Seward Park&amp;quot;,&amp;quot;se&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;5:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Parameterizing queries - input molecules&lt;/h2&gt;

&lt;p&gt;When you apply values to molecules, the resulting query
string is cached by Datomic. If you keep varying the string content,
the cache is not effective. To take advantage of query caching it is
recommended to make parameterized queries that can be cached once and
used with varying input parameters.&lt;/p&gt;

&lt;h3 id=&#34;single-input-value-for-an-attribute:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Single input value for an attribute&lt;/h3&gt;

&lt;p&gt;Instead of applying the constant value &amp;ldquo;twitter&amp;rdquo; to a molecule
&lt;code&gt;Community.type(&amp;quot;twitter&amp;quot;)&lt;/code&gt; we can use the &lt;code&gt;?&lt;/code&gt; input placeholder
in an &amp;ldquo;input molecule&amp;rdquo; telling us that it waits for an input value.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val communitiesOfType = m(Community.name.type_(?))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When can then apply different input values to our input molecule:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val twitterCommunities = communitiesOfType(&amp;quot;twitter&amp;quot;)
val facebookCommunities = communitiesOfType(&amp;quot;facebook_page&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Those two molecules re-use the same cached query and just apply
different input values. Now we can more efficiently get out results.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;twitterCommunities.get(3) === List(
  &amp;quot;Magnolia Voice&amp;quot;, &amp;quot;Columbia Citizens&amp;quot;, &amp;quot;Discover SLU&amp;quot;)
  
facebookCommunities.get(3) === List(
  &amp;quot;Magnolia Voice&amp;quot;, &amp;quot;Columbia Citizens&amp;quot;, &amp;quot;Discover SLU&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If we omit the underscore we can get the type too&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val communitiesWithType = m(Community.name.`type`(?))

communitiesWithType(&amp;quot;twitter&amp;quot;).get(3) === List(
  (&amp;quot;Discover SLU&amp;quot;, &amp;quot;twitter&amp;quot;),
  (&amp;quot;Fremont Universe&amp;quot;, &amp;quot;twitter&amp;quot;),
  (&amp;quot;Columbia Citizens&amp;quot;, &amp;quot;twitter&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;multiple-input-values-for-an-attribute-logical-or:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Multiple input values for an attribute - logical OR&lt;/h3&gt;

&lt;p&gt;Find communities of type &amp;ldquo;facebook_page&amp;rdquo; OR &amp;ldquo;twitter&amp;rdquo;:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;communitiesWithType(&amp;quot;facebook_page&amp;quot; or &amp;quot;twitter&amp;quot;).get(3) === List(
  (&amp;quot;Eastlake Community Council&amp;quot;, &amp;quot;facebook_page&amp;quot;),
  (&amp;quot;Discover SLU&amp;quot;, &amp;quot;twitter&amp;quot;),
  (&amp;quot;MyWallingford&amp;quot;, &amp;quot;facebook_page&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Alternative syntaxes where comma-separations act as logical OR:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;communitiesWithType(&amp;quot;facebook_page&amp;quot;, &amp;quot;twitter&amp;quot;)
communitiesWithType(Seq(&amp;quot;facebook_page&amp;quot;, &amp;quot;twitter&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;tuple-of-input-values-for-multiple-attributes-logical-and:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Tuple of input values for multiple attributes - logical AND&lt;/h3&gt;

&lt;p&gt;In addition to passing multiple values for a single attribute, you
can pass a tuple of values for multiple attributes ensuring that both
values are present.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val typeAndOrgtype = m(Community.name.type_(?).orgtype_(?))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;With this input molecule we can find communities that are of &lt;code&gt;type&lt;/code&gt;
&amp;ldquo;email_list&amp;rdquo; AND &lt;code&gt;orgtype&lt;/code&gt; &amp;ldquo;community&amp;rdquo;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;typeAndOrgtype(&amp;quot;email_list&amp;quot; and &amp;quot;community&amp;quot;).get(3) === List(
  &amp;quot;Ballard Moms&amp;quot;,
  &amp;quot;Admiral Neighborhood Association&amp;quot;,
  &amp;quot;15th Ave Community&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The order of arguments in the logical AND expression will correspond
to the order of the input placeholders in the input molecule so that
&amp;ldquo;email_list&amp;rdquo; corresponds to &lt;code&gt;type_(?)&lt;/code&gt; and &amp;ldquo;community&amp;rdquo; corresponds to
&lt;code&gt;community_(?)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Arguments in expressions are also type-checked against the expected
types of the corresponding attributes. Our IDE would infer that the
&lt;code&gt;orgtype&lt;/code&gt; attribute doesn&amp;rsquo;t expect an &lt;code&gt;Int&lt;/code&gt; as the second argument if we
were to pass the expression &amp;ldquo;email_list and 42&amp;rdquo;. This helps us avoid
populating our database with unexpected data.&lt;/p&gt;

&lt;p&gt;We can express logical AND expressions with a list of arguments too:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// AND-semantics given an input molecule expecting 2 inputs!
typeAndOrgtype(&amp;quot;email_list&amp;quot;, &amp;quot;community&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Or we can pass a list of arguments. IMPORTANT: note how the semantics
of a list of arguments change compared to the OR semantics that we
saw with the single-input molecule above that had OR-semantics. When
we have multiple inputs the semantics change to AND-semantics!&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// AND-semantics given an input molecule expecting 2 inputs!
typeAndOrgtype(Seq((&amp;quot;email_list&amp;quot;, &amp;quot;community&amp;quot;)))
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;multiple-tuples-of-input-values-for-multiple-attributes-logical-and-or:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Multiple tuples of input values for multiple attributes - logical AND/OR&lt;/h3&gt;

&lt;p&gt;We can also ask for alternative tuples of data structures. Since the
input values can then vary, we could ask our molecule to return the
input values too.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val typeAndOrgtype2 = m(Community.name.`type`(?).orgtype(?))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now let&amp;rsquo;s ask for email-list communities OR commercial website
communities. Note how this combines logical AND and OR.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;typeAndOrgtype2(
  (&amp;quot;email_list&amp;quot; and &amp;quot;community&amp;quot;) or 
  (&amp;quot;website&amp;quot; and &amp;quot;commercial&amp;quot;)
).get(5) === List(
  (&amp;quot;Fremont Arts Council&amp;quot;, &amp;quot;email_list&amp;quot;, &amp;quot;community&amp;quot;),
  (&amp;quot;Greenwood Community Council Announcements&amp;quot;, &amp;quot;email_list&amp;quot;, &amp;quot;community&amp;quot;),
  (&amp;quot;Broadview Community Council&amp;quot;, &amp;quot;email_list&amp;quot;, &amp;quot;community&amp;quot;),
  (&amp;quot;Alki News&amp;quot;, &amp;quot;email_list&amp;quot;, &amp;quot;community&amp;quot;),
  (&amp;quot;Beacon Hill Burglaries&amp;quot;, &amp;quot;email_list&amp;quot;, &amp;quot;community&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As usual we can use alternative syntaxes as well. Here we group the
AND expression arguments as tuple values. Comma-separations between
the tuples act as logical OR.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// ((a AND b) OR (c AND d))
typeAndOrgtype2((&amp;quot;email_list&amp;quot;, &amp;quot;community&amp;quot;), (&amp;quot;website&amp;quot;, &amp;quot;commercial&amp;quot;))
typeAndOrgtype2(Seq((&amp;quot;email_list&amp;quot;, &amp;quot;community&amp;quot;), (&amp;quot;website&amp;quot;, &amp;quot;commercial&amp;quot;)))
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;6:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Invoking functions in queries&lt;/h2&gt;

&lt;p&gt;Datomic lets you invoke functions in queries. Molecule use this to
apply comparison operations on attribute values. Here we can for
instance find communities whose &lt;code&gt;name&lt;/code&gt; come before &amp;ldquo;C&amp;rdquo; in
alphabetical order.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Community.name &amp;lt; &amp;quot;C&amp;quot;).get(3) === List(
  &amp;quot;Ballard Blog&amp;quot;, &amp;quot;Beach Drive Blog&amp;quot;, &amp;quot;Beacon Hill Blog&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note how we use the &lt;code&gt;m&lt;/code&gt; method here to allow the postfix notation
(spaces around &lt;code&gt;&amp;lt;&lt;/code&gt;). Alternatively you can call the &lt;code&gt;&amp;lt;&lt;/code&gt; method
explicitly if you prefer this syntax:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.&amp;lt;(&amp;quot;C&amp;quot;).get(3) === List(
  &amp;quot;Ballard Blog&amp;quot;, &amp;quot;Beach Drive Blog&amp;quot;, &amp;quot;Beacon Hill Blog&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can also parameterize the molecule.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val communitiesBefore = m(Community.name &amp;lt; ?)

communitiesBefore(&amp;quot;C&amp;quot;).get(3) === List(
  &amp;quot;Ballard Blog&amp;quot;, &amp;quot;Beach Drive Blog&amp;quot;, &amp;quot;Beacon Hill Blog&amp;quot;)
  
communitiesBefore(&amp;quot;A&amp;quot;).get(3) === List(&amp;quot;15th Ave Community&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;7:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Querying with fulltext search&lt;/h2&gt;

&lt;p&gt;Datomic supports fulltext searching. When you define an attribute
of string value, you can indicate whether it should be indexed for
fulltext search. For instance Community &lt;code&gt;name&lt;/code&gt; and &lt;code&gt;category&lt;/code&gt; have
the fulltextSearch option defined in the Seattle schema. Let&amp;rsquo;s find
communities with &amp;ldquo;Wallingford&amp;rdquo; in the name.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;(Community.name contains &amp;quot;Wallingford&amp;quot; take 3) === List(
  &amp;quot;KOMO Communities - Wallingford&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And we can parameterize fulltext searches too:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val communitiesWith = m(Community.name contains ?)

(communitiesWith(&amp;quot;Wallingford&amp;quot;) take 3) === List(
  &amp;quot;KOMO Communities - Wallingford&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;fulltext-search-on-many-cardinality-attributes:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Fulltext search on many-cardinality attributes&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;category&lt;/code&gt; attribute can have several values so when we do a
fulltext search on its values we&amp;rsquo;ll get back a set of its values
that match our seed. We can also combine fulltext search with other
constraints. Here we look for website communities with a &lt;code&gt;category&lt;/code&gt;
containing the word &amp;ldquo;food&amp;rdquo;:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;m(Community.name.type_(&amp;quot;website&amp;quot;).category contains &amp;quot;food&amp;quot;).get(3) === List(
  (&amp;quot;Community Harvest of Southwest Seattle&amp;quot;, Set(&amp;quot;sustainable food&amp;quot;)),
  (&amp;quot;InBallard&amp;quot;, Set(&amp;quot;food&amp;quot;)))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And parameterized:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val typeAndCategory = m(Community.name.type_(?).category contains ?)

typeAndCategory(&amp;quot;website&amp;quot;, Set(&amp;quot;food&amp;quot;)).get(3) === List(
  (&amp;quot;Community Harvest of Southwest Seattle&amp;quot;, Set(&amp;quot;sustainable food&amp;quot;)),
  (&amp;quot;InBallard&amp;quot;, Set(&amp;quot;food&amp;quot;)))
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note how the values of the &lt;code&gt;category&lt;/code&gt; attribute are now returned
since they can vary across the result set contrary to the &lt;code&gt;type&lt;/code&gt;
attribute which is not since it will have the same value for all
matches.&lt;/p&gt;

&lt;h2 id=&#34;8:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Querying with rules - logical OR&lt;/h2&gt;

&lt;p&gt;Datomic rules are named groups of Datomic clauses that can be
plugged into Datomic queries. As a Molecule user you don&amp;rsquo;t need to
know about rules since Molecule automatically translates your logic
to Datomic rules.&lt;/p&gt;

&lt;p&gt;We can for instance find social media communities with a
logical OR expresion:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.type_(&amp;quot;twitter&amp;quot; or &amp;quot;facebook_page&amp;quot;).get(3) === List(
  &amp;quot;Magnolia Voice&amp;quot;, &amp;quot;Columbia Citizens&amp;quot;, &amp;quot;Discover SLU&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&amp;hellip; or find communities in the NE or SW regions.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community.name.Neighborhood.District.region_(&amp;quot;ne&amp;quot; or &amp;quot;sw&amp;quot;).get(3) === List(
  &amp;quot;Beach Drive Blog&amp;quot;, 
  &amp;quot;KOMO Communities - Green Lake&amp;quot;, 
  &amp;quot;Delridge Produce Cooperative&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And we can combine them to find social-media communities in
southern regions.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val southernSocialMedia = List(
  &amp;quot;Columbia Citizens&amp;quot;,
  &amp;quot;Fauntleroy Community Association&amp;quot;,
  &amp;quot;MyWallingford&amp;quot;,
  &amp;quot;Blogging Georgetown&amp;quot;)

Community.name.type_(&amp;quot;twitter&amp;quot; or &amp;quot;facebook_page&amp;quot;)
  .Neighborhood
  .District.region_(&amp;quot;sw&amp;quot; or &amp;quot;s&amp;quot; or &amp;quot;se&amp;quot;).get === southernSocialMedia
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let&amp;rsquo;s parameterized the same query:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val typeAndRegion = m(Community.name.type_(?).Neighborhood.District.region_(?))

typeAndRegion(
  (&amp;quot;twitter&amp;quot; or &amp;quot;facebook_page&amp;quot;) and 
  (&amp;quot;sw&amp;quot; or &amp;quot;s&amp;quot; or &amp;quot;se&amp;quot;)
).get === southernSocialMedia

// or
typeAndRegion(
  Seq(&amp;quot;twitter&amp;quot;, &amp;quot;facebook_page&amp;quot;), 
  Seq(&amp;quot;sw&amp;quot;, &amp;quot;s&amp;quot;, &amp;quot;se&amp;quot;)
).get === southernSocialMedia
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note how this syntax for the ((a OR b) AND (c OR d)) expression
is different from the syntax we had earlier in the section
&amp;ldquo;Multiple tuples of input values for multiple attributes&amp;rdquo; where
we had a ((a AND b) OR (c AND d)) expression.&lt;/p&gt;

&lt;h2 id=&#34;9:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Working with time&lt;/h2&gt;

&lt;p&gt;All of the query results shown in the previous two sections were
based on the initial seed data we loaded into our database. The
data hasn&amp;rsquo;t changed since then. In this section we&amp;rsquo;ll load some
more data, and explain how to work with database values from
different moments in time.&lt;/p&gt;

&lt;h3 id=&#34;time-is-built-in:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Time is built in&lt;/h3&gt;

&lt;p&gt;One of the key concepts in Datomic is that new facts don&amp;rsquo;t replace
old facts. Instead, by default, the system keeps track of all the
facts, forever. This makes it possible to look at the database as
it was at a certain point in time, or at the changes since a certain
point in time.&lt;/p&gt;

&lt;p&gt;When you submit a transaction to a database, Datomic keeps track
of the entities, attributes and values you add or retract. It also
keeps track of the transaction itself. Transactions are entities
in their own right, and you can write queries to find them.
The system associates one attribute with each transaction entity,
Db.txInstant, which records the time the transaction was processed.&lt;/p&gt;

&lt;p&gt;Molecule has a &lt;code&gt;Db&lt;/code&gt; namespace with a &lt;code&gt;txInstant&lt;/code&gt; attribute that
we can use to query for transactions instants (represented as
java.util.Date instances) that has been created. We&amp;rsquo;ve only
executed two transactions, but the earlier system executed a
few as part of its bootstrapping process. We know, though, that
our two are the most recent. The code below uses a &lt;code&gt;Db.txInstant&lt;/code&gt;
molecule to retrieve transaction times, sort them into reverse
chronological order, and store the most recent two as dataTxDate
and schemaTxDate, when we added our data and our schema, respectively.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val txDates = Db.txInstant.get.sorted.reverse
val dataTxDate = txDates(0)
val schemaTxDate = txDates(1)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;revisiting-the-past-asof-pastdate:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Revisiting the past - asOf(PastDate)&lt;/h3&gt;

&lt;p&gt;Once we have the relevant transaction times, we can look at the
database as of that point in time. To do this, we retrieve the
current database value by calling the molecule method &lt;code&gt;asOf&lt;/code&gt;,
passing in the Date we&amp;rsquo;re interested in. The &lt;code&gt;asOf&lt;/code&gt; method
returns a new molecule based on the database value that is
&amp;ldquo;rewound&amp;rdquo; back to the requested date.&lt;/p&gt;

&lt;p&gt;An example will help make this clear. The code below gets the
value of the database as of our schema transaction. Then it
runs our very first query, which retrieves entities representing
communities, and prints the size of the results. Because we&amp;rsquo;re
using a database value from before we ran the transaction to
load seed data, the size is 0.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;communities.asOf(schemaTxDate).get.size === 0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If we do the same thing using the date of our seed data
transaction, the query returns 150 results, because as of
that moment, the seed data is there.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;communities.asOf(dataTxDate).get.size === 150
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;changes-since-a-date-since-comparedate:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Changes since a date - since(compareDate)&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;asOf&lt;/code&gt; method allows us to look at a database value
containing data changes up to a specific point in time.
There is another method &lt;code&gt;since&lt;/code&gt; that allows us to look at
a database value containing data changes since a specific
point in time.&lt;/p&gt;

&lt;p&gt;The code below gets the value of the database since our
schema transaction and counts the number of communities.
Because we&amp;rsquo;re using a database value containing changes
made since we ran the transaction to load our schema -
including the changes made when we loaded our seed data -
the size is 150.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;communities.since(schemaTxDate).get.size === 150
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If we do the same thing using the date of our seed data
transaction, the query returns 0 results, because we haven&amp;rsquo;t
added any communities since that time.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;communities.since(dataTxDate).get.size === 0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;While we passed specific transaction dates to &lt;code&gt;asOf&lt;/code&gt;
and &lt;code&gt;since&lt;/code&gt;, you can pass any date. The system find the
closest relevant transaction and use that as the basis for
filtering.&lt;/p&gt;

&lt;p&gt;Keeping track of data over time is a very powerful feature.
However, there may be some data you don&amp;rsquo;t want to keep old
versions of. You can control whether old versions are kept
on a per-attribute basis by adding &lt;code&gt;noHistory&lt;/code&gt; to your
attribute definition when you create your schema. If you
choose not to keep history for a given attribute and you
look at a database as of a time before the most recent change
to a given entity&amp;rsquo;s value for that attribute, you will not
find any value for it.&lt;/p&gt;

&lt;h3 id=&#34;imagining-the-future-imagine-futuredate:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Imagining the future - imagine(FutureDate)&lt;/h3&gt;

&lt;p&gt;Revisiting the past is a very powerful feature. It&amp;rsquo;s also
possible to imagine the future. The &lt;code&gt;asOf&lt;/code&gt; and &lt;code&gt;since&lt;/code&gt;
methods work by removing data from the current database value.
You can also &lt;em&gt;add&lt;/em&gt; data to a database value, using the
Molecule method &lt;code&gt;imagine&lt;/code&gt; (called &lt;code&gt;with&lt;/code&gt; in Datomic).
The result is a database value that&amp;rsquo;s been modified without
submitting a transaction and changing the data stored
in the system. The modified database value can be used to
execute queries, allowing you to perform &amp;ldquo;what if&amp;rdquo;
calculations before committing to data changes.&lt;/p&gt;

&lt;p&gt;We can explore this feature using a second seed data file
provided with the sample application,
&amp;ldquo;samples/seattle/seattle-data1.edn&amp;rdquo;. The code below reads
it into a list.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val data_rdr2 = new FileReader(&amp;quot;examples/resources/seattle/seattle-data1a.dtm&amp;quot;)
val newDataTx = Util.readAll(data_rdr2).get(0).asInstanceOf[java.util.List[Object]]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once we have this new data transaction, we can build a
database value that includes it. To do that, we simply
get the current database value (or one as of or since a
point in time) and call &lt;code&gt;imagine&lt;/code&gt;, passing in the
transaction data. &lt;code&gt;imagine&lt;/code&gt; returns a molecule based on
the new value of the database after the new data is added.
If we execute our community counting query against it,
we get 258 results.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// future db
communities.imagine(newDataTx).get.size === 258
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The actual data hasn&amp;rsquo;t changed yet, so if we query the
current database value, we still get 150 results. We won&amp;rsquo;t
see a change in the current database value until we submit
the new transaction. After that, querying the current
database value returns 258 results. Finally, if we get
another database value containing data since our first
seed data transaction ran, and query for communities we
get 108 results, the number added by new data transaction.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// existing db
communities.get.size === 150

// transact
conn.transact(newDataTx)

// updated db
communities.get.size === 258

// number of new transactions
communities.since(dataTxDate).get.size === 108
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;10:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Insert data&lt;/h2&gt;

&lt;p&gt;You can add data in two ways with Molecule:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Build a molecule with data and insert&lt;/li&gt;
&lt;li&gt;Use a molecule template to insert matching data&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;data-molecule-with-values:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&amp;ldquo;Data-molecule&amp;rdquo; with values&lt;/h3&gt;

&lt;p&gt;To insert a single data structure you can populate a
molecule with values and then &lt;code&gt;add&lt;/code&gt; it:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community
  .name(&amp;quot;AAA&amp;quot;)
  .url(&amp;quot;myUrl&amp;quot;)
  .`type`(&amp;quot;twitter&amp;quot;)
  .orgtype(&amp;quot;personal&amp;quot;)
  .category(&amp;quot;my&amp;quot;, &amp;quot;favorites&amp;quot;)
  .Neighborhood.name(&amp;quot;myNeighborhood&amp;quot;)
  .District.name(&amp;quot;myDistrict&amp;quot;).region(&amp;quot;nw&amp;quot;).add.eids === List(
    17592186045891L, 17592186045892L, 17592186045893L)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note how we can add values for referenced namespaces and multiple values for
cardinality-many attributes like &lt;code&gt;category&lt;/code&gt; - all in one go!&lt;/p&gt;

&lt;p&gt;Apart from the new Community entity two more entities are also added. Since
neither &amp;ldquo;myNeighborhood&amp;rdquo; nor &amp;ldquo;myDistrict&amp;rdquo; exist they are created to so that
we can reference them.&lt;/p&gt;

&lt;p&gt;In Datomic there is no requirement that we add a &amp;ldquo;complete&amp;rdquo;
set of namespace attributes to create an entity. For instance, we could add
a community only with &lt;code&gt;Community.name(&amp;quot;My community&amp;quot;).add&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;insert-molecule-matching-values:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&amp;ldquo;Insert-molecule&amp;rdquo; + matching values&lt;/h3&gt;

&lt;p&gt;A more efficient way to add larger sets of data is to define an
&amp;ldquo;Insert-Molecule&amp;rdquo; that models the data structure we
want to insert into the database. Note how we call the &lt;code&gt;insert&lt;/code&gt; method
to define it as an Input-Molecule:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val insertCommunity = m(
  Community.name.url.`type`.orgtype.category
    .Neighborhood.name
    .District.name.region
) insert
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can then create a new Community by applying a matching set of attribute values:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;insertCommunity(
  &amp;quot;BBB&amp;quot;, &amp;quot;url B&amp;quot;, &amp;quot;twitter&amp;quot;, &amp;quot;personal&amp;quot;, Set(&amp;quot;some&amp;quot;, &amp;quot;cat B&amp;quot;), 
    &amp;quot;neighborhood B&amp;quot;, 
    &amp;quot;district B&amp;quot;, &amp;quot;s&amp;quot;
).eids === List(17592186045895L, 17592186045896L, 17592186045897L)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As before, three entities are created here since we reference a new Neighborhood and District.&lt;/p&gt;

&lt;p&gt;All values are type checked against the expected type of each attribute!&lt;/p&gt;

&lt;h3 id=&#34;insert-molecule-multiple-data-tuples:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Insert-Molecule + multiple data tuples&lt;/h3&gt;

&lt;p&gt;With our insert-molecule at hand we can insert large numbers
of data tuples. As an example we can insert 3 communities and
referenced neighborhoods/district/regions in one go:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val newCommunitiesData = List(
  (&amp;quot;DDD Blogging Georgetown&amp;quot;, &amp;quot;http://www.blogginggeorgetown.com/&amp;quot;, 
    &amp;quot;blog&amp;quot;, &amp;quot;commercial&amp;quot;, Set(&amp;quot;DD cat 1&amp;quot;, &amp;quot;DD cat 2&amp;quot;), 
    &amp;quot;DD Georgetown&amp;quot;, &amp;quot;Greater Duwamish&amp;quot;, &amp;quot;s&amp;quot;),
  (&amp;quot;DDD Interbay District Blog&amp;quot;, &amp;quot;http://interbayneighborhood.neighborlogs.com/&amp;quot;, 
    &amp;quot;blog&amp;quot;, &amp;quot;community&amp;quot;, Set(&amp;quot;DD cat 3&amp;quot;), 
    &amp;quot;DD Interbay&amp;quot;, &amp;quot;Magnolia/Queen Anne&amp;quot;, &amp;quot;w&amp;quot;),
  (&amp;quot;DDD KOMO Communities - West Seattle&amp;quot;, &amp;quot;http://westseattle.komonews.com&amp;quot;, 
    &amp;quot;blog&amp;quot;, &amp;quot;commercial&amp;quot;, Set(&amp;quot;DD cat 4&amp;quot;), 
    &amp;quot;DD West Seattle&amp;quot;, &amp;quot;Southwest&amp;quot;, &amp;quot;sw&amp;quot;)
)

// Insert 3 new communities with 3 new neighborhoods
insertCommunity(newCommunitiesData) === List(
  17592186045909L, 17592186045910L, 17592186045911L,
  17592186045912L, 17592186045913L, 17592186045914L,
  17592186045915L, 17592186045916L, 17592186045917L)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This approach gives us a clean way of populating a database
where we can supply raw data from any source easily as long
as we can format it as a list of tuples of values each matching
our template molecule.&lt;/p&gt;

&lt;p&gt;We use an insert-molecule also when we initially &lt;a href=&#34;https://github.com/scalamolecule/blob/master/examples/src/test/scala/examples/seattle/SeattleSpec.scala#L43&#34;&gt;populate
the Seattle database&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;optional-attribute-values:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Optional attribute values&lt;/h3&gt;

&lt;p&gt;We might have a data set with some optional attribute values. We can append a &lt;code&gt;$&lt;/code&gt; to
such attribute names to tell Molecule that this is an optional value:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val insertCommunity = m(
  Community.name.url.`type`.orgtype$.category
    .Neighborhood.name
    .District.name.region
) insert
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If for instance some row has no orgtype we can use &lt;code&gt;None&lt;/code&gt; (and likewise &lt;code&gt;Some(&amp;lt;value&amp;gt;)&lt;/code&gt;):&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;(&amp;quot;community4&amp;quot;, &amp;quot;url2&amp;quot;, &amp;quot;blog&amp;quot;, None, Set(&amp;quot;cat3&amp;quot;, &amp;quot;cat1&amp;quot;), &amp;quot;NbhName4&amp;quot;, &amp;quot;DistName4&amp;quot;, &amp;quot;ne&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In an sql table we would &amp;ldquo;insert a null value&amp;rdquo; for such column.
But with Molecule/Datomic we just simply don&amp;rsquo;t assert any orgtype
value for that entity at all! In other words: there is no orgtype
fact to be asserted.&lt;/p&gt;

&lt;h3 id=&#34;type-safety:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Type safety&lt;/h3&gt;

&lt;p&gt;In this example we have only inserted text strings. But all input
is type checked against the selectedattributes of the molecule which
makes the insert operation type safe. We even infer the expected type
so that our IDE will bark if it finds for instance an Integer
somewhere in our input data:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;(&amp;quot;community2&amp;quot;, &amp;quot;url2&amp;quot;, &amp;quot;type2&amp;quot;, 42, Set(&amp;quot;cat3&amp;quot;, &amp;quot;cat1&amp;quot;), &amp;quot;NbhName2&amp;quot;, &amp;quot;DistName2&amp;quot;, &amp;quot;DistReg2&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;A data set having the value &lt;code&gt;42&lt;/code&gt; as a value for the &lt;code&gt;orgtype&lt;/code&gt;
attribute won&amp;rsquo;t compile and our IDE will infer that we have an invalid data set.&lt;/p&gt;

&lt;h2 id=&#34;11:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;&lt;a href=&#34;#contents:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;☝︎&lt;/a&gt; Update and/or delete data&lt;/h2&gt;

&lt;p&gt;To update data with Molecule, we first need the id of the entity
that we want to update.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;val belltown = Community.e.name_(&amp;quot;belltown&amp;quot;).get.head
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then we can &amp;ldquo;replace&amp;rdquo; some attributes&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community(belltown).name(&amp;quot;belltown 2&amp;quot;).url(&amp;quot;url 2&amp;quot;).update
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;What really happens is not a mutation of data since no
data is ever deleted or over-written in Datomic. Instead a
&lt;em&gt;new fact for the attribute is asserted&lt;/em&gt;. The new fact will
turn up when queried for. But if we go back in time we can see
the previous value at that point in time - many updates could
have been performed over time, and all previous values are stored.&lt;/p&gt;

&lt;h3 id=&#34;updating-cardinality-many-attributes:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Updating cardinality-many attributes&lt;/h3&gt;

&lt;p&gt;When updating cardinality-many attributes we need to tell which
of the values we want to update:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community(belltown).category(&amp;quot;news&amp;quot; -&amp;gt; &amp;quot;Cool news&amp;quot;).update
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This syntax causes Molecule to first retract the old value &amp;ldquo;news&amp;rdquo;
and then assert/add the new value &amp;ldquo;Cool news&amp;rdquo;. Note that if the
before-value doesn&amp;rsquo;t exist the new value will still be inserted,
so you might be sure what the current value is by querying for it first.&lt;/p&gt;

&lt;p&gt;We can even update several values of a cardinality-many attribute in one go:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community(belltown).category(
  &amp;quot;Cool news&amp;quot; -&amp;gt; &amp;quot;Super cool news&amp;quot;,
  &amp;quot;events&amp;quot; -&amp;gt; &amp;quot;Super cool events&amp;quot;).update
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;adding-removing-values-of-cardinality-many-attributes:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Adding/removing values of cardinality-many attributes&lt;/h3&gt;

&lt;p&gt;If we want to add or remove values of a cardinality-many attribute
we can use the following mehtods:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;// add
Community(belltown).category.add(&amp;quot;extra category&amp;quot;).update

// remove
Community(belltown).category.remove(&amp;quot;Super cool events&amp;quot;).update
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;delete-retract-values:3d29aefa7257f22b89227d9f373cd5f9&#34;&gt;Delete/retract values&lt;/h3&gt;

&lt;p&gt;When you update a molecule you can apply an empty value &lt;code&gt;apply()&lt;/code&gt;
or simply &lt;code&gt;()&lt;/code&gt; after an attribute name to delete/retract the
attributes value(s). We can mix updates and retractions:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-scala&#34;&gt;Community(belltown).name(&amp;quot;belltown 3&amp;quot;).url().category().update
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;name&lt;/code&gt; gets the new value &amp;ldquo;belltown 3&amp;rdquo; and both the &lt;code&gt;url&lt;/code&gt; and
&lt;code&gt;category&lt;/code&gt; attributes have their values retracted.&lt;/p&gt;

&lt;p&gt;There are a couple of important things to know about retracting data.
The first is that we must specify the value of the attribute being
retracted. When applying the empty value, Molecule therefore first
looks up the current value in order to be able to retract it.&lt;/p&gt;

&lt;p&gt;The other thing to know is that, because we can access database
values as they existed at specific points in time, we can retrieve
retracted data by looking in the past. In other words, the data
isn&amp;rsquo;t really gone. If we want data to really be gone after we
retract it, we have to disable history for the specific attribute,
as described in &lt;a href=&#34;http://localhost:1313/manual/setup&#34;&gt;Database setup&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Videos</title>
      <link>http://localhost:1313/tutorials/videos/</link>
      <pubDate>Fri, 02 Jan 2015 22:06:44 CET</pubDate>
      
      <guid>http://localhost:1313/tutorials/videos/</guid>
      <description>

&lt;h1 id=&#34;contents:a45b24697a235d080c581c0ce5a9b90b&#34;&gt;Molecule video presentation&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Part 1: Datomic data model&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Part 2: Building a DSL with Scala macros&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Part 3: Tour of Molecule features&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#4:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Part 4: Molecule domain modelling&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Molecule presentation in 4 parts by creator Marc Grue. The talk took place at a Scala group MeetUp in Gothenburg,
Sweden on April 25 of 2017 and is based on Molecule, version 0.10.3. Each part of the speech covers its own topics that are
listed below each of the 4 videos.&lt;/p&gt;

&lt;p&gt;Some changes has been made to the slides where the API was improved based on great input from the attendees:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;All database filter getters follow the same verb form:

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;getAsOf(t)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getSince(t)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getWith(txData)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getHistory&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;All molecule &lt;code&gt;get&lt;/code&gt;s now return type &lt;code&gt;Iterable[(A, B, ...)]&lt;/code&gt; so that you can retrieve large data sets successively with an iterator.&lt;/li&gt;
&lt;li&gt;Some unclarity with transactional meta data (like operations) on history data is being reviewed.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;1:a45b24697a235d080c581c0ce5a9b90b&#34;&gt;&lt;a href=&#34;http://localhost:1313/tutorials/video-presentation&#34;&gt;☝︎&lt;/a&gt; Part 1: Datomic data model&lt;/h2&gt;

&lt;div class=&#34;embed-responsive embed-responsive-16by9&#34;&gt;
  &lt;iframe id=&#34;part1&#34; 
    width=&#34;560&#34; 
    height=&#34;315&#34; 
    src=&#34;https://www.youtube.com/embed//JjX8DYvQRXQ?enablejsapi=1&#34;
    frameborder=&#34;0&#34; 
    allowfullscreen&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;script type=&#34;text/javascript&#34;&gt;
  var tag = document.createElement(&#39;script&#39;);
  tag.id = &#39;iframe-demo&#39;;
  tag.src = &#39;https://www.youtube.com/iframe_api&#39;;
  var firstScriptTag = document.getElementsByTagName(&#39;script&#39;)[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  var player1;
  var player2;
  var player3;
  var player4;
  function onYouTubeIframeAPIReady() {
    player1 = new YT.Player(&#39;part1&#39;, {
        videoId: &#39;JjX8DYvQRXQ&#39;,
        events: {}
    });
    player2 = new YT.Player(&#39;part2&#39;, {
        videoId: &#39;bIhVAMd3-EU&#39;,
        events: {}
    });
    player3 = new YT.Player(&#39;part3&#39;, {
        videoId: &#39;d5_fEyY_W94&#39;,
        events: {}
    });
    player4 = new YT.Player(&#39;part4&#39;, {
        videoId: &#39;_hiIqyj5XcM&#39;,
        events: {}
    });
  }
&lt;/script&gt;

&lt;div style=&#34;column-width: 15em;&#34;&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Data model&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Overview of talk&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(60).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Datomic overview&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(99).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Key-Value to Datom&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(301).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Schema definition&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(565).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Entity&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(688).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Relationships&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Mutable/Immutable&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(845).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Immutable facts&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(900).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Create/Assert&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(949).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Update/Retract-Assert&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1045).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Delete/Retract&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Datomic queries&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1107).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Query&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1294).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;asOf&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1340).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;history&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1368).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;since&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1402).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;with&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Datomic architecture&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1546).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;No db server&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1562).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Peer/Transactor&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1603).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Storage service&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1651).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Peer cache&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1725).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Live index&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1856).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Memcache&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player1.seekTo(1927).playVideo()&#34; href=&#34;#1:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Questions&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;2:a45b24697a235d080c581c0ce5a9b90b&#34;&gt;&lt;a href=&#34;http://localhost:1313/tutorials/video-presentation&#34;&gt;☝︎&lt;/a&gt; Part 2: Building a DSL with Scala macros&lt;/h2&gt;

&lt;div class=&#34;embed-responsive embed-responsive-16by9&#34;&gt;
  &lt;iframe id=&#34;part2&#34; 
    width=&#34;560&#34; 
    height=&#34;315&#34; 
    src=&#34;https://www.youtube.com/embed/bIhVAMd3-EU?enablejsapi=1&#34;
    frameborder=&#34;0&#34; 
    allowfullscreen&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;div style=&#34;column-width: 15em;&#34;&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Macro transformation&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(13).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Raw query in Scala&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(151).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Casting result&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(187).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Compile-time/runtime&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(256).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Quasiquotes&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(295).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Macro implementation&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(346).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Implicit macro&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(397).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Recursive tree extraction&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Molecule DSL&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(519).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Boilerplate DSL code&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(661).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;SBT-plugin&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(686).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Schema definition&lt;/a&gt;
        &lt;br&gt;
        &lt;br&gt;
        &lt;br&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Schema def DSL&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(730).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Cardinality/type&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(806).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Options&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(824).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Molecule eco system&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player2.seekTo(892).playVideo()&#34; href=&#34;#2:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Questions&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;3:a45b24697a235d080c581c0ce5a9b90b&#34;&gt;&lt;a href=&#34;http://localhost:1313/tutorials/video-presentation&#34;&gt;☝︎&lt;/a&gt; Part 3: Building a DSL with Scala macros&lt;/h2&gt;

&lt;div class=&#34;embed-responsive embed-responsive-16by9&#34;&gt;
  &lt;iframe id=&#34;part3&#34; 
    width=&#34;560&#34; 
    height=&#34;315&#34; 
    src=&#34;https://www.youtube.com/embed/d5_fEyY_W94?enablejsapi=1&#34;
    frameborder=&#34;0&#34; 
    allowfullscreen&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;div style=&#34;column-width: 15em; width: 100%;&#34;&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Core&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(37).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Entities&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(134).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Attributes&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;Expressions
        &lt;ul&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(306).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Equality&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(361).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Fulltext search&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(390).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Negation&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(398).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Null / Nil&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(412).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Comparison&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(417).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Aggregates&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(443).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Logical OR&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Relationships
        &lt;ul&gt;        
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(486).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Card-one&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(618).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Back-ref&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(712).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Card-many&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(758).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Nested&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(817).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Non-intrinsic&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(878).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Composites&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;CRUD&lt;/h4&gt;
    &lt;ul&gt;
        &lt;li&gt;Create
            &lt;ul&gt;                       
              &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1073).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Save&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1090).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Insert&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1162).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;2-step insert&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/li&gt;
        &lt;li&gt;Read&lt;/li&gt;
        &lt;li&gt;Update
            &lt;ul&gt;
              &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1240).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Card-one&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1312).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Card-many&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/li&gt;
        &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1425).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Delete&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
    &lt;br&gt;
    &lt;br&gt;
&lt;/div&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Extras&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1478).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Map attributes&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1668).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Input molecules&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1747).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Bidirectional refs&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;br&gt;
&lt;/div&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Time&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(1921).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Tx data&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(2428).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Tx meta data&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(2715).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;asOf&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(2943).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;History&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(3309).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;+ meta data&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(3529).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Since&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player3.seekTo(3543).playVideo()&#34; href=&#34;#3:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Imagine&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;4:a45b24697a235d080c581c0ce5a9b90b&#34;&gt;&lt;a href=&#34;http://localhost:1313/tutorials/video-presentation&#34;&gt;☝︎&lt;/a&gt; Part 4: Molecule domain modelling&lt;/h2&gt;

&lt;div class=&#34;embed-responsive embed-responsive-16by9&#34;&gt;
  &lt;iframe id=&#34;part4&#34; 
    width=&#34;560&#34; 
    height=&#34;315&#34; 
    src=&#34;https://www.youtube.com/embed/_hiIqyj5XcM?enablejsapi=1&#34; 
    frameborder=&#34;0&#34; 
    allowfullscreen&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;div style=&#34;column-width: 15em;&#34;&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Traditional modelling&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player4.playVideo()&#34; href=&#34;#4:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Fat models&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player4.seekTo(42).playVideo()&#34; href=&#34;#4:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Sub-typing&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player4.seekTo(65).playVideo()&#34; href=&#34;#4:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Entity consumers&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player4.seekTo(149).playVideo()&#34; href=&#34;#4:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Property pace&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;unbreakable&#34;&gt;
    &lt;h4&gt;Molecule modelling&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a onclick=&#34;player4.seekTo(193).playVideo()&#34; href=&#34;#4:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Molecular entities&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player4.seekTo(402).playVideo()&#34; href=&#34;#4:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Molecules in-process&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a onclick=&#34;player4.seekTo(517).playVideo()&#34; href=&#34;#4:3635bf43dbc96836f464b22b328c5f8e&#34;&gt;Questions and discussion&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>